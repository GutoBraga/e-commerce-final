(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('@angular/core'), require('rxjs'), require('rxjs/operators'), require('@angular/forms'), require('@angular/common')) :
    typeof define === 'function' && define.amd ? define('ng-form-rules', ['exports', '@angular/core', 'rxjs', 'rxjs/operators', '@angular/forms', '@angular/common'], factory) :
    (factory((global['ng-form-rules'] = {}),global.ng.core,global.rxjs,global.rxjs.operators,global.ng.forms,global.ng.common));
}(this, (function (exports,core,rxjs,operators,forms,common) { 'use strict';

    /*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
    /* global Reflect, Promise */
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b)
            if (b.hasOwnProperty(p))
                d[p] = b[p]; };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m)
            return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done)
                ar.push(r.value);
        }
        catch (error) {
            e = { error: error };
        }
        finally {
            try {
                if (r && !r.done && (m = i["return"]))
                    m.call(i);
            }
            finally {
                if (e)
                    throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++)
            ar = ar.concat(__read(arguments[i]));
        return ar;
    }

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    /**
     * Injection token for providing an array of model settings
     */
    var /** @type {?} */ MODEL_SETTINGS_TOKEN = new core.InjectionToken('ngfr.model-settings');

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    /**
     * Injection token for enabling ng-form-rules tracing
     */
    var /** @type {?} */ TRACE_SETTINGS_TOKEN = new core.InjectionToken('ngfr.trace-settings');

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    var TraceService = (function () {
        function TraceService(doTrace) {
            if (doTrace === void 0) {
                doTrace = false;
            }
            this.doTrace = doTrace;
        }
        /**
         * @param {?} msg
         * @return {?}
         */
        TraceService.prototype.trace = /**
         * @param {?} msg
         * @return {?}
         */
            function (msg) {
                if (!this.doTrace)
                    return;
                var /** @type {?} */ fullMsg = "[NGFR - " + this.getTimeStamp() + "] " + msg;
                console.log(fullMsg);
            };
        /**
         * @return {?}
         */
        TraceService.prototype.getTimeStamp = /**
         * @return {?}
         */
            function () {
                return (new Date).toLocaleTimeString();
            };
        TraceService.decorators = [
            { type: core.Injectable },
        ];
        /** @nocollapse */
        TraceService.ctorParameters = function () {
            return [
                { type: undefined, decorators: [{ type: core.Optional }, { type: core.Inject, args: [TRACE_SETTINGS_TOKEN,] },] },
            ];
        };
        return TraceService;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    var CommonService = (function () {
        function CommonService() {
        }
        /**
         * Gets unique values from an array
         * @param values Values to get unique items from
         * @returns Unique values array
         */
        /**
         * Gets unique values from an array
         * @param {?} values Values to get unique items from
         * @return {?} Unique values array
         */
        CommonService.prototype.unique = /**
         * Gets unique values from an array
         * @param {?} values Values to get unique items from
         * @return {?} Unique values array
         */
            function (values) {
                if (!Array.isArray(values))
                    return [];
                return Array.from(new Set(values));
            };
        /**
         * Determines if number is zero or greater
         * @param value If number is greater than or equal zero
         */
        /**
         * Determines if number is zero or greater
         * @param {?} value If number is greater than or equal zero
         * @return {?}
         */
        CommonService.prototype.isZeroOrGreater = /**
         * Determines if number is zero or greater
         * @param {?} value If number is greater than or equal zero
         * @return {?}
         */
            function (value) {
                if (!value && value === 0)
                    return true;
                if (!value || typeof value !== "number")
                    return false;
                return value > 0;
            };
        CommonService.decorators = [
            { type: core.Injectable },
        ];
        return CommonService;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    /**
     * Results of executing a collection of tests
     * @template T
     */
    var /**
     * Results of executing a collection of tests
     * @template T
     */ TestResultsBase = (function () {
        function TestResultsBase(results) {
            this.results = results;
            this.results = this.results || [];
        }
        Object.defineProperty(TestResultsBase.prototype, "passed", {
            /**
             * Whether the tests passed
             */
            get: /**
             * Whether the tests passed
             * @return {?}
             */ function () {
                return !this.failedResults.length;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TestResultsBase.prototype, "passedResults", {
            /**
             * Array of test results that passed
             */
            get: /**
             * Array of test results that passed
             * @return {?}
             */ function () {
                return this.results.filter(function (x) { return !!x.passed && !x.skipped; });
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TestResultsBase.prototype, "failedResults", {
            /**
             * Array of test results that failed
             */
            get: /**
             * Array of test results that failed
             * @return {?}
             */ function () {
                return this.results.filter(function (x) { return !x.passed; });
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TestResultsBase.prototype, "skippedResults", {
            /**
             * Array of test results that were skipped
             */
            get: /**
             * Array of test results that were skipped
             * @return {?}
             */ function () {
                return this.results.filter(function (x) { return !!x.skipped; });
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TestResultsBase.prototype, "message", {
            /**
             * Message of the first test that failed
             */
            get: /**
             * Message of the first test that failed
             * @return {?}
             */ function () {
                return this.messages[0];
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TestResultsBase.prototype, "messages", {
            /**
             * Messages of all failed tests
             */
            get: /**
             * Messages of all failed tests
             * @return {?}
             */ function () {
                var /** @type {?} */ messages = this.failedResults.map(function (x) { return x.message; });
                return Array.from(new Set(messages));
            },
            enumerable: true,
            configurable: true
        });
        return TestResultsBase;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    /**
     * Base class for a property
     * @abstract
     * @template T
     */
    var /**
     * Base class for a property
     * @abstract
     * @template T
     */ PropertyBase = (function () {
        function PropertyBase() {
            this._dependencyPropertySubscriptions = [];
            /**
             * Validation tests
             */
            this.valid = [];
            /**
             * Editability tests
             */
            this.edit = [];
            /**
             * The event name for control to update upon.
             */
            this.updateOn = 'change';
            /**
             * Options for how to respond to value changes on property control and dependency controls
             */
            this.valueChangeOptions = {
                dependencyProperties: {
                    valid: { distinctUntilChanged: false, debounceMilliseconds: 0 },
                    edit: { distinctUntilChanged: false, debounceMilliseconds: 0 }
                },
                self: {
                    asyncValid: { distinctUntilChanged: false, debounceMilliseconds: 0 },
                    edit: { distinctUntilChanged: false, debounceMilliseconds: 0 }
                }
            };
        }
        Object.defineProperty(PropertyBase.prototype, "absolutePath", {
            /**
             * Absolute path to the property from root
             */
            get: /**
             * Absolute path to the property from root
             * @return {?}
             */ function () {
                return this._absolutePath;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(PropertyBase.prototype, "dependencyPropertySubscriptions", {
            /**
             * Absolute path to property from root
             */
            get: /**
             * Absolute path to property from root
             * @return {?}
             */ function () {
                return this._dependencyPropertySubscriptions;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(PropertyBase.prototype, "ownerModelSettingsName", {
            /**
             * Absolute path to property from root
             */
            get: /**
             * Absolute path to property from root
             * @return {?}
             */ function () {
                return this._ownerModelSettingsName;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * Determines if the property is an ArrayItemProperty
         * @param property Property to check
         * @returns Whether or not the property is an ArrayItemProperty
         */
        /**
         * Determines if the property is an ArrayItemProperty
         * @template T
         * @param {?} property Property to check
         * @return {?} Whether or not the property is an ArrayItemProperty
         */
        PropertyBase.isArrayItemProperty = /**
         * Determines if the property is an ArrayItemProperty
         * @template T
         * @param {?} property Property to check
         * @return {?} Whether or not the property is an ArrayItemProperty
         */
            function (property) {
                return !((property)).name;
            };
        /**
         * DO NOT CALL! Internal use only
         * @param absolutePath Absolute path to the property from the root
         */
        /**
         * DO NOT CALL! Internal use only
         * @param {?} absolutePath Absolute path to the property from the root
         * @return {?}
         */
        PropertyBase.prototype.setAbsolutePath = /**
         * DO NOT CALL! Internal use only
         * @param {?} absolutePath Absolute path to the property from the root
         * @return {?}
         */
            function (absolutePath) {
                this._absolutePath = absolutePath;
            };
        /**
         * DO NOT CALL! Internal use only
         * @param subscription Subscription for the dependency property
         */
        /**
         * DO NOT CALL! Internal use only
         * @param {?} subscription Subscription for the dependency property
         * @return {?}
         */
        PropertyBase.prototype.addDependencyPropertySubscription = /**
         * DO NOT CALL! Internal use only
         * @param {?} subscription Subscription for the dependency property
         * @return {?}
         */
            function (subscription) {
                this._dependencyPropertySubscriptions.push(subscription);
            };
        /**
         * DO NOT CALL! Internal use only
         */
        /**
         * DO NOT CALL! Internal use only
         * @return {?}
         */
        PropertyBase.prototype.clearDependencyPropertySubscriptions = /**
         * DO NOT CALL! Internal use only
         * @return {?}
         */
            function () {
                this.dependencyPropertySubscriptions.forEach(function (sub$) { return sub$.unsubscribe(); });
                this._dependencyPropertySubscriptions = [];
            };
        /**
         * DO NOT CALL! Internal use only
         * @param name Name of the owner model settings
         */
        /**
         * DO NOT CALL! Internal use only
         * @param {?} name Name of the owner model settings
         * @return {?}
         */
        PropertyBase.prototype.setOwnerModelSettingsName = /**
         * DO NOT CALL! Internal use only
         * @param {?} name Name of the owner model settings
         * @return {?}
         */
            function (name) {
                this._ownerModelSettingsName = name;
            };
        return PropertyBase;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    /** @enum {number} */
    var ProcessResultType = {
        Passed: 0,
        Failed: 1,
        Skipped: 2,
    };
    ProcessResultType[ProcessResultType.Passed] = "Passed";
    ProcessResultType[ProcessResultType.Failed] = "Failed";
    ProcessResultType[ProcessResultType.Skipped] = "Skipped";

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    /** @enum {number} */
    var ResultsPassRequirement = {
        /**
             * All results must pass
             */
        AllPass: 0,
        /**
             * Any results have passed
             */
        AnyPass: 1,
    };
    ResultsPassRequirement[ResultsPassRequirement.AllPass] = "AllPass";
    ResultsPassRequirement[ResultsPassRequirement.AnyPass] = "AnyPass";

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    /**
     * Engine that digests model settings and applies their rules appropriately
     */
    var RulesEngineService = (function () {
        function RulesEngineService(settings, traceSvc, commonSvc) {
            var _this = this;
            this.traceSvc = traceSvc;
            this.commonSvc = commonSvc;
            this.registeredSettings = {};
            if (!Array.isArray(settings))
                return;
            settings.forEach(function (setting) {
                _this.initializeModelSetting(setting);
                _this.registeredSettings[setting.name] = setting;
            });
        }
        /**
         * Initializes model settings and prepares them to be used in a form group
         * @param setting Model setting to initialize
         */
        /**
         * Initializes model settings and prepares them to be used in a form group
         * @param {?} setting Model setting to initialize
         * @return {?}
         */
        RulesEngineService.prototype.initializeModelSetting = /**
         * Initializes model settings and prepares them to be used in a form group
         * @param {?} setting Model setting to initialize
         * @return {?}
         */
            function (setting) {
                this.traceSvc.trace("Initializing model settings \"" + setting.name + "\"");
                this.setPropertyMetadata(setting.properties, setting.name);
            };
        /**
         * Gets model settings with the provided name
         * @param name Name of model setting
         * @returns Model settings with the provided name
         */
        /**
         * Gets model settings with the provided name
         * @template T
         * @param {?} name Name of model setting
         * @return {?} Model settings with the provided name
         */
        RulesEngineService.prototype.getModelSettings = /**
         * Gets model settings with the provided name
         * @template T
         * @param {?} name Name of model setting
         * @return {?} Model settings with the provided name
         */
            function (name) {
                this.traceSvc.trace("Retrieving model settings \"" + name + "\"");
                var /** @type {?} */ settings = this.registeredSettings[name];
                // create new object
                return settings
                    ? Object.assign({}, this.registeredSettings[name])
                    : null;
            };
        /**
         * Gets the dependency properties for an array of tests
         * @param tests Tests to get the dependency properties for
         * @returns Dependency properties
         */
        /**
         * Gets the dependency properties for an array of tests
         * @template T
         * @param {?} tests Tests to get the dependency properties for
         * @return {?} Dependency properties
         */
        RulesEngineService.prototype.getDependencyProperties = /**
         * Gets the dependency properties for an array of tests
         * @template T
         * @param {?} tests Tests to get the dependency properties for
         * @return {?} Dependency properties
         */
            function (tests) {
                var _this = this;
                if (!tests)
                    return [];
                var /** @type {?} */ deps = tests
                    .map(function (t) { return _this.getDependencyPropertiesFromTest(t); })
                    .reduce(function (prev, current) { return prev.concat(current); }, []);
                return this.commonSvc.unique(deps);
            };
        /**
         * Gets tests grouped by their sync type (e.g. sync vs. async)
         * @param tests Test to groups
         * @returns Tests grouped by sync type
         */
        /**
         * Gets tests grouped by their sync type (e.g. sync vs. async)
         * @template T
         * @param {?} tests Test to groups
         * @return {?} Tests grouped by sync type
         */
        RulesEngineService.prototype.groupTestsBySyncType = /**
         * Gets tests grouped by their sync type (e.g. sync vs. async)
         * @template T
         * @param {?} tests Test to groups
         * @return {?} Tests grouped by sync type
         */
            function (tests) {
                var _this = this;
                var /** @type {?} */ testGroups = ({
                    sync: [],
                    async: []
                });
                if (!tests)
                    return testGroups;
                tests.forEach(function (test) {
                    var /** @type {?} */ testFuncTypes = ({
                        sync: false,
                        async: false
                    });
                    var /** @type {?} */ conditionResults = _this.getConfiguredFuncTypes(test.condition);
                    var /** @type {?} */ checkResults = _this.getConfiguredFuncTypes(test.check);
                    testFuncTypes.sync = conditionResults.sync || checkResults.sync;
                    testFuncTypes.async = conditionResults.async || checkResults.async;
                    // if there is an async func anywhere in the test's rule sets, then it is considered an async test
                    if (testFuncTypes.sync && !testFuncTypes.async)
                        testGroups.sync.push(test);
                    if (testFuncTypes.async)
                        testGroups.async.push(test);
                });
                return testGroups;
            };
        /**
         * Runs validation tests
         * @param data Data to run validation tests against
         * @param property Property to run validation tests for
         * @returns Results of validation tests
         */
        /**
         * Runs validation tests
         * @template T
         * @param {?} data Data to run validation tests against
         * @param {?} property Property to run validation tests for
         * @param {?=} state
         * @return {?} Results of validation tests
         */
        RulesEngineService.prototype.validate = /**
         * Runs validation tests
         * @template T
         * @param {?} data Data to run validation tests against
         * @param {?} property Property to run validation tests for
         * @param {?=} state
         * @return {?} Results of validation tests
         */
            function (data, property, state) {
                return this.runAllTests(data, property.valid, state)
                    .pipe(operators.map(function (results) {
                    results.propertyName = property.absolutePath;
                    return /** @type {?} */ (results);
                }));
            };
        /**
         * Runs editability tests
         * @param data Data to run editability tests against
         * @param property Property to run editability tests for
         * * @returns Results of editability tests
         */
        /**
         * Runs editability tests
         * @template T
         * @param {?} data Data to run editability tests against
         * @param {?} property Property to run editability tests for
         * * \@returns Results of editability tests
         * @param {?=} state
         * @return {?}
         */
        RulesEngineService.prototype.editable = /**
         * Runs editability tests
         * @template T
         * @param {?} data Data to run editability tests against
         * @param {?} property Property to run editability tests for
         * * \@returns Results of editability tests
         * @param {?=} state
         * @return {?}
         */
            function (data, property, state) {
                return this.runAllTests(data, property.edit, state)
                    .pipe(operators.map(function (results) {
                    results.propertyName = property.absolutePath;
                    return /** @type {?} */ (results);
                }));
            };
        /**
         * Runs visibility tests
         * @param data Data to run visibility tests against
         * @param property Property to run visibility tests for
         * * @returns Results of visibility tests
         */
        // visible<T>(data: T, property: Property<T>, state?: TestRunState): Observable<PropertyTestResults<T>> {
        //     return this.runAllTests(data, property.view, state)
        //         .pipe(
        //             map((results: PropertyTestResults<T>) => {
        //                 results.propertyName = property.absolutePath;
        //                 return results as PropertyTestResults<T>;
        //             })
        //         );
        // }
        /**
         * Runs an array of sync tests
         * @param data Data to perform tests against
         * @param tests Tests to run
         * @returns Result of tests
         */
        /**
         * Runs an array of sync tests
         * @template T
         * @param {?} data Data to perform tests against
         * @param {?} tests Tests to run
         * @param {?=} state
         * @return {?} Result of tests
         */
        RulesEngineService.prototype.runTests = /**
         * Runs an array of sync tests
         * @template T
         * @param {?} data Data to perform tests against
         * @param {?} tests Tests to run
         * @param {?=} state
         * @return {?} Result of tests
         */
            function (data, tests, state) {
                var _this = this;
                if (!tests || !tests.length)
                    return new TestResultsBase([]);
                var /** @type {?} */ testResults = tests
                    .map(function (t) { return _this.runTest(data, t, state); })
                    .filter(function (x) { return !!x; });
                return new TestResultsBase(testResults);
            };
        /**
         * Runs an array of async tests
         * @param data Data to perform tests against
         * @param tests Tests to run
         * @returns Result of tests
         */
        /**
         * Runs an array of async tests
         * @template T
         * @param {?} data Data to perform tests against
         * @param {?} tests Tests to run
         * @param {?=} state
         * @return {?} Result of tests
         */
        RulesEngineService.prototype.runTestsAsync = /**
         * Runs an array of async tests
         * @template T
         * @param {?} data Data to perform tests against
         * @param {?} tests Tests to run
         * @param {?=} state
         * @return {?} Result of tests
         */
            function (data, tests, state) {
                var _this = this;
                if (!tests || !tests.length)
                    return rxjs.of(new TestResultsBase([]));
                var /** @type {?} */ runTest$ = tests
                    .map(function (test) { return _this.runTestAsync(data, test, state); });
                return rxjs.forkJoin(runTest$)
                    .pipe(operators.map(function (testResults) { return new TestResultsBase(testResults.filter(function (x) { return !!x; })); }));
            };
        /**
         * Runs an array of sync and async tests
         * @param data Data to perform tests against
         * @param tests Tests to run
         * @returns Result of tests
         */
        /**
         * Runs an array of sync and async tests
         * @template T
         * @param {?} data Data to perform tests against
         * @param {?} tests Tests to run
         * @param {?=} state
         * @return {?} Result of tests
         */
        RulesEngineService.prototype.runAllTests = /**
         * Runs an array of sync and async tests
         * @template T
         * @param {?} data Data to perform tests against
         * @param {?} tests Tests to run
         * @param {?=} state
         * @return {?} Result of tests
         */
            function (data, tests, state) {
                var _this = this;
                if (!tests || !tests.length)
                    return rxjs.of(new TestResultsBase([]));
                var /** @type {?} */ syncGroups = this.groupTestsBySyncType(tests);
                var /** @type {?} */ syncTestResults = rxjs.of(this.runTests(data, syncGroups.sync, state));
                return syncTestResults.pipe(operators.mergeMap(function (result) {
                    if (!result.passed)
                        return rxjs.of(result);
                    return _this.runTestsAsync(data, syncGroups.async, state);
                }), operators.take(1));
            };
        /**
         * Performs sync test on a set of data
         * @param data Data to perform test against
         * @param test Test to run
         * @returns Result of test
         */
        /**
         * Performs sync test on a set of data
         * @template T
         * @param {?} data Data to perform test against
         * @param {?} test Test to run
         * @param {?=} state
         * @return {?} Result of test
         */
        RulesEngineService.prototype.runTest = /**
         * Performs sync test on a set of data
         * @template T
         * @param {?} data Data to perform test against
         * @param {?} test Test to run
         * @param {?=} state
         * @return {?} Result of test
         */
            function (data, test, state) {
                if (!test)
                    return null;
                var /** @type {?} */ passedTestResult = { passed: true, name: test.name, message: null };
                var /** @type {?} */ failedTestResult = { passed: false, name: test.name, message: test.message };
                var /** @type {?} */ skippedTestResult = { passed: true, skipped: true, name: test.name, message: null };
                var /** @type {?} */ conditionsRuleSetResult = this.processRuleSet(data, test.condition, state);
                if (conditionsRuleSetResult === ProcessResultType.Failed)
                    return skippedTestResult;
                var /** @type {?} */ checkRuleSetResult = this.processRuleSet(data, test.check, state);
                switch (checkRuleSetResult) {
                    case ProcessResultType.Passed:
                        return passedTestResult;
                    case ProcessResultType.Failed:
                        return failedTestResult;
                    case ProcessResultType.Skipped:
                    default:
                        return skippedTestResult;
                }
            };
        /**
         * Performs async test on a set of data
         * @param data Data to perform test against
         * @param test Test to run
         * @returns Result of test
         */
        /**
         * Performs async test on a set of data
         * @template T
         * @param {?} data Data to perform test against
         * @param {?} test Test to run
         * @param {?=} state
         * @return {?} Result of test
         */
        RulesEngineService.prototype.runTestAsync = /**
         * Performs async test on a set of data
         * @template T
         * @param {?} data Data to perform test against
         * @param {?} test Test to run
         * @param {?=} state
         * @return {?} Result of test
         */
            function (data, test, state) {
                if (!test)
                    return rxjs.of(null);
                var /** @type {?} */ passedTestResult = { passed: true, name: test.name, message: null };
                var /** @type {?} */ failedTestResult = { passed: false, name: test.name, message: test.message };
                var /** @type {?} */ skippedTestResult = { passed: true, skipped: true, name: test.name, message: null };
                var /** @type {?} */ conditionsRuleSetResult$ = this.processRuleSetAsync(data, test.condition, state);
                var /** @type {?} */ checkRuleSetResult$ = this.processRuleSetAsync(data, test.check, state);
                return conditionsRuleSetResult$
                    .pipe(operators.flatMap(function (conditionsRuleSetResult) {
                    if (conditionsRuleSetResult === ProcessResultType.Failed)
                        return rxjs.of(skippedTestResult);
                    return checkRuleSetResult$
                        .pipe(operators.map(function (checkRuleSetResult) {
                        switch (checkRuleSetResult) {
                            case ProcessResultType.Passed:
                                return passedTestResult;
                            case ProcessResultType.Failed:
                                return failedTestResult;
                            case ProcessResultType.Skipped:
                            default:
                                return skippedTestResult;
                        }
                    }));
                }));
            };
        /**
         * Processes a sync rule set
         * @param data Data to process rule set against
         * @param ruleSet Rule set to process
         * @returns Result of rule set processing
         */
        /**
         * Processes a sync rule set
         * @template T
         * @param {?} data Data to process rule set against
         * @param {?} ruleSet Rule set to process
         * @param {?=} state
         * @return {?} Result of rule set processing
         */
        RulesEngineService.prototype.processRuleSet = /**
         * Processes a sync rule set
         * @template T
         * @param {?} data Data to process rule set against
         * @param {?} ruleSet Rule set to process
         * @param {?=} state
         * @return {?} Result of rule set processing
         */
            function (data, ruleSet, state) {
                if (!ruleSet)
                    return ProcessResultType.Skipped;
                var /** @type {?} */ isRuleGroup = this.isRuleGroup(ruleSet);
                return isRuleGroup
                    ? this.processRuleGroup(data, /** @type {?} */ (ruleSet), state)
                    : this.processRule(data, /** @type {?} */ (ruleSet), state);
            };
        /**
         * Processes an async rule set
         * @param data Data to process rule set against
         * @param ruleSet Rule set to process
         * @returns Result of rule set processing
         */
        /**
         * Processes an async rule set
         * @template T
         * @param {?} data Data to process rule set against
         * @param {?} ruleSet Rule set to process
         * @param {?=} state
         * @return {?} Result of rule set processing
         */
        RulesEngineService.prototype.processRuleSetAsync = /**
         * Processes an async rule set
         * @template T
         * @param {?} data Data to process rule set against
         * @param {?} ruleSet Rule set to process
         * @param {?=} state
         * @return {?} Result of rule set processing
         */
            function (data, ruleSet, state) {
                if (!ruleSet)
                    return rxjs.of(ProcessResultType.Skipped);
                var /** @type {?} */ isRuleGroup = this.isRuleGroup(ruleSet);
                return isRuleGroup
                    ? this.processRuleGroupAsync(data, /** @type {?} */ (ruleSet), state)
                    : this.processRuleAsync(data, /** @type {?} */ (ruleSet), state);
            };
        /**
         * @template T
         * @param {?} data
         * @param {?} ruleGroup
         * @param {?=} state
         * @return {?}
         */
        RulesEngineService.prototype.processRuleGroup = /**
         * @template T
         * @param {?} data
         * @param {?} ruleGroup
         * @param {?=} state
         * @return {?}
         */
            function (data, ruleGroup, state) {
                if (!ruleGroup.rules)
                    return ProcessResultType.Skipped;
                var /** @type {?} */ passedCount = 0;
                var /** @type {?} */ skippedCount = 0;
                for (var /** @type {?} */ i = 0; i < ruleGroup.rules.length; i++) {
                    var /** @type {?} */ rule = ruleGroup.rules[i];
                    var /** @type {?} */ ruleSetResult = this.processRuleSet(data, rule, state);
                    if (this.canShortCircuitRuleGroup(ruleSetResult, ruleGroup))
                        return ruleSetResult;
                    if (ruleSetResult == ProcessResultType.Passed)
                        passedCount++;
                    else if (ruleSetResult == ProcessResultType.Skipped)
                        skippedCount++;
                }
                // if we skipped them all, then return skipped
                if (skippedCount === ruleGroup.rules.length)
                    return ProcessResultType.Skipped;
                // if we got this far, make sure all tests were passed
                return passedCount === ruleGroup.rules.length ? ProcessResultType.Passed : ProcessResultType.Failed;
            };
        /**
         * @template T
         * @param {?} data
         * @param {?} ruleGroup
         * @param {?=} state
         * @return {?}
         */
        RulesEngineService.prototype.processRuleGroupAsync = /**
         * @template T
         * @param {?} data
         * @param {?} ruleGroup
         * @param {?=} state
         * @return {?}
         */
            function (data, ruleGroup, state) {
                var _this = this;
                if (!ruleGroup.rules)
                    return rxjs.of(ProcessResultType.Skipped);
                var /** @type {?} */ asyncRuleSetResults$ = ruleGroup.rules.map(function (x) { return _this.processRuleSetAsync(data, x, state); });
                return rxjs.forkJoin(asyncRuleSetResults$).pipe(operators.map(function (ruleSetResults) {
                    var /** @type {?} */ counts = {
                        passed: ruleSetResults.filter(function (x) { return x === ProcessResultType.Passed; }).length,
                        failed: ruleSetResults.filter(function (x) { return x === ProcessResultType.Failed; }).length,
                        skipped: ruleSetResults.filter(function (x) { return x === ProcessResultType.Skipped; }).length,
                    };
                    var /** @type {?} */ ruleGroupOptions = ruleGroup.options || { resultRequirements: ResultsPassRequirement.AllPass };
                    if (ruleGroupOptions.resultRequirements == ResultsPassRequirement.AnyPass && counts.passed > 0)
                        return ProcessResultType.Passed;
                    if (ruleGroupOptions.resultRequirements == ResultsPassRequirement.AllPass && counts.passed === ruleSetResults.length)
                        return ProcessResultType.Passed;
                    if (counts.skipped === ruleSetResults.length)
                        return ProcessResultType.Skipped;
                    return ProcessResultType.Failed;
                }));
            };
        /**
         * @template T
         * @param {?} data
         * @param {?} rule
         * @param {?=} state
         * @return {?}
         */
        RulesEngineService.prototype.processRule = /**
         * @template T
         * @param {?} data
         * @param {?} rule
         * @param {?=} state
         * @return {?}
         */
            function (data, rule, state) {
                if (!rule.func)
                    return ProcessResultType.Skipped;
                var /** @type {?} */ rootData = state ? state.rootData : null;
                return rule.func(data, rootData) ? ProcessResultType.Passed : ProcessResultType.Failed;
            };
        /**
         * @template T
         * @param {?} data
         * @param {?} rule
         * @param {?=} state
         * @return {?}
         */
        RulesEngineService.prototype.processRuleAsync = /**
         * @template T
         * @param {?} data
         * @param {?} rule
         * @param {?=} state
         * @return {?}
         */
            function (data, rule, state) {
                if (!rule.func && !rule.asyncFunc)
                    return rxjs.of(ProcessResultType.Skipped);
                var /** @type {?} */ rootData = state ? state.rootData : null;
                var /** @type {?} */ funcResult = rule.func
                    ? rxjs.of(rule.func(data, rootData))
                    : rule.asyncFunc(data, rootData);
                return funcResult
                    .pipe(operators.map(function (passed) { return passed ? ProcessResultType.Passed : ProcessResultType.Failed; }));
            };
        /**
         * @template T
         * @param {?} ruleSetResult
         * @param {?} ruleGroup
         * @return {?}
         */
        RulesEngineService.prototype.canShortCircuitRuleGroup = /**
         * @template T
         * @param {?} ruleSetResult
         * @param {?} ruleGroup
         * @return {?}
         */
            function (ruleSetResult, ruleGroup) {
                var /** @type {?} */ ruleGroupOptions = ruleGroup.options || { resultRequirements: ResultsPassRequirement.AllPass };
                return (
                // it passed, and we only need one to pass
                (ruleSetResult == ProcessResultType.Passed && ruleGroupOptions.resultRequirements == ResultsPassRequirement.AnyPass)
                    ||
                        // if failed, and we need all to pass
                        (ruleSetResult == ProcessResultType.Failed && ruleGroupOptions.resultRequirements == ResultsPassRequirement.AllPass));
            };
        /**
         * @template T
         * @param {?} ruleSet
         * @return {?}
         */
        RulesEngineService.prototype.isRuleGroup = /**
         * @template T
         * @param {?} ruleSet
         * @return {?}
         */
            function (ruleSet) {
                var /** @type {?} */ rule = (ruleSet);
                return !rule.func && !rule.asyncFunc;
            };
        /**
         * @template T
         * @param {?} test
         * @return {?}
         */
        RulesEngineService.prototype.getDependencyPropertiesFromTest = /**
         * @template T
         * @param {?} test
         * @return {?}
         */
            function (test) {
                var /** @type {?} */ checkDeps = this.getDependencyPropertiesFromRuleSet(test.check);
                var /** @type {?} */ conditionDeps = this.getDependencyPropertiesFromRuleSet(test.condition);
                return this.commonSvc.unique(checkDeps.concat(conditionDeps));
            };
        /**
         * @template T
         * @param {?} ruleSet
         * @return {?}
         */
        RulesEngineService.prototype.getDependencyPropertiesFromRuleSet = /**
         * @template T
         * @param {?} ruleSet
         * @return {?}
         */
            function (ruleSet) {
                var _this = this;
                if (!ruleSet)
                    return [];
                var /** @type {?} */ result = [];
                if (this.isRuleGroup(ruleSet)) {
                    var /** @type {?} */ ruleGroup = (ruleSet);
                    ruleGroup.rules.forEach(function (x) {
                        result.push.apply(result, __spread(_this.commonSvc.unique(_this.getDependencyPropertiesFromRuleSet(x))));
                    });
                }
                var /** @type {?} */ rule = (ruleSet);
                if (rule.options && Array.isArray(rule.options.dependencyProperties)) {
                    result.push.apply(result, __spread(this.commonSvc.unique(rule.options.dependencyProperties)));
                }
                return this.commonSvc.unique(result);
            };
        /**
         * @param {?} properties
         * @param {?} modelSettingsName
         * @param {?=} currentAbsolutePath
         * @return {?}
         */
        RulesEngineService.prototype.setPropertyMetadata = /**
         * @param {?} properties
         * @param {?} modelSettingsName
         * @param {?=} currentAbsolutePath
         * @return {?}
         */
            function (properties, modelSettingsName, currentAbsolutePath) {
                var _this = this;
                if (currentAbsolutePath === void 0) {
                    currentAbsolutePath = '';
                }
                if (!properties)
                    return;
                properties.forEach(function (prop) {
                    var /** @type {?} */ newAbsolutePath = _this.setPropertyAbsolutePath(prop, currentAbsolutePath);
                    _this.fillInEmptyTestNames(prop);
                    prop.setOwnerModelSettingsName(modelSettingsName);
                    if (prop.properties) {
                        _this.setPropertyMetadata(prop.properties, modelSettingsName, newAbsolutePath);
                    }
                    else if (prop.arrayItemProperty) {
                        _this.setPropertyMetadata([prop.arrayItemProperty], modelSettingsName, newAbsolutePath);
                    }
                });
            };
        /**
         * @param {?} property
         * @param {?=} currentAbsolutePath
         * @return {?}
         */
        RulesEngineService.prototype.setPropertyAbsolutePath = /**
         * @param {?} property
         * @param {?=} currentAbsolutePath
         * @return {?}
         */
            function (property, currentAbsolutePath) {
                if (currentAbsolutePath === void 0) {
                    currentAbsolutePath = '';
                }
                var /** @type {?} */ isArrayItemProperty = PropertyBase.isArrayItemProperty(property);
                var /** @type {?} */ newAbsolutePathSegment = isArrayItemProperty ? '[]' : ((property)).name;
                var /** @type {?} */ isAtRoot = !currentAbsolutePath;
                var /** @type {?} */ newAbsolutePath = "" + currentAbsolutePath + (isAtRoot ? '' : '.') + newAbsolutePathSegment;
                // set absolute path for property
                property.setAbsolutePath(newAbsolutePath);
                return newAbsolutePath;
            };
        /**
         * @param {?} property
         * @return {?}
         */
        RulesEngineService.prototype.fillInEmptyTestNames = /**
         * @param {?} property
         * @return {?}
         */
            function (property) {
                property.valid
                    .filter(function (test) { return !test.name; })
                    .forEach(function (test, i) { return test.name = "validTest" + i; });
                property.edit
                    .filter(function (test) { return !test.name; })
                    .forEach(function (test, i) { return test.name = "editTest" + i; });
            };
        /**
         * @template T
         * @param {?} ruleSet
         * @return {?}
         */
        RulesEngineService.prototype.getConfiguredFuncTypes = /**
         * @template T
         * @param {?} ruleSet
         * @return {?}
         */
            function (ruleSet) {
                var _this = this;
                if (!ruleSet)
                    return { sync: false, async: false };
                var /** @type {?} */ isRuleGroup = this.isRuleGroup(ruleSet);
                if (isRuleGroup) {
                    var /** @type {?} */ ruleGroup = (ruleSet);
                    var /** @type {?} */ results = ruleGroup.rules
                        .map(function (rs) {
                        return _this.getConfiguredFuncTypes(rs);
                    });
                    return {
                        sync: results.findIndex(function (x) { return !!x.sync; }) >= 0,
                        async: results.findIndex(function (x) { return !!x.async; }) >= 0,
                    };
                }
                else {
                    var /** @type {?} */ rule = (ruleSet);
                    return {
                        sync: !!rule.func,
                        async: !!rule.asyncFunc
                    };
                }
            };
        RulesEngineService.decorators = [
            { type: core.Injectable },
        ];
        /** @nocollapse */
        RulesEngineService.ctorParameters = function () {
            return [
                { type: Array, decorators: [{ type: core.Optional }, { type: core.Inject, args: [MODEL_SETTINGS_TOKEN,] },] },
                { type: TraceService, },
                { type: CommonService, },
            ];
        };
        return RulesEngineService;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    /**
     * State of an Angular AbstractControl at the time of running a test
     */
    var /**
     * State of an Angular AbstractControl at the time of running a test
     */ ControlState = (function () {
        function ControlState(control) {
            this._pristine = control.pristine;
            this._untouched = control.untouched;
        }
        /**
         * Creates a ControlState object based on an Angular control
         * @param control Angular control to generate state from
         * @returns Control state base on Angular control
         */
        /**
         * Creates a ControlState object based on an Angular control
         * @param {?} control Angular control to generate state from
         * @return {?} Control state base on Angular control
         */
        ControlState.create = /**
         * Creates a ControlState object based on an Angular control
         * @param {?} control Angular control to generate state from
         * @return {?} Control state base on Angular control
         */
            function (control) {
                return new ControlState(control);
            };
        return ControlState;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    /**
     * Builds reactive forms using configured model settings
     */
    var ReactiveFormsRuleService = (function () {
        function ReactiveFormsRuleService(rulesEngineSvc, formBuilder, traceSvc, commonSvc) {
            this.rulesEngineSvc = rulesEngineSvc;
            this.formBuilder = formBuilder;
            this.traceSvc = traceSvc;
            this.commonSvc = commonSvc;
        }
        /**
         * Gets model settings with the provided name
         * @param name Name of model setting
         * @returns Model settings with the provided name
         */
        /**
         * Gets model settings with the provided name
         * @template T
         * @param {?} name Name of model setting
         * @return {?} Model settings with the provided name
         */
        ReactiveFormsRuleService.prototype.getModelSettings = /**
         * Gets model settings with the provided name
         * @template T
         * @param {?} name Name of model setting
         * @return {?} Model settings with the provided name
         */
            function (name) {
                return this.rulesEngineSvc.getModelSettings(name);
            };
        /**
         * Creates a form group using an instance of model settings
         * @param modelSettings Name of the model setting or an instance of model settings to use
         * @param initialValue Initial data to set the form values to
         * @returns Form group created according to defined model settings
         */
        /**
         * Creates a form group using an instance of model settings
         * @template T
         * @param {?} modelSettings Name of the model setting or an instance of model settings to use
         * @param {?=} initialValue Initial data to set the form values to
         * @return {?} Form group created according to defined model settings
         */
        ReactiveFormsRuleService.prototype.createFormGroup = /**
         * Creates a form group using an instance of model settings
         * @template T
         * @param {?} modelSettings Name of the model setting or an instance of model settings to use
         * @param {?=} initialValue Initial data to set the form values to
         * @return {?} Form group created according to defined model settings
         */
            function (modelSettings, initialValue) {
                var /** @type {?} */ settings;
                if (typeof modelSettings === "string") {
                    settings = this.rulesEngineSvc.getModelSettings(/** @type {?} */ (modelSettings));
                    if (!settings)
                        throw new Error("No model setting found with the name \"" + modelSettings + "\"");
                }
                else {
                    if (!modelSettings)
                        throw new Error("Adhoc model setting provided is invalid");
                    settings = /** @type {?} */ (modelSettings);
                    this.rulesEngineSvc.initializeModelSetting(settings);
                }
                this.traceSvc.trace("Creating form group using model settings \"" + settings.name + "\"");
                var /** @type {?} */ formGroup = this.buildGroup(settings.properties, initialValue);
                this.traceSvc.trace("Setting up dependency subscriptions");
                this.resetDependencySubscriptions(formGroup, settings.properties);
                this.traceSvc.trace("Patching form group with initial value");
                this.triggerValueChange(formGroup);
                this.traceSvc.trace("Attaching model settings to form");
                this.attachModelSettingsToForm(formGroup, settings);
                return formGroup;
            };
        /**
         * Adds an array item property to an existing form array
         * @param property ArrayItemProperty to for the array item to be added
         * @param parentFormArray The parent FormArray
         * @param initialValue Initial value of the form array item
         * @param options Options for adding new array item property
         */
        /**
         * Adds an array item property to an existing form array
         * @template T
         * @param {?} property ArrayItemProperty to for the array item to be added
         * @param {?} parentFormArray The parent FormArray
         * @param {?=} initialValue Initial value of the form array item
         * @param {?=} options Options for adding new array item property
         * @return {?}
         */
        ReactiveFormsRuleService.prototype.addArrayItemPropertyControl = /**
         * Adds an array item property to an existing form array
         * @template T
         * @param {?} property ArrayItemProperty to for the array item to be added
         * @param {?} parentFormArray The parent FormArray
         * @param {?=} initialValue Initial value of the form array item
         * @param {?=} options Options for adding new array item property
         * @return {?}
         */
            function (property, parentFormArray, initialValue, options) {
                var /** @type {?} */ control = this.buildAbstractControl(property, initialValue);
                var /** @type {?} */ willBeLastItem = !options || !this.commonSvc.isZeroOrGreater(options.index) || options.index >= parentFormArray.length;
                if (willBeLastItem)
                    parentFormArray.push(control);
                else
                    parentFormArray.insert(options.index, control);
                var /** @type {?} */ modelSettings = this.getModelSettingsFromForm(/** @type {?} */ (parentFormArray.root));
                this.resetDependencySubscriptions(parentFormArray.root, modelSettings.properties);
                // we need to do this because the item could have been added at any index in the array, and we need
                // trigger a value change to trigger any dependency propertiy valdidations
                this.triggerValueChange(parentFormArray);
            };
        /**
         * Extends validators generated by ng-form-rules with your own validators
         * @param control Control to extends the validators for
         * @param validator Validator to add
         */
        /**
         * Extends validators generated by ng-form-rules with your own validators
         * @param {?} control Control to extends the validators for
         * @param {?} validator Validator to add
         * @return {?}
         */
        ReactiveFormsRuleService.prototype.extendValidator = /**
         * Extends validators generated by ng-form-rules with your own validators
         * @param {?} control Control to extends the validators for
         * @param {?} validator Validator to add
         * @return {?}
         */
            function (control, validator) {
                if (!validator)
                    return;
                var /** @type {?} */ validatorArray = Array.isArray(validator) ? validator : [validator];
                control.setValidators(__spread([control.validator], validatorArray).filter(function (validatorFn) { return !!validatorFn; }));
            };
        /**
         * Extends async validators generated by ng-form-rules with your own async validators
         * @param control Control to extends the async validators for
         * @param asyncValidator Async validator to add
         */
        /**
         * Extends async validators generated by ng-form-rules with your own async validators
         * @param {?} control Control to extends the async validators for
         * @param {?} asyncValidator Async validator to add
         * @return {?}
         */
        ReactiveFormsRuleService.prototype.extendAsyncValidator = /**
         * Extends async validators generated by ng-form-rules with your own async validators
         * @param {?} control Control to extends the async validators for
         * @param {?} asyncValidator Async validator to add
         * @return {?}
         */
            function (control, asyncValidator) {
                if (!asyncValidator)
                    return;
                var /** @type {?} */ asyncValidatorArray = Array.isArray(asyncValidator) ? asyncValidator : [asyncValidator];
                control.setAsyncValidators(__spread([control.asyncValidator], asyncValidatorArray).filter(function (asyncValidatorFn) { return !!asyncValidatorFn; }));
            };
        /**
         * @template T
         * @param {?} property
         * @param {?=} initialValue
         * @return {?}
         */
        ReactiveFormsRuleService.prototype.buildAbstractControl = /**
         * @template T
         * @param {?} property
         * @param {?=} initialValue
         * @return {?}
         */
            function (property, initialValue) {
                var _this = this;
                var /** @type {?} */ control;
                if (property.arrayItemProperty)
                    control = this.buildArray(property.arrayItemProperty, initialValue, property.updateOn);
                else if (property.properties)
                    control = this.buildGroup(property.properties, initialValue, property.updateOn);
                else
                    control = this.buildControl(initialValue, property.updateOn);
                // setup validation tests on value change
                control.setValidators(this.buildValidatorFunction(property));
                control.setAsyncValidators(this.buildAsyncValidatorFunction(property));
                // setup edit tests on value change
                control.valueChanges
                    .pipe(this.applyValueChangeOptions(property.valueChangeOptions.self.edit))
                    .subscribe(function (value) {
                    _this.persistEditTests(control, property);
                });
                return control;
            };
        /**
         * @template T
         * @param {?} initialValue
         * @param {?=} updateOn
         * @return {?}
         */
        ReactiveFormsRuleService.prototype.buildControl = /**
         * @template T
         * @param {?} initialValue
         * @param {?=} updateOn
         * @return {?}
         */
            function (initialValue, updateOn) {
                return new forms.FormControl(initialValue, { updateOn: updateOn });
            };
        /**
         * @template T
         * @param {?} properties
         * @param {?} initialValue
         * @param {?=} updateOn
         * @return {?}
         */
        ReactiveFormsRuleService.prototype.buildGroup = /**
         * @template T
         * @param {?} properties
         * @param {?} initialValue
         * @param {?=} updateOn
         * @return {?}
         */
            function (properties, initialValue, updateOn) {
                var _this = this;
                var /** @type {?} */ formGroup = new forms.FormGroup({}, { updateOn: updateOn });
                (properties || []).forEach(function (p) {
                    var /** @type {?} */ propertyValue = initialValue ? initialValue[p.name] : null;
                    var /** @type {?} */ ctrl = _this.buildAbstractControl(p, propertyValue);
                    formGroup.addControl(p.name, ctrl);
                });
                return formGroup;
            };
        /**
         * @template T
         * @param {?} property
         * @param {?} initialValue
         * @param {?=} updateOn
         * @return {?}
         */
        ReactiveFormsRuleService.prototype.buildArray = /**
         * @template T
         * @param {?} property
         * @param {?} initialValue
         * @param {?=} updateOn
         * @return {?}
         */
            function (property, initialValue, updateOn) {
                var _this = this;
                initialValue = Array.isArray(initialValue) ? initialValue : [];
                return new forms.FormArray(initialValue.map(function (v) { return _this.buildAbstractControl(property, v); }), { updateOn: updateOn });
            };
        /**
         * @template T
         * @param {?} property
         * @return {?}
         */
        ReactiveFormsRuleService.prototype.buildValidatorFunction = /**
         * @template T
         * @param {?} property
         * @return {?}
         */
            function (property) {
                var _this = this;
                var /** @type {?} */ syncGroups = this.rulesEngineSvc.groupTestsBySyncType(property.valid);
                if (!syncGroups.sync.length)
                    return null;
                return function (control) {
                    var /** @type {?} */ controlContextValues = _this.getControlContextValues(control, property);
                    var /** @type {?} */ testResults = _this.rulesEngineSvc
                        .runTests(controlContextValues.relative, syncGroups.sync, {
                        rootData: controlContextValues.root,
                        controlState: ControlState.create(control)
                    });
                    if (testResults.results.length) {
                        _this.traceSvc.trace("Validated property \"" + property.absolutePath + "\". " +
                            _this.buildTestResultStatsString(testResults));
                    }
                    return _this.mapToReactiveFormsValidationErrors(testResults);
                };
            };
        /**
         * @template T
         * @param {?} property
         * @return {?}
         */
        ReactiveFormsRuleService.prototype.buildAsyncValidatorFunction = /**
         * @template T
         * @param {?} property
         * @return {?}
         */
            function (property) {
                var _this = this;
                var /** @type {?} */ rawAsyncFunc = this.buildAsyncValidatorFunctionRaw(property);
                if (!rawAsyncFunc)
                    return null;
                var /** @type {?} */ values = new rxjs.BehaviorSubject(null);
                var /** @type {?} */ valid$ = values.pipe(this.applyAsyncValidValueChangeOptions(property.valueChangeOptions.self.asyncValid), operators.switchMap(function (x) {
                    // pass through means we did not execute the ng-form-rules async tests
                    if (x.passthrough) {
                        var /** @type {?} */ currentErrors = x.control.errors || {};
                        var /** @type {?} */ lastNgFormRulesErrors = _this.getLastErrorForControl(x.control);
                        // return the last ng-form-rules errors (if any) alongside non ng-form-rules errors.
                        // this handles scenario where debounce and distinct are used and state goes from:
                        //    invalid -> make changes and back them out -> valid
                        return rxjs.of(Object.assign(currentErrors, /** @type {?} */ ({ ngFormRules: lastNgFormRulesErrors })));
                    }
                    else {
                        return rawAsyncFunc(x.control);
                    }
                }), operators.take(1));
                return function (control) {
                    values.next(control);
                    return valid$;
                };
            };
        /**
         * @template T
         * @param {?} property
         * @return {?}
         */
        ReactiveFormsRuleService.prototype.buildAsyncValidatorFunctionRaw = /**
         * @template T
         * @param {?} property
         * @return {?}
         */
            function (property) {
                var _this = this;
                var /** @type {?} */ syncGroups = this.rulesEngineSvc.groupTestsBySyncType(property.valid);
                if (!syncGroups.async.length)
                    return null;
                return function (control) {
                    var /** @type {?} */ controlContextValues = _this.getControlContextValues(control, property);
                    return _this.rulesEngineSvc.runTestsAsync(controlContextValues.relative, syncGroups.async, {
                        rootData: controlContextValues.root,
                        controlState: ControlState.create(control)
                    }).pipe(operators.tap(function (testResults) {
                        if (testResults.results.length) {
                            _this.traceSvc.trace("Validated (async) property \"" + property.absolutePath + "\". " +
                                _this.buildTestResultStatsString(testResults));
                        }
                    }), operators.map(_this.mapToReactiveFormsValidationErrors), operators.tap(function (x) { return _this.setLastErrorForControl(control, (x || {})["ngFormRules"]); }));
                };
            };
        /**
         * @template T
         * @param {?} parentControl
         * @param {?} properties
         * @return {?}
         */
        ReactiveFormsRuleService.prototype.resetDependencySubscriptions = /**
         * @template T
         * @param {?} parentControl
         * @param {?} properties
         * @return {?}
         */
            function (parentControl, properties) {
                this.removeDependencySubscriptions(properties);
                this.addDependencySubscriptions(parentControl, properties);
            };
        /**
         * @template T
         * @param {?} properties
         * @return {?}
         */
        ReactiveFormsRuleService.prototype.removeDependencySubscriptions = /**
         * @template T
         * @param {?} properties
         * @return {?}
         */
            function (properties) {
                var _this = this;
                (properties || []).forEach(function (property) {
                    property.clearDependencyPropertySubscriptions();
                    if (property.properties) {
                        _this.removeDependencySubscriptions(property.properties);
                    }
                    if (property.arrayItemProperty) {
                        _this.removeDependencySubscriptions([property.arrayItemProperty]);
                    }
                });
            };
        /**
         * @template T
         * @param {?} parentControl
         * @param {?} properties
         * @param {?=} arrayIndex
         * @return {?}
         */
        ReactiveFormsRuleService.prototype.addDependencySubscriptions = /**
         * @template T
         * @param {?} parentControl
         * @param {?} properties
         * @param {?=} arrayIndex
         * @return {?}
         */
            function (parentControl, properties, arrayIndex) {
                var _this = this;
                (properties || []).forEach(function (property) {
                    var /** @type {?} */ propertyControl = _this.getPropertyFromParent(parentControl, property, arrayIndex);
                    if (!propertyControl)
                        return;
                    _this.setupEditabilityDependencySubscriptions(propertyControl, parentControl, property);
                    _this.setupValidationDependencySubscriptions(propertyControl, parentControl, property);
                    if (property.properties) {
                        _this.addDependencySubscriptions(propertyControl, property.properties);
                    }
                    if (property.arrayItemProperty) {
                        // if there is an arrayItemProperty we know that we are working with a FormArray control
                        var /** @type {?} */ formArrayControl = ((propertyControl));
                        for (var /** @type {?} */ i = 0; i < formArrayControl.length; i++) {
                            _this.addDependencySubscriptions(formArrayControl, [property.arrayItemProperty], i);
                        }
                    }
                });
            };
        /**
         * @template T
         * @param {?} propertyControl
         * @param {?} parentControl
         * @param {?} property
         * @return {?}
         */
        ReactiveFormsRuleService.prototype.setupValidationDependencySubscriptions = /**
         * @template T
         * @param {?} propertyControl
         * @param {?} parentControl
         * @param {?} property
         * @return {?}
         */
            function (propertyControl, parentControl, property) {
                var _this = this;
                var /** @type {?} */ dependencyPropNames = this.rulesEngineSvc.getDependencyProperties(property.valid);
                dependencyPropNames.forEach(function (d) {
                    var /** @type {?} */ dependencyControl = _this.findControlRelatively(parentControl, d);
                    if (!dependencyControl)
                        return;
                    var /** @type {?} */ sub$ = dependencyControl.valueChanges
                        .pipe(_this.applyValueChangeOptions(property.valueChangeOptions.dependencyProperties.valid))
                        .subscribe(function (value) {
                        _this.setForceAsyncValidationTestForControl(propertyControl, true);
                        propertyControl.updateValueAndValidity({ onlySelf: true, emitEvent: false });
                    });
                    property.addDependencyPropertySubscription(sub$);
                });
            };
        /**
         * @template T
         * @param {?} propertyControl
         * @param {?} parentControl
         * @param {?} property
         * @return {?}
         */
        ReactiveFormsRuleService.prototype.setupEditabilityDependencySubscriptions = /**
         * @template T
         * @param {?} propertyControl
         * @param {?} parentControl
         * @param {?} property
         * @return {?}
         */
            function (propertyControl, parentControl, property) {
                var _this = this;
                var /** @type {?} */ dependencyPropNames = this.rulesEngineSvc.getDependencyProperties(property.edit);
                dependencyPropNames.forEach(function (dpn) {
                    var /** @type {?} */ dependencyControl = _this.findControlRelatively(parentControl, dpn);
                    if (!dependencyControl)
                        return;
                    // setup control to perform edit tests when dependency property changes
                    var /** @type {?} */ sub$ = dependencyControl.valueChanges
                        .pipe(_this.applyValueChangeOptions(property.valueChangeOptions.dependencyProperties.edit))
                        .subscribe(function (value) {
                        _this.persistEditTests(propertyControl, property);
                    });
                    property.addDependencyPropertySubscription(sub$);
                });
            };
        /**
         * @template T
         * @param {?} propertyControl
         * @param {?} property
         * @return {?}
         */
        ReactiveFormsRuleService.prototype.persistEditTests = /**
         * @template T
         * @param {?} propertyControl
         * @param {?} property
         * @return {?}
         */
            function (propertyControl, property) {
                var _this = this;
                var /** @type {?} */ controlContextValues = this.getControlContextValues(propertyControl, property);
                this.rulesEngineSvc.editable(controlContextValues.relative, property, {
                    rootData: controlContextValues.root,
                    controlState: ControlState.create(propertyControl)
                }).subscribe(function (testResults) {
                    if (testResults.results.length) {
                        _this.traceSvc.trace("Editable property \"" + property.absolutePath + "\". " +
                            _this.buildTestResultStatsString(testResults));
                    }
                    if (testResults.passed && propertyControl.disabled)
                        propertyControl.enable({ emitEvent: false });
                    else if (!testResults.passed && propertyControl.enabled)
                        propertyControl.disable({ emitEvent: false });
                });
            };
        /**
         * @param {?} valueChangeOptions
         * @return {?}
         */
        ReactiveFormsRuleService.prototype.applyAsyncValidValueChangeOptions = /**
         * @param {?} valueChangeOptions
         * @return {?}
         */
            function (valueChangeOptions) {
                var _this = this;
                return function (source$) {
                    var /** @type {?} */ lastValue;
                    var /** @type {?} */ isForce;
                    return source$.pipe(operators.tap(function (control) {
                        isForce = _this.doesControlHaveForcedAsyncValidation(control);
                        _this.setForceAsyncValidationTestForControl(control, false);
                    }), operators.debounce(function (x) {
                        return isForce || valueChangeOptions.debounceMilliseconds > 0
                            ? rxjs.timer(valueChangeOptions.debounceMilliseconds)
                            : rxjs.EMPTY;
                    }), operators.map(function (control) {
                        return /** @type {?} */ ({
                            control: control,
                            passthrough: !(control.value !== lastValue || !valueChangeOptions.distinctUntilChanged || isForce)
                        });
                    }), operators.tap(function (x) {
                        if (!x.passthrough)
                            lastValue = x.control.value;
                    }));
                };
            };
        /**
         * @param {?} valueChangeOptions
         * @return {?}
         */
        ReactiveFormsRuleService.prototype.applyValueChangeOptions = /**
         * @param {?} valueChangeOptions
         * @return {?}
         */
            function (valueChangeOptions) {
                return function (source$) {
                    return source$.pipe(operators.debounce(function (x) {
                        return valueChangeOptions.debounceMilliseconds > 0
                            ? rxjs.timer(valueChangeOptions.debounceMilliseconds)
                            : rxjs.EMPTY;
                    }), valueChangeOptions.distinctUntilChanged ? operators.distinctUntilChanged() : operators.tap());
                };
            };
        /**
         * @template T
         * @param {?} control
         * @param {?} property
         * @return {?}
         */
        ReactiveFormsRuleService.prototype.getControlContextValues = /**
         * @template T
         * @param {?} control
         * @param {?} property
         * @return {?}
         */
            function (control, property) {
                var /** @type {?} */ rootValue = ((control.root)).getRawValue();
                // use the control value if an array item, otherwise use the parent control
                var /** @type {?} */ relativeValue = PropertyBase.isArrayItemProperty(property)
                    ? control.value
                    : control.parent.getRawValue();
                return {
                    root: rootValue,
                    relative: relativeValue
                };
            };
        /**
         * @template T
         * @param {?} parentControl
         * @param {?} property
         * @param {?=} arrayIndex
         * @return {?}
         */
        ReactiveFormsRuleService.prototype.getPropertyFromParent = /**
         * @template T
         * @param {?} parentControl
         * @param {?} property
         * @param {?=} arrayIndex
         * @return {?}
         */
            function (parentControl, property, arrayIndex) {
                return PropertyBase.isArrayItemProperty(property)
                    ? ((parentControl)).at(arrayIndex)
                    : parentControl.get(((property)).name);
            };
        /**
         * @template T
         * @param {?} testResults
         * @return {?}
         */
        ReactiveFormsRuleService.prototype.mapToReactiveFormsValidationErrors = /**
         * @template T
         * @param {?} testResults
         * @return {?}
         */
            function (testResults) {
                // if passed, Angular reactive forms wants us to return null, otherwise return an object with the validation info
                if (!testResults || testResults.passed)
                    return null;
                var /** @type {?} */ failed = {};
                testResults.failedResults.forEach(function (test) {
                    failed[test.name] = { message: test.message };
                });
                return {
                    ngFormRules: /** @type {?} */ ({
                        message: testResults.message,
                        failed: failed
                    })
                };
            };
        /**
         * @param {?} control
         * @param {?} path
         * @return {?}
         */
        ReactiveFormsRuleService.prototype.findControlRelatively = /**
         * @param {?} control
         * @param {?} path
         * @return {?}
         */
            function (control, path) {
                var _this = this;
                var /** @type {?} */ relativePaths = this.buildControlRelativePathArray(path);
                if (!relativePaths.length)
                    return null;
                var /** @type {?} */ result;
                relativePaths.forEach(function (pathSegment) {
                    result = _this.getControlByPathSegment(result || control, pathSegment);
                    if (!result)
                        return;
                });
                return result;
            };
        /**
         * @param {?} relativePath
         * @return {?}
         */
        ReactiveFormsRuleService.prototype.buildControlRelativePathArray = /**
         * @param {?} relativePath
         * @return {?}
         */
            function (relativePath) {
                var /** @type {?} */ result = [];
                if (!relativePath || typeof relativePath !== "string")
                    return result;
                // takes care of './', '../', and '/'
                var /** @type {?} */ slashSeparated = relativePath.split("/");
                slashSeparated.forEach(function (slashItem) {
                    var /** @type {?} */ dotSeparated = slashItem.split(".")
                        .filter(function (dotItem) { return !!dotItem; });
                    if (dotSeparated.length)
                        result.push.apply(result, __spread(dotSeparated));
                    else
                        result.push(slashItem);
                });
                return result;
            };
        /**
         * @param {?} control
         * @param {?} pathSegment
         * @return {?}
         */
        ReactiveFormsRuleService.prototype.getControlByPathSegment = /**
         * @param {?} control
         * @param {?} pathSegment
         * @return {?}
         */
            function (control, pathSegment) {
                switch (pathSegment) {
                    case "":
                        return control.root;
                    case "..":
                        return control.parent;
                    case ".":
                        return control;
                    default:
                        return control.get(pathSegment);
                }
            };
        /**
         * @template T
         * @param {?} testResults
         * @return {?}
         */
        ReactiveFormsRuleService.prototype.buildTestResultStatsString = /**
         * @template T
         * @param {?} testResults
         * @return {?}
         */
            function (testResults) {
                return "Executed " + testResults.results.length + " tests " +
                    ("(" + testResults.passedResults.length + " PASS | ") +
                    (testResults.failedResults.length + " FAIL | ")
                    + (testResults.skippedResults.length + " SKIP)");
            };
        /**
         * @template T
         * @param {?} formGroup
         * @param {?} modelSettings
         * @return {?}
         */
        ReactiveFormsRuleService.prototype.attachModelSettingsToForm = /**
         * @template T
         * @param {?} formGroup
         * @param {?} modelSettings
         * @return {?}
         */
            function (formGroup, modelSettings) {
                formGroup[ReactiveFormsRuleService.FORM_MODEL_SETTINGS_PROPERTY_NAME] = modelSettings;
            };
        /**
         * @template T
         * @param {?} formGroup
         * @return {?}
         */
        ReactiveFormsRuleService.prototype.getModelSettingsFromForm = /**
         * @template T
         * @param {?} formGroup
         * @return {?}
         */
            function (formGroup) {
                return /** @type {?} */ (formGroup[ReactiveFormsRuleService.FORM_MODEL_SETTINGS_PROPERTY_NAME]);
            };
        /**
         * @param {?} control
         * @param {?} force
         * @return {?}
         */
        ReactiveFormsRuleService.prototype.setForceAsyncValidationTestForControl = /**
         * @param {?} control
         * @param {?} force
         * @return {?}
         */
            function (control, force) {
                control[ReactiveFormsRuleService.FORCE_ASYNC_VALID_TEST_RUN_PROPERTY_NAME] = force;
            };
        /**
         * @param {?} control
         * @param {?} errors
         * @return {?}
         */
        ReactiveFormsRuleService.prototype.setLastErrorForControl = /**
         * @param {?} control
         * @param {?} errors
         * @return {?}
         */
            function (control, errors) {
                control[ReactiveFormsRuleService.CONTROL_LAST_ERROR] = errors;
            };
        /**
         * @param {?} control
         * @return {?}
         */
        ReactiveFormsRuleService.prototype.getLastErrorForControl = /**
         * @param {?} control
         * @return {?}
         */
            function (control) {
                return control[ReactiveFormsRuleService.CONTROL_LAST_ERROR];
            };
        /**
         * @param {?} control
         * @return {?}
         */
        ReactiveFormsRuleService.prototype.doesControlHaveForcedAsyncValidation = /**
         * @param {?} control
         * @return {?}
         */
            function (control) {
                return !!(control[ReactiveFormsRuleService.FORCE_ASYNC_VALID_TEST_RUN_PROPERTY_NAME]);
            };
        /**
         * @param {?} control
         * @return {?}
         */
        ReactiveFormsRuleService.prototype.triggerValueChange = /**
         * @param {?} control
         * @return {?}
         */
            function (control) {
                control.patchValue(control.value);
            };
        ReactiveFormsRuleService.FORM_MODEL_SETTINGS_PROPERTY_NAME = 'ngFormRulesModelSetting';
        ReactiveFormsRuleService.FORCE_ASYNC_VALID_TEST_RUN_PROPERTY_NAME = 'ngFormRulesForceAsyncValidTestRun';
        ReactiveFormsRuleService.CONTROL_LAST_ERROR = 'ngFormRulesControlLastError';
        ReactiveFormsRuleService.decorators = [
            { type: core.Injectable },
        ];
        /** @nocollapse */
        ReactiveFormsRuleService.ctorParameters = function () {
            return [
                { type: RulesEngineService, },
                { type: forms.FormBuilder, },
                { type: TraceService, },
                { type: CommonService, },
            ];
        };
        return ReactiveFormsRuleService;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    var UtilsModule = (function () {
        function UtilsModule() {
        }
        UtilsModule.decorators = [
            { type: core.NgModule, args: [{
                        imports: [],
                        declarations: [],
                        providers: [
                            TraceService,
                            CommonService
                        ]
                    },] },
        ];
        return UtilsModule;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    var RulesEngineModule = (function () {
        function RulesEngineModule() {
        }
        RulesEngineModule.decorators = [
            { type: core.NgModule, args: [{
                        imports: [
                            common.CommonModule,
                            UtilsModule
                        ],
                        providers: [
                            RulesEngineService,
                            ReactiveFormsRuleService
                        ],
                        declarations: []
                    },] },
        ];
        return RulesEngineModule;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    /**
     * Main module for ng-form-rules
     */
    var FormRulesModule = (function () {
        function FormRulesModule() {
        }
        FormRulesModule.decorators = [
            { type: core.NgModule, args: [{
                        imports: [
                            common.CommonModule,
                            RulesEngineModule,
                        ],
                        declarations: [],
                        exports: [
                            RulesEngineModule,
                        ]
                    },] },
        ];
        return FormRulesModule;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    /**
     * Non-array item property
     * @template T
     */
    var /**
     * Non-array item property
     * @template T
     */ Property = (function (_super) {
        __extends(Property, _super);
        function Property(name) {
            var _this = _super.call(this) || this;
            _this._name = name;
            return _this;
        }
        Object.defineProperty(Property.prototype, "name", {
            /**
             * Name of the property
             */
            get: /**
             * Name of the property
             * @return {?}
             */ function () {
                return this._name;
            },
            enumerable: true,
            configurable: true
        });
        return Property;
    }(PropertyBase));

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    /**
     * A property representing an array item (e.g. an array of Address objects)
     * @template T
     */
    var /**
     * A property representing an array item (e.g. an array of Address objects)
     * @template T
     */ ArrayItemProperty = (function (_super) {
        __extends(ArrayItemProperty, _super);
        function ArrayItemProperty() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return ArrayItemProperty;
    }(PropertyBase));

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    /**
     * Utility class for building model settings
     */
    var /**
     * Utility class for building model settings
     */ ModelSettingsBuilder = (function () {
        function ModelSettingsBuilder() {
        }
        /**
         * Creates a property
         * @param propertyName Property name
         * @param extend Function to extend the property
         * @returns Created property
         */
        /**
         * Creates a property
         * @template T
         * @param {?} propertyName Property name
         * @param {?=} extend Function to extend the property
         * @return {?} Created property
         */
        ModelSettingsBuilder.prototype.property = /**
         * Creates a property
         * @template T
         * @param {?} propertyName Property name
         * @param {?=} extend Function to extend the property
         * @return {?} Created property
         */
            function (propertyName, extend) {
                if (!propertyName || typeof propertyName !== 'string')
                    throw Error('Invalid property name');
                var /** @type {?} */ property = new Property(propertyName);
                if (extend)
                    extend(property);
                return property;
            };
        /**
         * Creates an array item property
         * @param extend Function to extend the array item property
         * @returns Created array item property
         */
        /**
         * Creates an array item property
         * @template T
         * @param {?=} extend Function to extend the array item property
         * @return {?} Created array item property
         */
        ModelSettingsBuilder.prototype.arrayItemProperty = /**
         * Creates an array item property
         * @template T
         * @param {?=} extend Function to extend the array item property
         * @return {?} Created array item property
         */
            function (extend) {
                var /** @type {?} */ property = new ArrayItemProperty();
                if (extend)
                    extend(property);
                return property;
            };
        /**
         * Creates a validation test
         * @param message Message when the test fails
         * @param check Check rule set for the test
         * @param condition Condition rule set for the test
         * @returns Created validation test
         */
        /**
         * Creates a validation test
         * @template T
         * @param {?} message Message when the test fails
         * @param {?} check Check rule set for the test
         * @param {?=} condition Condition rule set for the test
         * @return {?} Created validation test
         */
        ModelSettingsBuilder.prototype.validTest = /**
         * Creates a validation test
         * @template T
         * @param {?} message Message when the test fails
         * @param {?} check Check rule set for the test
         * @param {?=} condition Condition rule set for the test
         * @return {?} Created validation test
         */
            function (message, check, condition) {
                return this.validNamedTest(null, message, check, condition);
            };
        /**
         * Creates a named validation test
         * @param name Name of the test
         * @param message Message when the test fails
         * @param check Check rule set for the test
         * @param condition Condition rule set for the test
         * @returns Created named validation test
         */
        /**
         * Creates a named validation test
         * @template T
         * @param {?} name Name of the test
         * @param {?} message Message when the test fails
         * @param {?} check Check rule set for the test
         * @param {?=} condition Condition rule set for the test
         * @return {?} Created named validation test
         */
        ModelSettingsBuilder.prototype.validNamedTest = /**
         * Creates a named validation test
         * @template T
         * @param {?} name Name of the test
         * @param {?} message Message when the test fails
         * @param {?} check Check rule set for the test
         * @param {?=} condition Condition rule set for the test
         * @return {?} Created named validation test
         */
            function (name, message, check, condition) {
                return /** @type {?} */ ({
                    name: name,
                    message: message,
                    check: check,
                    condition: condition
                });
            };
        /**
         * Creates an edit test
         * @param check Check rule set for the test
         * @param condition Condition rule set for the test
         * @returns Created edit test
         */
        /**
         * Creates an edit test
         * @template T
         * @param {?} check Check rule set for the test
         * @param {?=} condition Condition rule set for the test
         * @return {?} Created edit test
         */
        ModelSettingsBuilder.prototype.editTest = /**
         * Creates an edit test
         * @template T
         * @param {?} check Check rule set for the test
         * @param {?=} condition Condition rule set for the test
         * @return {?} Created edit test
         */
            function (check, condition) {
                return this.editNamedTest(null, check, condition);
            };
        /**
         * Creates a named edit test
         * @param name Name of the test
         * @param check Check rule set for the test
         * @param condition Condition rule set for the test
         * @returns Created named edit test
         */
        /**
         * Creates a named edit test
         * @template T
         * @param {?} name Name of the test
         * @param {?} check Check rule set for the test
         * @param {?=} condition Condition rule set for the test
         * @return {?} Created named edit test
         */
        ModelSettingsBuilder.prototype.editNamedTest = /**
         * Creates a named edit test
         * @template T
         * @param {?} name Name of the test
         * @param {?} check Check rule set for the test
         * @param {?=} condition Condition rule set for the test
         * @return {?} Created named edit test
         */
            function (name, check, condition) {
                return /** @type {?} */ ({
                    name: name,
                    check: check,
                    condition: condition
                });
            };
        /**
         * Creates a rule
         * @param func Function for the rule
         * @param options Additional rule options
         * @returns Created rule
         */
        /**
         * Creates a rule
         * @template T, R
         * @param {?} func Function for the rule
         * @param {?=} options Additional rule options
         * @return {?} Created rule
         */
        ModelSettingsBuilder.prototype.rule = /**
         * Creates a rule
         * @template T, R
         * @param {?} func Function for the rule
         * @param {?=} options Additional rule options
         * @return {?} Created rule
         */
            function (func, options) {
                return this.ruleCombo(func, null, options);
            };
        /**
         * Creates an async rule
         * @param asyncFunc Async function for the rule
         * @param options Additional rule options
         * @returns Created rule
         */
        /**
         * Creates an async rule
         * @template T, R
         * @param {?} asyncFunc Async function for the rule
         * @param {?=} options Additional rule options
         * @return {?} Created rule
         */
        ModelSettingsBuilder.prototype.ruleAsync = /**
         * Creates an async rule
         * @template T, R
         * @param {?} asyncFunc Async function for the rule
         * @param {?=} options Additional rule options
         * @return {?} Created rule
         */
            function (asyncFunc, options) {
                return this.ruleCombo(null, asyncFunc, options);
            };
        /**
         * Creates a combo rule that has both syncronous and async functions
         * @param func Function for the rule
         * @param asyncFunc Async function for the rule
         * @param options Additional rule options
         * @returns Created rule
         */
        /**
         * Creates a combo rule that has both syncronous and async functions
         * @template T, R
         * @param {?} func Function for the rule
         * @param {?} asyncFunc Async function for the rule
         * @param {?=} options Additional rule options
         * @return {?} Created rule
         */
        ModelSettingsBuilder.prototype.ruleCombo = /**
         * Creates a combo rule that has both syncronous and async functions
         * @template T, R
         * @param {?} func Function for the rule
         * @param {?} asyncFunc Async function for the rule
         * @param {?=} options Additional rule options
         * @return {?} Created rule
         */
            function (func, asyncFunc, options) {
                return /** @type {?} */ ({
                    func: func,
                    asyncFunc: asyncFunc,
                    options: options
                });
            };
        /**
         * Creates a rule group
         * @param ruleSets Rule sets for the rule group
         * @param options Additional rule group options
         * @returns Created rule group
         */
        /**
         * Creates a rule group
         * @template T
         * @param {?} ruleSets Rule sets for the rule group
         * @param {?=} options Additional rule group options
         * @return {?} Created rule group
         */
        ModelSettingsBuilder.prototype.ruleGroup = /**
         * Creates a rule group
         * @template T
         * @param {?} ruleSets Rule sets for the rule group
         * @param {?=} options Additional rule group options
         * @return {?} Created rule group
         */
            function (ruleSets, options) {
                return /** @type {?} */ ({
                    rules: ruleSets,
                    options: options || { resultRequirements: ResultsPassRequirement.AllPass }
                });
            };
        return ModelSettingsBuilder;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    /**
     * Base class for model settings
     * @abstract
     * @template T
     */
    var /**
     * Base class for model settings
     * @abstract
     * @template T
     */ AbstractModelSettings = (function () {
        /**
         * Creates model settings
         * @param name Name of the model settings
         */
        function AbstractModelSettings(name) {
            this.builder = new ModelSettingsBuilder();
            this._name = name;
            this.properties = this.buildProperties() || [];
        }
        Object.defineProperty(AbstractModelSettings.prototype, "name", {
            /**
             * Name of the model setting
             */
            get: /**
             * Name of the model setting
             * @return {?}
             */ function () {
                return this._name;
            },
            enumerable: true,
            configurable: true
        });
        return AbstractModelSettings;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    /**
     * @template T
     */
    var /**
     * @template T
     */ PropertyTestResults = (function (_super) {
        __extends(PropertyTestResults, _super);
        function PropertyTestResults(propertyName, results) {
            var _this = _super.call(this, results) || this;
            _this.propertyName = propertyName;
            return _this;
        }
        return PropertyTestResults;
    }(TestResultsBase));

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    /**
     * Class for creating adhoc (non-registered) model settings
     * @template T
     */
    var /**
     * Class for creating adhoc (non-registered) model settings
     * @template T
     */ AdhocModelSettings = (function (_super) {
        __extends(AdhocModelSettings, _super);
        function AdhocModelSettings() {
            // since these settings are not registered, just use a static name
            return _super.call(this, 'adhoc') || this;
        }
        /**
         * Creates model settings
         * @param propertyBuilderFunc Function that takes a ModelSettingsBuilder and uses it to return an array of properties
         * @returns Model settings configured with properties returned from the 'propertyBuilderFunc' function parameter
         */
        /**
         * Creates model settings
         * @template T
         * @param {?} propertyBuilderFunc Function that takes a ModelSettingsBuilder and uses it to return an array of properties
         * @return {?} Model settings configured with properties returned from the 'propertyBuilderFunc' function parameter
         */
        AdhocModelSettings.create = /**
         * Creates model settings
         * @template T
         * @param {?} propertyBuilderFunc Function that takes a ModelSettingsBuilder and uses it to return an array of properties
         * @return {?} Model settings configured with properties returned from the 'propertyBuilderFunc' function parameter
         */
            function (propertyBuilderFunc) {
                var /** @type {?} */ instance = new AdhocModelSettings();
                instance.properties = !!propertyBuilderFunc ? propertyBuilderFunc(instance.builder) || [] : [];
                return instance;
            };
        /**
         * @return {?}
         */
        AdhocModelSettings.prototype.buildProperties = /**
         * @return {?}
         */
            function () {
                // this is just needed to satisfy the AbstractModelSettings<T> contract
                return [];
            };
        return AdhocModelSettings;
    }(AbstractModelSettings));

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    /**
     * Options for how and when to process value changes in a form control
     */
    var /**
     * Options for how and when to process value changes in a form control
     */ ValueChangeOptions = (function () {
        function ValueChangeOptions() {
        }
        return ValueChangeOptions;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */

    exports.FormRulesModule = FormRulesModule;
    exports.MODEL_SETTINGS_TOKEN = MODEL_SETTINGS_TOKEN;
    exports.TRACE_SETTINGS_TOKEN = TRACE_SETTINGS_TOKEN;
    exports.ReactiveFormsRuleService = ReactiveFormsRuleService;
    exports.AbstractModelSettings = AbstractModelSettings;
    exports.ArrayItemProperty = ArrayItemProperty;
    exports.ControlState = ControlState;
    exports.PropertyBase = PropertyBase;
    exports.PropertyTestResults = PropertyTestResults;
    exports.Property = Property;
    exports.TestResultsBase = TestResultsBase;
    exports.AdhocModelSettings = AdhocModelSettings;
    exports.ValueChangeOptions = ValueChangeOptions;
    exports.ResultsPassRequirement = ResultsPassRequirement;
    exports.ModelSettingsBuilder = ModelSettingsBuilder;
    exports.a = RulesEngineModule;
    exports.e = RulesEngineService;
    exports.d = CommonService;
    exports.c = TraceService;
    exports.b = UtilsModule;

    Object.defineProperty(exports, '__esModule', { value: true });

})));

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmctZm9ybS1ydWxlcy51bWQuanMubWFwIiwic291cmNlcyI6W251bGwsIm5nOi8vbmctZm9ybS1ydWxlcy9saWIvZm9ybS1ydWxlcy9pbmplY3Rpb24tdG9rZW5zL21vZGVsLXNldHRpbmdzLnRva2VuLnRzIiwibmc6Ly9uZy1mb3JtLXJ1bGVzL2xpYi9mb3JtLXJ1bGVzL2luamVjdGlvbi10b2tlbnMvdHJhY2Utc2V0dGluZ3MudG9rZW4udHMiLCJuZzovL25nLWZvcm0tcnVsZXMvbGliL3V0aWxzL3RyYWNlL3RyYWNlLnNlcnZpY2UudHMiLCJuZzovL25nLWZvcm0tcnVsZXMvbGliL3V0aWxzL2NvbW1vbi9jb21tb24uc2VydmljZS50cyIsIm5nOi8vbmctZm9ybS1ydWxlcy9saWIvZm9ybS1ydWxlcy9tb2RlbHMvdGVzdC1yZXN1bHRzLWJhc2UudHMiLCJuZzovL25nLWZvcm0tcnVsZXMvbGliL2Zvcm0tcnVsZXMvbW9kZWxzL3Byb3BlcnR5LWJhc2UudHMiLCJuZzovL25nLWZvcm0tcnVsZXMvbGliL3J1bGVzLWVuZ2luZS9zZXJ2aWNlcy9ydWxlcy1lbmdpbmUvcnVsZXMtZW5naW5lLnNlcnZpY2UudHMiLCJuZzovL25nLWZvcm0tcnVsZXMvbGliL2Zvcm0tcnVsZXMvbW9kZWxzL2NvbnRyb2wtc3RhdGUudHMiLCJuZzovL25nLWZvcm0tcnVsZXMvbGliL3J1bGVzLWVuZ2luZS9zZXJ2aWNlcy9yZWFjdGl2ZS1mb3Jtcy1ydWxlL3JlYWN0aXZlLWZvcm1zLXJ1bGUuc2VydmljZS50cyIsIm5nOi8vbmctZm9ybS1ydWxlcy9saWIvdXRpbHMvdXRpbHMubW9kdWxlLnRzIiwibmc6Ly9uZy1mb3JtLXJ1bGVzL2xpYi9ydWxlcy1lbmdpbmUvcnVsZXMtZW5naW5lLm1vZHVsZS50cyIsIm5nOi8vbmctZm9ybS1ydWxlcy9saWIvZm9ybS1ydWxlcy9mb3JtLXJ1bGVzLm1vZHVsZS50cyIsIm5nOi8vbmctZm9ybS1ydWxlcy9saWIvZm9ybS1ydWxlcy9tb2RlbHMvcHJvcGVydHkudHMiLCJuZzovL25nLWZvcm0tcnVsZXMvbGliL2Zvcm0tcnVsZXMvbW9kZWxzL2FycmF5LWl0ZW0tcHJvcGVydHkudHMiLCJuZzovL25nLWZvcm0tcnVsZXMvbGliL2Zvcm0tcnVsZXMvaGVscGVyL21vZGVsLXNldHRpbmdzLWJ1aWxkZXIudHMiLCJuZzovL25nLWZvcm0tcnVsZXMvbGliL2Zvcm0tcnVsZXMvbW9kZWxzL2Fic3RyYWN0LW1vZGVsLXNldHRpbmdzLnRzIiwibmc6Ly9uZy1mb3JtLXJ1bGVzL2xpYi9mb3JtLXJ1bGVzL21vZGVscy9wcm9wZXJ0eS10ZXN0LXJlc3VsdC50cyIsIm5nOi8vbmctZm9ybS1ydWxlcy9saWIvZm9ybS1ydWxlcy9tb2RlbHMvYWRob2MtbW9kZWwtc2V0dGluZ3MudHMiLCJuZzovL25nLWZvcm0tcnVsZXMvbGliL2Zvcm0tcnVsZXMvbW9kZWxzL3ZhbHVlLWNoYW5nZS1vcHRpb25zLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG5Db3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlXHJcbnRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlXHJcbkxpY2Vuc2UgYXQgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcblxyXG5USElTIENPREUgSVMgUFJPVklERUQgT04gQU4gKkFTIElTKiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXHJcbktJTkQsIEVJVEhFUiBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBXSVRIT1VUIExJTUlUQVRJT04gQU5ZIElNUExJRURcclxuV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIFRJVExFLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSxcclxuTUVSQ0hBTlRBQkxJVFkgT1IgTk9OLUlORlJJTkdFTUVOVC5cclxuXHJcblNlZSB0aGUgQXBhY2hlIFZlcnNpb24gMi4wIExpY2Vuc2UgZm9yIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9uc1xyXG5hbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXHJcbi8qIGdsb2JhbCBSZWZsZWN0LCBQcm9taXNlICovXHJcblxyXG52YXIgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHRlbmRzKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxufVxyXG5cclxuZXhwb3J0IHZhciBfX2Fzc2lnbiA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gX19hc3NpZ24odCkge1xyXG4gICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcclxuICAgICAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkpIHRbcF0gPSBzW3BdO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3Jlc3QocywgZSkge1xyXG4gICAgdmFyIHQgPSB7fTtcclxuICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSAmJiBlLmluZGV4T2YocCkgPCAwKVxyXG4gICAgICAgIHRbcF0gPSBzW3BdO1xyXG4gICAgaWYgKHMgIT0gbnVsbCAmJiB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gXCJmdW5jdGlvblwiKVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBwID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzKTsgaSA8IHAubGVuZ3RoOyBpKyspIGlmIChlLmluZGV4T2YocFtpXSkgPCAwKVxyXG4gICAgICAgICAgICB0W3BbaV1dID0gc1twW2ldXTtcclxuICAgIHJldHVybiB0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xyXG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XHJcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xyXG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcGFyYW0ocGFyYW1JbmRleCwgZGVjb3JhdG9yKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCwga2V5KSB7IGRlY29yYXRvcih0YXJnZXQsIGtleSwgcGFyYW1JbmRleCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpIHtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0ZXIodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHJlc3VsdC52YWx1ZSk7IH0pLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZ2VuZXJhdG9yKHRoaXNBcmcsIGJvZHkpIHtcclxuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XHJcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xyXG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcclxuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0geVtvcFswXSAmIDIgPyBcInJldHVyblwiIDogb3BbMF0gPyBcInRocm93XCIgOiBcIm5leHRcIl0pICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xyXG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gWzAsIHQudmFsdWVdO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XHJcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cclxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXhwb3J0U3RhcihtLCBleHBvcnRzKSB7XHJcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3ZhbHVlcyhvKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl0sIGkgPSAwO1xyXG4gICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDtcclxuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3JlYWQobywgbikge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdO1xyXG4gICAgaWYgKCFtKSByZXR1cm4gbztcclxuICAgIHZhciBpID0gbS5jYWxsKG8pLCByLCBhciA9IFtdLCBlO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICB3aGlsZSAoKG4gPT09IHZvaWQgMCB8fCBuLS0gPiAwKSAmJiAhKHIgPSBpLm5leHQoKSkuZG9uZSkgYXIucHVzaChyLnZhbHVlKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlcnJvcikgeyBlID0geyBlcnJvcjogZXJyb3IgfTsgfVxyXG4gICAgZmluYWxseSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKHIgJiYgIXIuZG9uZSAmJiAobSA9IGlbXCJyZXR1cm5cIl0pKSBtLmNhbGwoaSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZpbmFsbHkgeyBpZiAoZSkgdGhyb3cgZS5lcnJvcjsgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWQoKSB7XHJcbiAgICBmb3IgKHZhciBhciA9IFtdLCBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKylcclxuICAgICAgICBhciA9IGFyLmNvbmNhdChfX3JlYWQoYXJndW1lbnRzW2ldKSk7XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0KHYpIHtcclxuICAgIHJldHVybiB0aGlzIGluc3RhbmNlb2YgX19hd2FpdCA/ICh0aGlzLnYgPSB2LCB0aGlzKSA6IG5ldyBfX2F3YWl0KHYpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0dlbmVyYXRvcih0aGlzQXJnLCBfYXJndW1lbnRzLCBnZW5lcmF0b3IpIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgZyA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSwgaSwgcSA9IFtdO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlmIChnW25dKSBpW25dID0gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChhLCBiKSB7IHEucHVzaChbbiwgdiwgYSwgYl0pID4gMSB8fCByZXN1bWUobiwgdik7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiByZXN1bWUobiwgdikgeyB0cnkgeyBzdGVwKGdbbl0odikpOyB9IGNhdGNoIChlKSB7IHNldHRsZShxWzBdWzNdLCBlKTsgfSB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKHIpIHsgci52YWx1ZSBpbnN0YW5jZW9mIF9fYXdhaXQgPyBQcm9taXNlLnJlc29sdmUoci52YWx1ZS52KS50aGVuKGZ1bGZpbGwsIHJlamVjdCkgOiBzZXR0bGUocVswXVsyXSwgcik7ICB9XHJcbiAgICBmdW5jdGlvbiBmdWxmaWxsKHZhbHVlKSB7IHJlc3VtZShcIm5leHRcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiByZWplY3QodmFsdWUpIHsgcmVzdW1lKFwidGhyb3dcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUoZiwgdikgeyBpZiAoZih2KSwgcS5zaGlmdCgpLCBxLmxlbmd0aCkgcmVzdW1lKHFbMF1bMF0sIHFbMF1bMV0pOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jRGVsZWdhdG9yKG8pIHtcclxuICAgIHZhciBpLCBwO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiLCBmdW5jdGlvbiAoZSkgeyB0aHJvdyBlOyB9KSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobiwgZikgeyBpZiAob1tuXSkgaVtuXSA9IGZ1bmN0aW9uICh2KSB7IHJldHVybiAocCA9ICFwKSA/IHsgdmFsdWU6IF9fYXdhaXQob1tuXSh2KSksIGRvbmU6IG4gPT09IFwicmV0dXJuXCIgfSA6IGYgPyBmKHYpIDogdjsgfTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY1ZhbHVlcyhvKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIG0gPSBvW1N5bWJvbC5hc3luY0l0ZXJhdG9yXTtcclxuICAgIHJldHVybiBtID8gbS5jYWxsKG8pIDogdHlwZW9mIF9fdmFsdWVzID09PSBcImZ1bmN0aW9uXCIgPyBfX3ZhbHVlcyhvKSA6IG9bU3ltYm9sLml0ZXJhdG9yXSgpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tYWtlVGVtcGxhdGVPYmplY3QoY29va2VkLCByYXcpIHtcclxuICAgIGlmIChPYmplY3QuZGVmaW5lUHJvcGVydHkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNvb2tlZCwgXCJyYXdcIiwgeyB2YWx1ZTogcmF3IH0pOyB9IGVsc2UgeyBjb29rZWQucmF3ID0gcmF3OyB9XHJcbiAgICByZXR1cm4gY29va2VkO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0U3Rhcihtb2QpIHtcclxuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XHJcbiAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSBpZiAoT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgcmVzdWx0W2tdID0gbW9kW2tdO1xyXG4gICAgcmVzdWx0LmRlZmF1bHQgPSBtb2Q7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnREZWZhdWx0KG1vZCkge1xyXG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBkZWZhdWx0OiBtb2QgfTtcclxufVxyXG4iLCJpbXBvcnQgeyBJbmplY3Rpb25Ub2tlbiB9IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XHJcblxyXG4vKipcclxuICogSW5qZWN0aW9uIHRva2VuIGZvciBwcm92aWRpbmcgYW4gYXJyYXkgb2YgbW9kZWwgc2V0dGluZ3NcclxuICovXHJcbmV4cG9ydCBsZXQgTU9ERUxfU0VUVElOR1NfVE9LRU4gPSBuZXcgSW5qZWN0aW9uVG9rZW48c3RyaW5nPignbmdmci5tb2RlbC1zZXR0aW5ncycpOyIsImltcG9ydCB7IEluamVjdGlvblRva2VuIH0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcclxuXHJcbi8qKlxyXG4gKiBJbmplY3Rpb24gdG9rZW4gZm9yIGVuYWJsaW5nIG5nLWZvcm0tcnVsZXMgdHJhY2luZ1xyXG4gKi9cclxuZXhwb3J0IGxldCBUUkFDRV9TRVRUSU5HU19UT0tFTiA9IG5ldyBJbmplY3Rpb25Ub2tlbjxzdHJpbmc+KCduZ2ZyLnRyYWNlLXNldHRpbmdzJyk7IiwiaW1wb3J0IHsgSW5qZWN0YWJsZSwgSW5qZWN0LCBPcHRpb25hbCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBUUkFDRV9TRVRUSU5HU19UT0tFTiB9IGZyb20gJy4uLy4uL2Zvcm0tcnVsZXMvaW5qZWN0aW9uLXRva2Vucy90cmFjZS1zZXR0aW5ncy50b2tlbic7XHJcblxyXG5ASW5qZWN0YWJsZSgpXHJcbmV4cG9ydCBjbGFzcyBUcmFjZVNlcnZpY2Uge1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgQE9wdGlvbmFsKCkgQEluamVjdChUUkFDRV9TRVRUSU5HU19UT0tFTikgcHJpdmF0ZSBkb1RyYWNlOiBib29sZWFuID0gZmFsc2VcclxuICAgICkge1xyXG4gICAgfVxyXG5cclxuICAgIHRyYWNlKG1zZzogc3RyaW5nKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmRvVHJhY2UpIHJldHVybjtcclxuXHJcbiAgICAgICAgY29uc3QgZnVsbE1zZyA9IGBbTkdGUiAtICR7dGhpcy5nZXRUaW1lU3RhbXAoKX1dICR7bXNnfWA7XHJcbiAgICAgICAgY29uc29sZS5sb2coZnVsbE1zZyk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXRUaW1lU3RhbXAoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gKG5ldyBEYXRlKS50b0xvY2FsZVRpbWVTdHJpbmcoKTtcclxuICAgIH1cclxufVxyXG4iLCJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcblxyXG5ASW5qZWN0YWJsZSgpXHJcbmV4cG9ydCBjbGFzcyBDb21tb25TZXJ2aWNlIHtcclxuICAgIC8qKlxyXG4gICAgICogR2V0cyB1bmlxdWUgdmFsdWVzIGZyb20gYW4gYXJyYXlcclxuICAgICAqIEBwYXJhbSB2YWx1ZXMgVmFsdWVzIHRvIGdldCB1bmlxdWUgaXRlbXMgZnJvbVxyXG4gICAgICogQHJldHVybnMgVW5pcXVlIHZhbHVlcyBhcnJheVxyXG4gICAgICovXHJcbiAgICB1bmlxdWUodmFsdWVzOiBhbnlbXSk6IGFueVtdIHtcclxuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkodmFsdWVzKSkgcmV0dXJuIFtdO1xyXG5cclxuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbShuZXcgU2V0KHZhbHVlcykpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRGV0ZXJtaW5lcyBpZiBudW1iZXIgaXMgemVybyBvciBncmVhdGVyXHJcbiAgICAgKiBAcGFyYW0gdmFsdWUgSWYgbnVtYmVyIGlzIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB6ZXJvXHJcbiAgICAgKi9cclxuICAgIGlzWmVyb09yR3JlYXRlcih2YWx1ZTogbnVtYmVyKTogYm9vbGVhbiB7XHJcbiAgICAgICAgaWYgKCF2YWx1ZSAmJiB2YWx1ZSA9PT0gMCkgcmV0dXJuIHRydWU7XHJcblxyXG4gICAgICAgIGlmICghdmFsdWUgfHwgdHlwZW9mIHZhbHVlICE9PSBcIm51bWJlclwiKSByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgICAgIHJldHVybiB2YWx1ZSA+IDA7XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgVGVzdFJlc3VsdCB9IGZyb20gXCIuL3Rlc3QtcmVzdWx0XCI7XHJcblxyXG4vKipcclxuICogUmVzdWx0cyBvZiBleGVjdXRpbmcgYSBjb2xsZWN0aW9uIG9mIHRlc3RzXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgVGVzdFJlc3VsdHNCYXNlPFQ+IHtcclxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyByZXN1bHRzOiBUZXN0UmVzdWx0PFQ+W10pIHtcclxuICAgICAgICB0aGlzLnJlc3VsdHMgPSB0aGlzLnJlc3VsdHMgfHwgW107XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBXaGV0aGVyIHRoZSB0ZXN0cyBwYXNzZWRcclxuICAgICAqL1xyXG4gICAgZ2V0IHBhc3NlZCgpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gIXRoaXMuZmFpbGVkUmVzdWx0cy5sZW5ndGg7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBBcnJheSBvZiB0ZXN0IHJlc3VsdHMgdGhhdCBwYXNzZWRcclxuICAgICAqL1xyXG4gICAgZ2V0IHBhc3NlZFJlc3VsdHMoKTogVGVzdFJlc3VsdDxUPltdIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRzLmZpbHRlcih4ID0+ICEheC5wYXNzZWQgJiYgIXguc2tpcHBlZCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBBcnJheSBvZiB0ZXN0IHJlc3VsdHMgdGhhdCBmYWlsZWRcclxuICAgICAqL1xyXG4gICAgZ2V0IGZhaWxlZFJlc3VsdHMoKTogVGVzdFJlc3VsdDxUPltdIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRzLmZpbHRlcih4ID0+ICF4LnBhc3NlZCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBBcnJheSBvZiB0ZXN0IHJlc3VsdHMgdGhhdCB3ZXJlIHNraXBwZWRcclxuICAgICAqL1xyXG4gICAgZ2V0IHNraXBwZWRSZXN1bHRzKCk6IFRlc3RSZXN1bHQ8VD5bXSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmVzdWx0cy5maWx0ZXIoeCA9PiAhIXguc2tpcHBlZCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBNZXNzYWdlIG9mIHRoZSBmaXJzdCB0ZXN0IHRoYXQgZmFpbGVkXHJcbiAgICAgKi9cclxuICAgIGdldCBtZXNzYWdlKCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubWVzc2FnZXNbMF07XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBNZXNzYWdlcyBvZiBhbGwgZmFpbGVkIHRlc3RzXHJcbiAgICAgKi9cclxuICAgIGdldCBtZXNzYWdlcygpOiBzdHJpbmdbXSB7XHJcbiAgICAgICAgY29uc3QgbWVzc2FnZXMgPSB0aGlzLmZhaWxlZFJlc3VsdHMubWFwKHggPT4geC5tZXNzYWdlKTtcclxuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbShuZXcgU2V0KG1lc3NhZ2VzKSk7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgeyBUZXN0IH0gZnJvbSBcIi4vdGVzdFwiO1xyXG5pbXBvcnQgeyBQcm9wZXJ0eSB9IGZyb20gXCIuL3Byb3BlcnR5XCI7XHJcbmltcG9ydCB7IEFycmF5SXRlbVByb3BlcnR5IH0gZnJvbSBcIi4vYXJyYXktaXRlbS1wcm9wZXJ0eVwiO1xyXG5pbXBvcnQgeyBTdWJzY3JpcHRpb24gfSBmcm9tIFwicnhqc1wiO1xyXG5pbXBvcnQgeyBWYWx1ZUNoYW5nZU9wdGlvbnMgfSBmcm9tIFwiLi92YWx1ZS1jaGFuZ2Utb3B0aW9uc1wiO1xyXG5pbXBvcnQgeyBVcGRhdGVPbiB9IGZyb20gXCIuL3VwZGF0ZS1vblwiO1xyXG5cclxuLyoqXHJcbiAqIEJhc2UgY2xhc3MgZm9yIGEgcHJvcGVydHlcclxuICovXHJcbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBQcm9wZXJ0eUJhc2U8VD4ge1xyXG4gICAgcHJpdmF0ZSBfYWJzb2x1dGVQYXRoOiBzdHJpbmc7XHJcbiAgICBwcml2YXRlIF9kZXBlbmRlbmN5UHJvcGVydHlTdWJzY3JpcHRpb25zOiBTdWJzY3JpcHRpb25bXSA9IFtdO1xyXG4gICAgcHJpdmF0ZSBfb3duZXJNb2RlbFNldHRpbmdzTmFtZTogc3RyaW5nO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogVmFsaWRhdGlvbiB0ZXN0c1xyXG4gICAgICovXHJcbiAgICB2YWxpZDogVGVzdDxUPltdID0gW107XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBFZGl0YWJpbGl0eSB0ZXN0c1xyXG4gICAgICovXHJcbiAgICBlZGl0OiBUZXN0PFQ+W10gPSBbXTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFZpZXdhYmlsaXR5IHRlc3RzXHJcbiAgICAgKi9cclxuICAgIC8vIHZpZXc6IFRlc3Q8VD5bXSA9IFtdO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUHJvcGVydGllcyBmb3IgYSBjb21wbGV4IG9iamVjdFxyXG4gICAgICovXHJcbiAgICBwcm9wZXJ0aWVzPzogUHJvcGVydHk8YW55PltdO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUHJvcGVydHkgZm9yIGFuIGl0ZW0gb2YgYW4gYXJyYXlcclxuICAgICAqL1xyXG4gICAgYXJyYXlJdGVtUHJvcGVydHk/OiBBcnJheUl0ZW1Qcm9wZXJ0eTxhbnk+O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogVGhlIGV2ZW50IG5hbWUgZm9yIGNvbnRyb2wgdG8gdXBkYXRlIHVwb24uXHJcbiAgICAgKi9cclxuICAgIHVwZGF0ZU9uPzogVXBkYXRlT24gPSAnY2hhbmdlJztcclxuXHJcbiAgICAvKipcclxuICAgICAqIEFic29sdXRlIHBhdGggdG8gdGhlIHByb3BlcnR5IGZyb20gcm9vdFxyXG4gICAgICovXHJcbiAgICBnZXQgYWJzb2x1dGVQYXRoKCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Fic29sdXRlUGF0aDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEFic29sdXRlIHBhdGggdG8gcHJvcGVydHkgZnJvbSByb290XHJcbiAgICAgKi9cclxuICAgIGdldCBkZXBlbmRlbmN5UHJvcGVydHlTdWJzY3JpcHRpb25zKCk6IFN1YnNjcmlwdGlvbltdIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZGVwZW5kZW5jeVByb3BlcnR5U3Vic2NyaXB0aW9ucztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEFic29sdXRlIHBhdGggdG8gcHJvcGVydHkgZnJvbSByb290XHJcbiAgICAgKi9cclxuICAgIGdldCBvd25lck1vZGVsU2V0dGluZ3NOYW1lKCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX293bmVyTW9kZWxTZXR0aW5nc05hbWU7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBPcHRpb25zIGZvciBob3cgdG8gcmVzcG9uZCB0byB2YWx1ZSBjaGFuZ2VzIG9uIHByb3BlcnR5IGNvbnRyb2wgYW5kIGRlcGVuZGVuY3kgY29udHJvbHNcclxuICAgICAqL1xyXG4gICAgdmFsdWVDaGFuZ2VPcHRpb25zOiB7XHJcbiAgICAgICAgZGVwZW5kZW5jeVByb3BlcnRpZXM6IHtcclxuICAgICAgICAgICAgdmFsaWQ6IFZhbHVlQ2hhbmdlT3B0aW9ucyxcclxuICAgICAgICAgICAgZWRpdDogVmFsdWVDaGFuZ2VPcHRpb25zXHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZWxmOiB7XHJcbiAgICAgICAgICAgIGFzeW5jVmFsaWQ6IFZhbHVlQ2hhbmdlT3B0aW9ucyxcclxuICAgICAgICAgICAgZWRpdDogVmFsdWVDaGFuZ2VPcHRpb25zXHJcbiAgICAgICAgfVxyXG4gICAgfSA9IHtcclxuICAgICAgICBkZXBlbmRlbmN5UHJvcGVydGllczoge1xyXG4gICAgICAgICAgICB2YWxpZDogeyBkaXN0aW5jdFVudGlsQ2hhbmdlZDogZmFsc2UsIGRlYm91bmNlTWlsbGlzZWNvbmRzOiAwIH0sXHJcbiAgICAgICAgICAgIGVkaXQ6IHsgZGlzdGluY3RVbnRpbENoYW5nZWQ6IGZhbHNlLCBkZWJvdW5jZU1pbGxpc2Vjb25kczogMCB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZWxmOiB7XHJcbiAgICAgICAgICAgIGFzeW5jVmFsaWQ6IHsgZGlzdGluY3RVbnRpbENoYW5nZWQ6IGZhbHNlLCBkZWJvdW5jZU1pbGxpc2Vjb25kczogMCB9LFxyXG4gICAgICAgICAgICBlZGl0OiB7IGRpc3RpbmN0VW50aWxDaGFuZ2VkOiBmYWxzZSwgZGVib3VuY2VNaWxsaXNlY29uZHM6IDAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBEZXRlcm1pbmVzIGlmIHRoZSBwcm9wZXJ0eSBpcyBhbiBBcnJheUl0ZW1Qcm9wZXJ0eVxyXG4gICAgICogQHBhcmFtIHByb3BlcnR5IFByb3BlcnR5IHRvIGNoZWNrXHJcbiAgICAgKiBAcmV0dXJucyBXaGV0aGVyIG9yIG5vdCB0aGUgcHJvcGVydHkgaXMgYW4gQXJyYXlJdGVtUHJvcGVydHlcclxuICAgICAqL1xyXG4gICAgc3RhdGljIGlzQXJyYXlJdGVtUHJvcGVydHk8VD4ocHJvcGVydHk6IFByb3BlcnR5QmFzZTxUPik6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiAhKHByb3BlcnR5IGFzIFByb3BlcnR5PFQ+KS5uYW1lO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRE8gTk9UIENBTEwhIEludGVybmFsIHVzZSBvbmx5XHJcbiAgICAgKiBAcGFyYW0gYWJzb2x1dGVQYXRoIEFic29sdXRlIHBhdGggdG8gdGhlIHByb3BlcnR5IGZyb20gdGhlIHJvb3RcclxuICAgICAqL1xyXG4gICAgc2V0QWJzb2x1dGVQYXRoKGFic29sdXRlUGF0aDogc3RyaW5nKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5fYWJzb2x1dGVQYXRoID0gYWJzb2x1dGVQYXRoO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRE8gTk9UIENBTEwhIEludGVybmFsIHVzZSBvbmx5XHJcbiAgICAgKiBAcGFyYW0gc3Vic2NyaXB0aW9uIFN1YnNjcmlwdGlvbiBmb3IgdGhlIGRlcGVuZGVuY3kgcHJvcGVydHlcclxuICAgICAqL1xyXG4gICAgYWRkRGVwZW5kZW5jeVByb3BlcnR5U3Vic2NyaXB0aW9uKHN1YnNjcmlwdGlvbjogU3Vic2NyaXB0aW9uKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5fZGVwZW5kZW5jeVByb3BlcnR5U3Vic2NyaXB0aW9ucy5wdXNoKHN1YnNjcmlwdGlvbik7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBETyBOT1QgQ0FMTCEgSW50ZXJuYWwgdXNlIG9ubHlcclxuICAgICAqL1xyXG4gICAgY2xlYXJEZXBlbmRlbmN5UHJvcGVydHlTdWJzY3JpcHRpb25zKCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuZGVwZW5kZW5jeVByb3BlcnR5U3Vic2NyaXB0aW9ucy5mb3JFYWNoKHN1YiQgPT4gc3ViJC51bnN1YnNjcmliZSgpKTtcclxuICAgICAgICB0aGlzLl9kZXBlbmRlbmN5UHJvcGVydHlTdWJzY3JpcHRpb25zID0gW107XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBETyBOT1QgQ0FMTCEgSW50ZXJuYWwgdXNlIG9ubHlcclxuICAgICAqIEBwYXJhbSBuYW1lIE5hbWUgb2YgdGhlIG93bmVyIG1vZGVsIHNldHRpbmdzXHJcbiAgICAgKi9cclxuICAgIHNldE93bmVyTW9kZWxTZXR0aW5nc05hbWUobmFtZTogc3RyaW5nKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5fb3duZXJNb2RlbFNldHRpbmdzTmFtZSA9IG5hbWU7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgeyBJbmplY3RhYmxlLCBJbmplY3QsIE9wdGlvbmFsIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IE1PREVMX1NFVFRJTkdTX1RPS0VOIH0gZnJvbSAnLi4vLi4vLi4vZm9ybS1ydWxlcy9pbmplY3Rpb24tdG9rZW5zL21vZGVsLXNldHRpbmdzLnRva2VuJztcclxuaW1wb3J0IHsgQWJzdHJhY3RNb2RlbFNldHRpbmdzIH0gZnJvbSAnLi4vLi4vLi4vZm9ybS1ydWxlcy9tb2RlbHMvYWJzdHJhY3QtbW9kZWwtc2V0dGluZ3MnO1xyXG5pbXBvcnQgeyBQcm9wZXJ0eSB9IGZyb20gJy4uLy4uLy4uL2Zvcm0tcnVsZXMvbW9kZWxzL3Byb3BlcnR5JztcclxuaW1wb3J0IHsgUnVsZUdyb3VwIH0gZnJvbSAnLi4vLi4vLi4vZm9ybS1ydWxlcy9tb2RlbHMvcnVsZS1ncm91cCc7XHJcbmltcG9ydCB7IFJ1bGUgfSBmcm9tICcuLi8uLi8uLi9mb3JtLXJ1bGVzL21vZGVscy9ydWxlJztcclxuaW1wb3J0IHsgVGVzdCB9IGZyb20gJy4uLy4uLy4uL2Zvcm0tcnVsZXMvbW9kZWxzL3Rlc3QnO1xyXG5pbXBvcnQgeyBUZXN0UmVzdWx0IH0gZnJvbSAnLi4vLi4vLi4vZm9ybS1ydWxlcy9tb2RlbHMvdGVzdC1yZXN1bHQnO1xyXG5pbXBvcnQgeyBSdWxlU2V0IH0gZnJvbSAnLi4vLi4vLi4vZm9ybS1ydWxlcy9tb2RlbHMvcnVsZS1zZXQnO1xyXG5pbXBvcnQgeyBUZXN0UnVuU3RhdGUgfSBmcm9tICcuLi8uLi8uLi9mb3JtLXJ1bGVzL21vZGVscy90ZXN0LXJ1bi1zdGF0ZSc7XHJcbmltcG9ydCB7IFRyYWNlU2VydmljZSB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL3RyYWNlL3RyYWNlLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBDb21tb25TZXJ2aWNlIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvY29tbW9uL2NvbW1vbi5zZXJ2aWNlJztcclxuaW1wb3J0IHsgT2JzZXJ2YWJsZSwgZm9ya0pvaW4sIG9mIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7ICBtYXAsIGZsYXRNYXAsIG1lcmdlTWFwLCB0YWtlLCB0YXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XHJcbmltcG9ydCB7IFRlc3RSZXN1bHRzQmFzZSB9IGZyb20gJy4uLy4uLy4uL2Zvcm0tcnVsZXMvbW9kZWxzL3Rlc3QtcmVzdWx0cy1iYXNlJztcclxuaW1wb3J0IHsgUHJvcGVydHlUZXN0UmVzdWx0cyB9IGZyb20gJy4uLy4uLy4uL2Zvcm0tcnVsZXMvbW9kZWxzL3Byb3BlcnR5LXRlc3QtcmVzdWx0JztcclxuaW1wb3J0IHsgUHJvcGVydHlCYXNlIH0gZnJvbSAnLi4vLi4vLi4vZm9ybS1ydWxlcy9tb2RlbHMvcHJvcGVydHktYmFzZSc7XHJcbmltcG9ydCB7IFByb2Nlc3NSZXN1bHRUeXBlIH0gZnJvbSAnLi4vLi4vLi4vZm9ybS1ydWxlcy9tb2RlbHMvcHJvY2Nlc3MtcmVzdWx0LXR5cGUnO1xyXG5pbXBvcnQgeyBUZXN0U3luY0dyb3VwcyB9IGZyb20gJy4uLy4uLy4uL2Zvcm0tcnVsZXMvbW9kZWxzL3Rlc3Qtc3luYy1ncm91cHMnO1xyXG5pbXBvcnQgeyBSZXN1bHRzUGFzc1JlcXVpcmVtZW50IH0gZnJvbSAnLi4vLi4vLi4vZm9ybS1ydWxlcy9tb2RlbHMvcmVzdWx0cy1wYXNzLXJlcXVpcmVtZW50JztcclxuXHJcbi8qKlxyXG4gKiBFbmdpbmUgdGhhdCBkaWdlc3RzIG1vZGVsIHNldHRpbmdzIGFuZCBhcHBsaWVzIHRoZWlyIHJ1bGVzIGFwcHJvcHJpYXRlbHlcclxuICovXHJcbkBJbmplY3RhYmxlKClcclxuZXhwb3J0IGNsYXNzIFJ1bGVzRW5naW5lU2VydmljZSB7XHJcbiAgICBwcml2YXRlIHJlZ2lzdGVyZWRTZXR0aW5nczogeyBba2V5OiBzdHJpbmddOiBBYnN0cmFjdE1vZGVsU2V0dGluZ3M8YW55PjsgfTtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBAT3B0aW9uYWwoKSBASW5qZWN0KE1PREVMX1NFVFRJTkdTX1RPS0VOKSBzZXR0aW5nczogQWJzdHJhY3RNb2RlbFNldHRpbmdzPGFueT5bXSxcclxuICAgICAgICBwcml2YXRlIHRyYWNlU3ZjOiBUcmFjZVNlcnZpY2UsXHJcbiAgICAgICAgcHJpdmF0ZSBjb21tb25TdmM6IENvbW1vblNlcnZpY2VcclxuICAgICkge1xyXG4gICAgICAgIHRoaXMucmVnaXN0ZXJlZFNldHRpbmdzID0ge307XHJcblxyXG4gICAgICAgIGlmICghQXJyYXkuaXNBcnJheShzZXR0aW5ncykpIHJldHVybjtcclxuXHJcbiAgICAgICAgc2V0dGluZ3MuZm9yRWFjaChzZXR0aW5nID0+IHtcclxuICAgICAgICAgICAgdGhpcy5pbml0aWFsaXplTW9kZWxTZXR0aW5nKHNldHRpbmcpO1xyXG4gICAgICAgICAgICB0aGlzLnJlZ2lzdGVyZWRTZXR0aW5nc1tzZXR0aW5nLm5hbWVdID0gc2V0dGluZztcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEluaXRpYWxpemVzIG1vZGVsIHNldHRpbmdzIGFuZCBwcmVwYXJlcyB0aGVtIHRvIGJlIHVzZWQgaW4gYSBmb3JtIGdyb3VwXHJcbiAgICAgKiBAcGFyYW0gc2V0dGluZyBNb2RlbCBzZXR0aW5nIHRvIGluaXRpYWxpemVcclxuICAgICAqL1xyXG4gICAgaW5pdGlhbGl6ZU1vZGVsU2V0dGluZyhzZXR0aW5nOiBBYnN0cmFjdE1vZGVsU2V0dGluZ3M8YW55Pik6IHZvaWQge1xyXG4gICAgICAgIHRoaXMudHJhY2VTdmMudHJhY2UoYEluaXRpYWxpemluZyBtb2RlbCBzZXR0aW5ncyBcIiR7c2V0dGluZy5uYW1lfVwiYCk7XHJcbiAgICAgICAgdGhpcy5zZXRQcm9wZXJ0eU1ldGFkYXRhKHNldHRpbmcucHJvcGVydGllcywgc2V0dGluZy5uYW1lKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEdldHMgbW9kZWwgc2V0dGluZ3Mgd2l0aCB0aGUgcHJvdmlkZWQgbmFtZVxyXG4gICAgICogQHBhcmFtIG5hbWUgTmFtZSBvZiBtb2RlbCBzZXR0aW5nXHJcbiAgICAgKiBAcmV0dXJucyBNb2RlbCBzZXR0aW5ncyB3aXRoIHRoZSBwcm92aWRlZCBuYW1lXHJcbiAgICAgKi9cclxuICAgIGdldE1vZGVsU2V0dGluZ3M8VD4obmFtZTogc3RyaW5nKTogQWJzdHJhY3RNb2RlbFNldHRpbmdzPFQ+IHtcclxuICAgICAgICB0aGlzLnRyYWNlU3ZjLnRyYWNlKGBSZXRyaWV2aW5nIG1vZGVsIHNldHRpbmdzIFwiJHtuYW1lfVwiYCk7XHJcblxyXG4gICAgICAgIGNvbnN0IHNldHRpbmdzID0gdGhpcy5yZWdpc3RlcmVkU2V0dGluZ3NbbmFtZV07XHJcblxyXG4gICAgICAgIC8vIGNyZWF0ZSBuZXcgb2JqZWN0XHJcbiAgICAgICAgcmV0dXJuIHNldHRpbmdzXHJcbiAgICAgICAgICAgID8gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5yZWdpc3RlcmVkU2V0dGluZ3NbbmFtZV0pXHJcbiAgICAgICAgICAgIDogbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEdldHMgdGhlIGRlcGVuZGVuY3kgcHJvcGVydGllcyBmb3IgYW4gYXJyYXkgb2YgdGVzdHNcclxuICAgICAqIEBwYXJhbSB0ZXN0cyBUZXN0cyB0byBnZXQgdGhlIGRlcGVuZGVuY3kgcHJvcGVydGllcyBmb3JcclxuICAgICAqIEByZXR1cm5zIERlcGVuZGVuY3kgcHJvcGVydGllc1xyXG4gICAgICovXHJcbiAgICBnZXREZXBlbmRlbmN5UHJvcGVydGllczxUPih0ZXN0czogVGVzdDxUPltdKTogc3RyaW5nW10ge1xyXG4gICAgICAgIGlmICghdGVzdHMpIHJldHVybiBbXTtcclxuXHJcbiAgICAgICAgY29uc3QgZGVwcyA9IHRlc3RzXHJcbiAgICAgICAgICAgIC5tYXAodCA9PiB0aGlzLmdldERlcGVuZGVuY3lQcm9wZXJ0aWVzRnJvbVRlc3QodCkpXHJcbiAgICAgICAgICAgIC5yZWR1Y2UoKHByZXYsIGN1cnJlbnQpID0+IHByZXYuY29uY2F0KGN1cnJlbnQpLCBbXSk7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLmNvbW1vblN2Yy51bmlxdWUoZGVwcyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXRzIHRlc3RzIGdyb3VwZWQgYnkgdGhlaXIgc3luYyB0eXBlIChlLmcuIHN5bmMgdnMuIGFzeW5jKVxyXG4gICAgICogQHBhcmFtIHRlc3RzIFRlc3QgdG8gZ3JvdXBzXHJcbiAgICAgKiBAcmV0dXJucyBUZXN0cyBncm91cGVkIGJ5IHN5bmMgdHlwZVxyXG4gICAgICovXHJcbiAgICBncm91cFRlc3RzQnlTeW5jVHlwZTxUPih0ZXN0czogVGVzdDxUPltdKTogVGVzdFN5bmNHcm91cHM8VD4ge1xyXG4gICAgICAgIGNvbnN0IHRlc3RHcm91cHMgPSB7XHJcbiAgICAgICAgICAgIHN5bmM6IFtdLFxyXG4gICAgICAgICAgICBhc3luYzogW11cclxuICAgICAgICB9IGFzIFRlc3RTeW5jR3JvdXBzPFQ+O1xyXG5cclxuICAgICAgICBpZiAoIXRlc3RzKSByZXR1cm4gdGVzdEdyb3VwcztcclxuXHJcbiAgICAgICAgdGVzdHMuZm9yRWFjaCh0ZXN0ID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdGVzdEZ1bmNUeXBlcyA9IHtcclxuICAgICAgICAgICAgICAgIHN5bmM6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgYXN5bmM6IGZhbHNlXHJcbiAgICAgICAgICAgIH0gYXMgQ29uZmlndXJlZEZ1bmNUeXBlcztcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbmRpdGlvblJlc3VsdHMgPSB0aGlzLmdldENvbmZpZ3VyZWRGdW5jVHlwZXModGVzdC5jb25kaXRpb24pO1xyXG4gICAgICAgICAgICBjb25zdCBjaGVja1Jlc3VsdHMgPSB0aGlzLmdldENvbmZpZ3VyZWRGdW5jVHlwZXModGVzdC5jaGVjayk7XHJcblxyXG4gICAgICAgICAgICB0ZXN0RnVuY1R5cGVzLnN5bmMgPSBjb25kaXRpb25SZXN1bHRzLnN5bmMgfHwgY2hlY2tSZXN1bHRzLnN5bmM7XHJcbiAgICAgICAgICAgIHRlc3RGdW5jVHlwZXMuYXN5bmMgPSBjb25kaXRpb25SZXN1bHRzLmFzeW5jIHx8IGNoZWNrUmVzdWx0cy5hc3luYztcclxuXHJcbiAgICAgICAgICAgIC8vIGlmIHRoZXJlIGlzIGFuIGFzeW5jIGZ1bmMgYW55d2hlcmUgaW4gdGhlIHRlc3QncyBydWxlIHNldHMsIHRoZW4gaXQgaXMgY29uc2lkZXJlZCBhbiBhc3luYyB0ZXN0XHJcbiAgICAgICAgICAgIGlmICh0ZXN0RnVuY1R5cGVzLnN5bmMgJiYgIXRlc3RGdW5jVHlwZXMuYXN5bmMpIHRlc3RHcm91cHMuc3luYy5wdXNoKHRlc3QpO1xyXG4gICAgICAgICAgICBpZiAodGVzdEZ1bmNUeXBlcy5hc3luYykgdGVzdEdyb3Vwcy5hc3luYy5wdXNoKHRlc3QpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gdGVzdEdyb3VwcztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJ1bnMgdmFsaWRhdGlvbiB0ZXN0c1xyXG4gICAgICogQHBhcmFtIGRhdGEgRGF0YSB0byBydW4gdmFsaWRhdGlvbiB0ZXN0cyBhZ2FpbnN0XHJcbiAgICAgKiBAcGFyYW0gcHJvcGVydHkgUHJvcGVydHkgdG8gcnVuIHZhbGlkYXRpb24gdGVzdHMgZm9yXHJcbiAgICAgKiBAcmV0dXJucyBSZXN1bHRzIG9mIHZhbGlkYXRpb24gdGVzdHNcclxuICAgICAqL1xyXG4gICAgdmFsaWRhdGU8VD4oZGF0YTogVCwgcHJvcGVydHk6IFByb3BlcnR5PFQ+LCBzdGF0ZT86IFRlc3RSdW5TdGF0ZSk6IE9ic2VydmFibGU8UHJvcGVydHlUZXN0UmVzdWx0czxUPj4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJ1bkFsbFRlc3RzKGRhdGEsIHByb3BlcnR5LnZhbGlkLCBzdGF0ZSlcclxuICAgICAgICAgICAgLnBpcGUoXHJcbiAgICAgICAgICAgICAgICBtYXAoKHJlc3VsdHM6IFByb3BlcnR5VGVzdFJlc3VsdHM8VD4pID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHRzLnByb3BlcnR5TmFtZSA9IHByb3BlcnR5LmFic29sdXRlUGF0aDtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0cyBhcyBQcm9wZXJ0eVRlc3RSZXN1bHRzPFQ+O1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJ1bnMgZWRpdGFiaWxpdHkgdGVzdHNcclxuICAgICAqIEBwYXJhbSBkYXRhIERhdGEgdG8gcnVuIGVkaXRhYmlsaXR5IHRlc3RzIGFnYWluc3RcclxuICAgICAqIEBwYXJhbSBwcm9wZXJ0eSBQcm9wZXJ0eSB0byBydW4gZWRpdGFiaWxpdHkgdGVzdHMgZm9yXHJcbiAgICAgKiAqIEByZXR1cm5zIFJlc3VsdHMgb2YgZWRpdGFiaWxpdHkgdGVzdHNcclxuICAgICAqL1xyXG4gICAgZWRpdGFibGU8VD4oZGF0YTogVCwgcHJvcGVydHk6IFByb3BlcnR5QmFzZTxUPiwgc3RhdGU/OiBUZXN0UnVuU3RhdGUpOiBPYnNlcnZhYmxlPFByb3BlcnR5VGVzdFJlc3VsdHM8VD4+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5ydW5BbGxUZXN0cyhkYXRhLCBwcm9wZXJ0eS5lZGl0LCBzdGF0ZSlcclxuICAgICAgICAgICAgLnBpcGUoXHJcbiAgICAgICAgICAgICAgICBtYXAoKHJlc3VsdHM6IFByb3BlcnR5VGVzdFJlc3VsdHM8VD4pID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHRzLnByb3BlcnR5TmFtZSA9IHByb3BlcnR5LmFic29sdXRlUGF0aDtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0cyBhcyBQcm9wZXJ0eVRlc3RSZXN1bHRzPFQ+O1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJ1bnMgdmlzaWJpbGl0eSB0ZXN0c1xyXG4gICAgICogQHBhcmFtIGRhdGEgRGF0YSB0byBydW4gdmlzaWJpbGl0eSB0ZXN0cyBhZ2FpbnN0XHJcbiAgICAgKiBAcGFyYW0gcHJvcGVydHkgUHJvcGVydHkgdG8gcnVuIHZpc2liaWxpdHkgdGVzdHMgZm9yXHJcbiAgICAgKiAqIEByZXR1cm5zIFJlc3VsdHMgb2YgdmlzaWJpbGl0eSB0ZXN0c1xyXG4gICAgICovXHJcbiAgICAvLyB2aXNpYmxlPFQ+KGRhdGE6IFQsIHByb3BlcnR5OiBQcm9wZXJ0eTxUPiwgc3RhdGU/OiBUZXN0UnVuU3RhdGUpOiBPYnNlcnZhYmxlPFByb3BlcnR5VGVzdFJlc3VsdHM8VD4+IHtcclxuICAgIC8vICAgICByZXR1cm4gdGhpcy5ydW5BbGxUZXN0cyhkYXRhLCBwcm9wZXJ0eS52aWV3LCBzdGF0ZSlcclxuICAgIC8vICAgICAgICAgLnBpcGUoXHJcbiAgICAvLyAgICAgICAgICAgICBtYXAoKHJlc3VsdHM6IFByb3BlcnR5VGVzdFJlc3VsdHM8VD4pID0+IHtcclxuICAgIC8vICAgICAgICAgICAgICAgICByZXN1bHRzLnByb3BlcnR5TmFtZSA9IHByb3BlcnR5LmFic29sdXRlUGF0aDtcclxuICAgIC8vICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0cyBhcyBQcm9wZXJ0eVRlc3RSZXN1bHRzPFQ+O1xyXG4gICAgLy8gICAgICAgICAgICAgfSlcclxuICAgIC8vICAgICAgICAgKTtcclxuICAgIC8vIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJ1bnMgYW4gYXJyYXkgb2Ygc3luYyB0ZXN0c1xyXG4gICAgICogQHBhcmFtIGRhdGEgRGF0YSB0byBwZXJmb3JtIHRlc3RzIGFnYWluc3RcclxuICAgICAqIEBwYXJhbSB0ZXN0cyBUZXN0cyB0byBydW5cclxuICAgICAqIEByZXR1cm5zIFJlc3VsdCBvZiB0ZXN0c1xyXG4gICAgICovXHJcbiAgICBydW5UZXN0czxUPihkYXRhOiBULCB0ZXN0czogVGVzdDxUPltdLCBzdGF0ZT86IFRlc3RSdW5TdGF0ZSk6IFRlc3RSZXN1bHRzQmFzZTxUPiB7XHJcbiAgICAgICAgaWYgKCF0ZXN0cyB8fCAhdGVzdHMubGVuZ3RoKSByZXR1cm4gbmV3IFRlc3RSZXN1bHRzQmFzZShbXSk7XHJcblxyXG4gICAgICAgIGNvbnN0IHRlc3RSZXN1bHRzID0gdGVzdHNcclxuICAgICAgICAgICAgLm1hcCh0ID0+IHRoaXMucnVuVGVzdChkYXRhLCB0LCBzdGF0ZSkpXHJcbiAgICAgICAgICAgIC5maWx0ZXIoeCA9PiAhIXgpO1xyXG5cclxuICAgICAgICByZXR1cm4gbmV3IFRlc3RSZXN1bHRzQmFzZSh0ZXN0UmVzdWx0cyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSdW5zIGFuIGFycmF5IG9mIGFzeW5jIHRlc3RzXHJcbiAgICAgKiBAcGFyYW0gZGF0YSBEYXRhIHRvIHBlcmZvcm0gdGVzdHMgYWdhaW5zdFxyXG4gICAgICogQHBhcmFtIHRlc3RzIFRlc3RzIHRvIHJ1blxyXG4gICAgICogQHJldHVybnMgUmVzdWx0IG9mIHRlc3RzXHJcbiAgICAgKi9cclxuICAgIHJ1blRlc3RzQXN5bmM8VD4oZGF0YTogVCwgdGVzdHM6IFRlc3Q8VD5bXSwgc3RhdGU/OiBUZXN0UnVuU3RhdGUpOiBPYnNlcnZhYmxlPFRlc3RSZXN1bHRzQmFzZTxUPj4ge1xyXG4gICAgICAgIGlmICghdGVzdHMgfHwgIXRlc3RzLmxlbmd0aCkgcmV0dXJuIG9mKG5ldyBUZXN0UmVzdWx0c0Jhc2UoW10pKTtcclxuXHJcbiAgICAgICAgY29uc3QgcnVuVGVzdCQgPSB0ZXN0c1xyXG4gICAgICAgICAgICAubWFwKHRlc3QgPT4gdGhpcy5ydW5UZXN0QXN5bmMoZGF0YSwgdGVzdCwgc3RhdGUpKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGZvcmtKb2luKHJ1blRlc3QkKVxyXG4gICAgICAgICAgICAucGlwZShcclxuICAgICAgICAgICAgICAgIG1hcCh0ZXN0UmVzdWx0cyA9PiBuZXcgVGVzdFJlc3VsdHNCYXNlKHRlc3RSZXN1bHRzLmZpbHRlcih4ID0+ICEheCkpKVxyXG4gICAgICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUnVucyBhbiBhcnJheSBvZiBzeW5jIGFuZCBhc3luYyB0ZXN0c1xyXG4gICAgICogQHBhcmFtIGRhdGEgRGF0YSB0byBwZXJmb3JtIHRlc3RzIGFnYWluc3RcclxuICAgICAqIEBwYXJhbSB0ZXN0cyBUZXN0cyB0byBydW5cclxuICAgICAqIEByZXR1cm5zIFJlc3VsdCBvZiB0ZXN0c1xyXG4gICAgICovXHJcbiAgICBydW5BbGxUZXN0czxUPihkYXRhOiBULCB0ZXN0czogVGVzdDxUPltdLCBzdGF0ZT86IFRlc3RSdW5TdGF0ZSk6IE9ic2VydmFibGU8VGVzdFJlc3VsdHNCYXNlPFQ+PiB7XHJcbiAgICAgICAgaWYgKCF0ZXN0cyB8fCAhdGVzdHMubGVuZ3RoKSByZXR1cm4gb2YobmV3IFRlc3RSZXN1bHRzQmFzZShbXSkpO1xyXG5cclxuICAgICAgICBjb25zdCBzeW5jR3JvdXBzID0gdGhpcy5ncm91cFRlc3RzQnlTeW5jVHlwZSh0ZXN0cyk7XHJcbiAgICAgICAgY29uc3Qgc3luY1Rlc3RSZXN1bHRzID0gb2YodGhpcy5ydW5UZXN0cyhkYXRhLCBzeW5jR3JvdXBzLnN5bmMsIHN0YXRlKSk7XHJcblxyXG4gICAgICAgIHJldHVybiBzeW5jVGVzdFJlc3VsdHMucGlwZShcclxuICAgICAgICAgICAgbWVyZ2VNYXAocmVzdWx0ID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICghcmVzdWx0LnBhc3NlZCkgcmV0dXJuIG9mKHJlc3VsdCk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucnVuVGVzdHNBc3luYyhkYXRhLCBzeW5jR3JvdXBzLmFzeW5jLCBzdGF0ZSk7XHJcbiAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICB0YWtlKDEpXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFBlcmZvcm1zIHN5bmMgdGVzdCBvbiBhIHNldCBvZiBkYXRhXHJcbiAgICAgKiBAcGFyYW0gZGF0YSBEYXRhIHRvIHBlcmZvcm0gdGVzdCBhZ2FpbnN0XHJcbiAgICAgKiBAcGFyYW0gdGVzdCBUZXN0IHRvIHJ1blxyXG4gICAgICogQHJldHVybnMgUmVzdWx0IG9mIHRlc3RcclxuICAgICAqL1xyXG4gICAgcnVuVGVzdDxUPihkYXRhOiBULCB0ZXN0OiBUZXN0PFQ+LCBzdGF0ZT86IFRlc3RSdW5TdGF0ZSk6IFRlc3RSZXN1bHQ8VD4ge1xyXG4gICAgICAgIGlmICghdGVzdCkgcmV0dXJuIG51bGw7XHJcblxyXG4gICAgICAgIGNvbnN0IHBhc3NlZFRlc3RSZXN1bHQ6IFRlc3RSZXN1bHQ8VD4gPSB7IHBhc3NlZDogdHJ1ZSwgbmFtZTogdGVzdC5uYW1lLCBtZXNzYWdlOiBudWxsIH07XHJcbiAgICAgICAgY29uc3QgZmFpbGVkVGVzdFJlc3VsdDogVGVzdFJlc3VsdDxUPiA9IHsgcGFzc2VkOiBmYWxzZSwgbmFtZTogdGVzdC5uYW1lLCBtZXNzYWdlOiB0ZXN0Lm1lc3NhZ2UgfTtcclxuICAgICAgICBjb25zdCBza2lwcGVkVGVzdFJlc3VsdDogVGVzdFJlc3VsdDxUPiA9IHsgcGFzc2VkOiB0cnVlLCBza2lwcGVkOiB0cnVlLCBuYW1lOiB0ZXN0Lm5hbWUsIG1lc3NhZ2U6IG51bGwgfTtcclxuXHJcbiAgICAgICAgY29uc3QgY29uZGl0aW9uc1J1bGVTZXRSZXN1bHQgPSB0aGlzLnByb2Nlc3NSdWxlU2V0KGRhdGEsIHRlc3QuY29uZGl0aW9uLCBzdGF0ZSk7XHJcbiAgICAgICAgaWYgKGNvbmRpdGlvbnNSdWxlU2V0UmVzdWx0ID09PSBQcm9jZXNzUmVzdWx0VHlwZS5GYWlsZWQpIHJldHVybiBza2lwcGVkVGVzdFJlc3VsdDtcclxuXHJcbiAgICAgICAgY29uc3QgY2hlY2tSdWxlU2V0UmVzdWx0ID0gdGhpcy5wcm9jZXNzUnVsZVNldChkYXRhLCB0ZXN0LmNoZWNrLCBzdGF0ZSk7XHJcbiAgICAgICAgc3dpdGNoIChjaGVja1J1bGVTZXRSZXN1bHQpIHtcclxuICAgICAgICAgICAgY2FzZSBQcm9jZXNzUmVzdWx0VHlwZS5QYXNzZWQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcGFzc2VkVGVzdFJlc3VsdDtcclxuICAgICAgICAgICAgY2FzZSBQcm9jZXNzUmVzdWx0VHlwZS5GYWlsZWQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFpbGVkVGVzdFJlc3VsdDtcclxuICAgICAgICAgICAgY2FzZSBQcm9jZXNzUmVzdWx0VHlwZS5Ta2lwcGVkOlxyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNraXBwZWRUZXN0UmVzdWx0O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFBlcmZvcm1zIGFzeW5jIHRlc3Qgb24gYSBzZXQgb2YgZGF0YVxyXG4gICAgICogQHBhcmFtIGRhdGEgRGF0YSB0byBwZXJmb3JtIHRlc3QgYWdhaW5zdFxyXG4gICAgICogQHBhcmFtIHRlc3QgVGVzdCB0byBydW5cclxuICAgICAqIEByZXR1cm5zIFJlc3VsdCBvZiB0ZXN0XHJcbiAgICAgKi9cclxuICAgIHJ1blRlc3RBc3luYzxUPihkYXRhOiBULCB0ZXN0OiBUZXN0PFQ+LCBzdGF0ZT86IFRlc3RSdW5TdGF0ZSk6IE9ic2VydmFibGU8VGVzdFJlc3VsdDxUPj4ge1xyXG4gICAgICAgIGlmICghdGVzdCkgcmV0dXJuIG9mKG51bGwpO1xyXG5cclxuICAgICAgICBjb25zdCBwYXNzZWRUZXN0UmVzdWx0OiBUZXN0UmVzdWx0PFQ+ID0geyBwYXNzZWQ6IHRydWUsIG5hbWU6IHRlc3QubmFtZSwgbWVzc2FnZTogbnVsbCB9O1xyXG4gICAgICAgIGNvbnN0IGZhaWxlZFRlc3RSZXN1bHQ6IFRlc3RSZXN1bHQ8VD4gPSB7IHBhc3NlZDogZmFsc2UsIG5hbWU6IHRlc3QubmFtZSwgbWVzc2FnZTogdGVzdC5tZXNzYWdlIH07XHJcbiAgICAgICAgY29uc3Qgc2tpcHBlZFRlc3RSZXN1bHQ6IFRlc3RSZXN1bHQ8VD4gPSB7IHBhc3NlZDogdHJ1ZSwgc2tpcHBlZDogdHJ1ZSwgbmFtZTogdGVzdC5uYW1lLCBtZXNzYWdlOiBudWxsIH07XHJcblxyXG4gICAgICAgIGNvbnN0IGNvbmRpdGlvbnNSdWxlU2V0UmVzdWx0JCA9IHRoaXMucHJvY2Vzc1J1bGVTZXRBc3luYyhkYXRhLCB0ZXN0LmNvbmRpdGlvbiwgc3RhdGUpO1xyXG4gICAgICAgIGNvbnN0IGNoZWNrUnVsZVNldFJlc3VsdCQgPSB0aGlzLnByb2Nlc3NSdWxlU2V0QXN5bmMoZGF0YSwgdGVzdC5jaGVjaywgc3RhdGUpO1xyXG5cclxuICAgICAgICByZXR1cm4gY29uZGl0aW9uc1J1bGVTZXRSZXN1bHQkXHJcbiAgICAgICAgICAgIC5waXBlKFxyXG4gICAgICAgICAgICAgICAgZmxhdE1hcChjb25kaXRpb25zUnVsZVNldFJlc3VsdCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmRpdGlvbnNSdWxlU2V0UmVzdWx0ID09PSBQcm9jZXNzUmVzdWx0VHlwZS5GYWlsZWQpIHJldHVybiBvZihza2lwcGVkVGVzdFJlc3VsdCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjaGVja1J1bGVTZXRSZXN1bHQkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5waXBlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwKGNoZWNrUnVsZVNldFJlc3VsdCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChjaGVja1J1bGVTZXRSZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBQcm9jZXNzUmVzdWx0VHlwZS5QYXNzZWQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGFzc2VkVGVzdFJlc3VsdDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBQcm9jZXNzUmVzdWx0VHlwZS5GYWlsZWQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFpbGVkVGVzdFJlc3VsdDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBQcm9jZXNzUmVzdWx0VHlwZS5Ta2lwcGVkOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNraXBwZWRUZXN0UmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUHJvY2Vzc2VzIGEgc3luYyBydWxlIHNldFxyXG4gICAgICogQHBhcmFtIGRhdGEgRGF0YSB0byBwcm9jZXNzIHJ1bGUgc2V0IGFnYWluc3RcclxuICAgICAqIEBwYXJhbSBydWxlU2V0IFJ1bGUgc2V0IHRvIHByb2Nlc3NcclxuICAgICAqIEByZXR1cm5zIFJlc3VsdCBvZiBydWxlIHNldCBwcm9jZXNzaW5nXHJcbiAgICAgKi9cclxuICAgIHByb2Nlc3NSdWxlU2V0PFQ+KGRhdGE6IFQsIHJ1bGVTZXQ6IFJ1bGVTZXQ8VD4sIHN0YXRlPzogVGVzdFJ1blN0YXRlKTogUHJvY2Vzc1Jlc3VsdFR5cGUge1xyXG4gICAgICAgIGlmICghcnVsZVNldCkgcmV0dXJuIFByb2Nlc3NSZXN1bHRUeXBlLlNraXBwZWQ7XHJcblxyXG4gICAgICAgIGNvbnN0IGlzUnVsZUdyb3VwID0gdGhpcy5pc1J1bGVHcm91cChydWxlU2V0KTtcclxuICAgICAgICByZXR1cm4gaXNSdWxlR3JvdXBcclxuICAgICAgICAgICAgPyB0aGlzLnByb2Nlc3NSdWxlR3JvdXAoZGF0YSwgcnVsZVNldCBhcyBSdWxlR3JvdXA8VD4sIHN0YXRlKVxyXG4gICAgICAgICAgICA6IHRoaXMucHJvY2Vzc1J1bGUoZGF0YSwgcnVsZVNldCBhcyBSdWxlPFQ+LCBzdGF0ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBQcm9jZXNzZXMgYW4gYXN5bmMgcnVsZSBzZXRcclxuICAgICAqIEBwYXJhbSBkYXRhIERhdGEgdG8gcHJvY2VzcyBydWxlIHNldCBhZ2FpbnN0XHJcbiAgICAgKiBAcGFyYW0gcnVsZVNldCBSdWxlIHNldCB0byBwcm9jZXNzXHJcbiAgICAgKiBAcmV0dXJucyBSZXN1bHQgb2YgcnVsZSBzZXQgcHJvY2Vzc2luZ1xyXG4gICAgICovXHJcbiAgICBwcm9jZXNzUnVsZVNldEFzeW5jPFQ+KGRhdGE6IFQsIHJ1bGVTZXQ6IFJ1bGVTZXQ8VD4sIHN0YXRlPzogVGVzdFJ1blN0YXRlKTogT2JzZXJ2YWJsZTxQcm9jZXNzUmVzdWx0VHlwZT4ge1xyXG4gICAgICAgIGlmICghcnVsZVNldCkgcmV0dXJuIG9mKFByb2Nlc3NSZXN1bHRUeXBlLlNraXBwZWQpO1xyXG5cclxuICAgICAgICBjb25zdCBpc1J1bGVHcm91cCA9IHRoaXMuaXNSdWxlR3JvdXAocnVsZVNldCk7XHJcbiAgICAgICAgcmV0dXJuIGlzUnVsZUdyb3VwXHJcbiAgICAgICAgICAgID8gdGhpcy5wcm9jZXNzUnVsZUdyb3VwQXN5bmMoZGF0YSwgcnVsZVNldCBhcyBSdWxlR3JvdXA8VD4sIHN0YXRlKVxyXG4gICAgICAgICAgICA6IHRoaXMucHJvY2Vzc1J1bGVBc3luYyhkYXRhLCBydWxlU2V0IGFzIFJ1bGU8VD4sIHN0YXRlKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHByb2Nlc3NSdWxlR3JvdXA8VD4oZGF0YTogVCwgcnVsZUdyb3VwOiBSdWxlR3JvdXA8VD4sIHN0YXRlPzogVGVzdFJ1blN0YXRlKTogUHJvY2Vzc1Jlc3VsdFR5cGUge1xyXG4gICAgICAgIGlmICghcnVsZUdyb3VwLnJ1bGVzKSByZXR1cm4gUHJvY2Vzc1Jlc3VsdFR5cGUuU2tpcHBlZDtcclxuXHJcbiAgICAgICAgbGV0IHBhc3NlZENvdW50ID0gMDtcclxuICAgICAgICBsZXQgc2tpcHBlZENvdW50ID0gMDtcclxuXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBydWxlR3JvdXAucnVsZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgY29uc3QgcnVsZSA9IHJ1bGVHcm91cC5ydWxlc1tpXTtcclxuICAgICAgICAgICAgY29uc3QgcnVsZVNldFJlc3VsdCA9IHRoaXMucHJvY2Vzc1J1bGVTZXQoZGF0YSwgcnVsZSwgc3RhdGUpO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuY2FuU2hvcnRDaXJjdWl0UnVsZUdyb3VwKHJ1bGVTZXRSZXN1bHQsIHJ1bGVHcm91cCkpIHJldHVybiBydWxlU2V0UmVzdWx0O1xyXG5cclxuICAgICAgICAgICAgaWYgKHJ1bGVTZXRSZXN1bHQgPT0gUHJvY2Vzc1Jlc3VsdFR5cGUuUGFzc2VkKSBwYXNzZWRDb3VudCsrO1xyXG4gICAgICAgICAgICBlbHNlIGlmIChydWxlU2V0UmVzdWx0ID09IFByb2Nlc3NSZXN1bHRUeXBlLlNraXBwZWQpIHNraXBwZWRDb3VudCsrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gaWYgd2Ugc2tpcHBlZCB0aGVtIGFsbCwgdGhlbiByZXR1cm4gc2tpcHBlZFxyXG4gICAgICAgIGlmIChza2lwcGVkQ291bnQgPT09IHJ1bGVHcm91cC5ydWxlcy5sZW5ndGgpIHJldHVybiBQcm9jZXNzUmVzdWx0VHlwZS5Ta2lwcGVkO1xyXG5cclxuICAgICAgICAvLyBpZiB3ZSBnb3QgdGhpcyBmYXIsIG1ha2Ugc3VyZSBhbGwgdGVzdHMgd2VyZSBwYXNzZWRcclxuICAgICAgICByZXR1cm4gcGFzc2VkQ291bnQgPT09IHJ1bGVHcm91cC5ydWxlcy5sZW5ndGggPyBQcm9jZXNzUmVzdWx0VHlwZS5QYXNzZWQgOiBQcm9jZXNzUmVzdWx0VHlwZS5GYWlsZWQ7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBwcm9jZXNzUnVsZUdyb3VwQXN5bmM8VD4oZGF0YTogVCwgcnVsZUdyb3VwOiBSdWxlR3JvdXA8VD4sIHN0YXRlPzogVGVzdFJ1blN0YXRlKTogT2JzZXJ2YWJsZTxQcm9jZXNzUmVzdWx0VHlwZT4ge1xyXG4gICAgICAgIGlmICghcnVsZUdyb3VwLnJ1bGVzKSByZXR1cm4gb2YoUHJvY2Vzc1Jlc3VsdFR5cGUuU2tpcHBlZCk7XHJcbiAgICAgICAgY29uc3QgYXN5bmNSdWxlU2V0UmVzdWx0cyQgPSBydWxlR3JvdXAucnVsZXMubWFwKHggPT4gdGhpcy5wcm9jZXNzUnVsZVNldEFzeW5jKGRhdGEsIHgsIHN0YXRlKSk7XHJcblxyXG4gICAgICAgIHJldHVybiBmb3JrSm9pbihhc3luY1J1bGVTZXRSZXN1bHRzJCkucGlwZShcclxuICAgICAgICAgICAgbWFwKHJ1bGVTZXRSZXN1bHRzID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNvdW50cyA9IHtcclxuICAgICAgICAgICAgICAgICAgICBwYXNzZWQ6IHJ1bGVTZXRSZXN1bHRzLmZpbHRlcih4ID0+IHggPT09IFByb2Nlc3NSZXN1bHRUeXBlLlBhc3NlZCkubGVuZ3RoLFxyXG4gICAgICAgICAgICAgICAgICAgIGZhaWxlZDogcnVsZVNldFJlc3VsdHMuZmlsdGVyKHggPT4geCA9PT0gUHJvY2Vzc1Jlc3VsdFR5cGUuRmFpbGVkKS5sZW5ndGgsXHJcbiAgICAgICAgICAgICAgICAgICAgc2tpcHBlZDogcnVsZVNldFJlc3VsdHMuZmlsdGVyKHggPT4geCA9PT0gUHJvY2Vzc1Jlc3VsdFR5cGUuU2tpcHBlZCkubGVuZ3RoLFxyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBydWxlR3JvdXBPcHRpb25zID0gcnVsZUdyb3VwLm9wdGlvbnMgfHwgeyByZXN1bHRSZXF1aXJlbWVudHM6IFJlc3VsdHNQYXNzUmVxdWlyZW1lbnQuQWxsUGFzcyB9O1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChydWxlR3JvdXBPcHRpb25zLnJlc3VsdFJlcXVpcmVtZW50cyA9PSBSZXN1bHRzUGFzc1JlcXVpcmVtZW50LkFueVBhc3MgJiYgY291bnRzLnBhc3NlZCA+IDApXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb2Nlc3NSZXN1bHRUeXBlLlBhc3NlZDtcclxuICAgICAgICAgICAgICAgIGlmIChydWxlR3JvdXBPcHRpb25zLnJlc3VsdFJlcXVpcmVtZW50cyA9PSBSZXN1bHRzUGFzc1JlcXVpcmVtZW50LkFsbFBhc3MgJiYgY291bnRzLnBhc3NlZCA9PT0gcnVsZVNldFJlc3VsdHMubGVuZ3RoKVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9jZXNzUmVzdWx0VHlwZS5QYXNzZWQ7XHJcbiAgICAgICAgICAgICAgICBpZiAoY291bnRzLnNraXBwZWQgPT09IHJ1bGVTZXRSZXN1bHRzLmxlbmd0aCkgcmV0dXJuIFByb2Nlc3NSZXN1bHRUeXBlLlNraXBwZWQ7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb2Nlc3NSZXN1bHRUeXBlLkZhaWxlZDtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgcHJvY2Vzc1J1bGU8VD4oZGF0YTogVCwgcnVsZTogUnVsZTxUPiwgc3RhdGU/OiBUZXN0UnVuU3RhdGUpOiBQcm9jZXNzUmVzdWx0VHlwZSB7XHJcbiAgICAgICAgaWYgKCFydWxlLmZ1bmMpIHJldHVybiBQcm9jZXNzUmVzdWx0VHlwZS5Ta2lwcGVkO1xyXG5cclxuICAgICAgICBjb25zdCByb290RGF0YSA9IHN0YXRlID8gc3RhdGUucm9vdERhdGEgOiBudWxsO1xyXG4gICAgICAgIHJldHVybiBydWxlLmZ1bmMoZGF0YSwgcm9vdERhdGEpID8gUHJvY2Vzc1Jlc3VsdFR5cGUuUGFzc2VkIDogUHJvY2Vzc1Jlc3VsdFR5cGUuRmFpbGVkO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgcHJvY2Vzc1J1bGVBc3luYzxUPihkYXRhOiBULCBydWxlOiBSdWxlPFQ+LCBzdGF0ZT86IFRlc3RSdW5TdGF0ZSk6IE9ic2VydmFibGU8UHJvY2Vzc1Jlc3VsdFR5cGU+IHtcclxuICAgICAgICBpZiAoIXJ1bGUuZnVuYyAmJiAhcnVsZS5hc3luY0Z1bmMpIHJldHVybiBvZihQcm9jZXNzUmVzdWx0VHlwZS5Ta2lwcGVkKTtcclxuXHJcbiAgICAgICAgY29uc3Qgcm9vdERhdGEgPSBzdGF0ZSA/IHN0YXRlLnJvb3REYXRhIDogbnVsbDtcclxuICAgICAgICBjb25zdCBmdW5jUmVzdWx0ID0gcnVsZS5mdW5jXHJcbiAgICAgICAgICAgID8gb2YocnVsZS5mdW5jKGRhdGEsIHJvb3REYXRhKSlcclxuICAgICAgICAgICAgOiBydWxlLmFzeW5jRnVuYyhkYXRhLCByb290RGF0YSk7XHJcblxyXG4gICAgICAgIHJldHVybiBmdW5jUmVzdWx0XHJcbiAgICAgICAgICAgIC5waXBlKFxyXG4gICAgICAgICAgICAgICAgbWFwKHBhc3NlZCA9PiBwYXNzZWQgPyBQcm9jZXNzUmVzdWx0VHlwZS5QYXNzZWQgOiBQcm9jZXNzUmVzdWx0VHlwZS5GYWlsZWQpXHJcbiAgICAgICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gcHJpdmF0ZSBkb1Byb2Nlc3NSdWxlPFQ+KHJ1bGU6IFJ1bGU8VD4sIHN0YXRlOiBUZXN0UnVuU3RhdGUsIGlzQXN5bmM6IGJvb2xlYW4pOiBib29sZWFuIHtcclxuICAgIC8vICAgICAvLyBtYWtlIHN1cmUgd2UgaGF2ZSB0aGUgYXBwcm9wcmlhdGUgZnVuYyB0byBjYWxsXHJcbiAgICAvLyAgICAgaWYgKChpc0FzeW5jICYmICFydWxlLmFzeW5jRnVuYykgfHwgKCFpc0FzeW5jICYmICFydWxlLmZ1bmMpKSByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgLy8gICAgIC8vIC8vIGlmIHRoZXJlIGlzIG1pc3NpbmcgZGF0YSwgdGhlbiBhc3N1bWUgd2Ugc2hvdWxkIHByb2Nlc3MgdGhlIHJ1bGVcclxuICAgIC8vICAgICAvLyBpZiAoIXJ1bGUub3B0aW9ucyB8fCAhcnVsZS5vcHRpb25zLmNvbnRyb2xTdGF0ZU9wdGlvbnMgfHwgIXN0YXRlIHx8ICFzdGF0ZS5jb250cm9sU3RhdGUpIHJldHVybiB0cnVlO1xyXG5cclxuICAgIC8vICAgICAvLyBpZiAocnVsZS5vcHRpb25zLmNvbnRyb2xTdGF0ZU9wdGlvbnMuc2tpcFByaXN0aW5lICYmIHN0YXRlLmNvbnRyb2xTdGF0ZS5wcmlzdGluZSkgcmV0dXJuIGZhbHNlO1xyXG4gICAgLy8gICAgIC8vIGlmIChydWxlLm9wdGlvbnMuY29udHJvbFN0YXRlT3B0aW9ucy5za2lwVW50b3VjaGVkICYmIHN0YXRlLmNvbnRyb2xTdGF0ZS51bnRvdWNoZWQpIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICAvLyAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAvLyB9XHJcblxyXG4gICAgcHJpdmF0ZSBjYW5TaG9ydENpcmN1aXRSdWxlR3JvdXA8VD4ocnVsZVNldFJlc3VsdDogUHJvY2Vzc1Jlc3VsdFR5cGUsIHJ1bGVHcm91cDogUnVsZUdyb3VwPFQ+KTogYm9vbGVhbiB7XHJcbiAgICAgICAgY29uc3QgcnVsZUdyb3VwT3B0aW9ucyA9IHJ1bGVHcm91cC5vcHRpb25zIHx8IHsgcmVzdWx0UmVxdWlyZW1lbnRzOiBSZXN1bHRzUGFzc1JlcXVpcmVtZW50LkFsbFBhc3MgfTtcclxuXHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgLy8gaXQgcGFzc2VkLCBhbmQgd2Ugb25seSBuZWVkIG9uZSB0byBwYXNzXHJcbiAgICAgICAgICAgIChydWxlU2V0UmVzdWx0ID09IFByb2Nlc3NSZXN1bHRUeXBlLlBhc3NlZCAmJiBydWxlR3JvdXBPcHRpb25zLnJlc3VsdFJlcXVpcmVtZW50cyA9PSBSZXN1bHRzUGFzc1JlcXVpcmVtZW50LkFueVBhc3MpXHJcbiAgICAgICAgICAgIHx8XHJcbiAgICAgICAgICAgIC8vIGlmIGZhaWxlZCwgYW5kIHdlIG5lZWQgYWxsIHRvIHBhc3NcclxuICAgICAgICAgICAgKHJ1bGVTZXRSZXN1bHQgPT0gUHJvY2Vzc1Jlc3VsdFR5cGUuRmFpbGVkICYmIHJ1bGVHcm91cE9wdGlvbnMucmVzdWx0UmVxdWlyZW1lbnRzID09IFJlc3VsdHNQYXNzUmVxdWlyZW1lbnQuQWxsUGFzcylcclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgaXNSdWxlR3JvdXA8VD4ocnVsZVNldDogUnVsZVNldDxUPik6IGJvb2xlYW4ge1xyXG4gICAgICAgIGNvbnN0IHJ1bGUgPSBydWxlU2V0IGFzIFJ1bGU8VD47XHJcbiAgICAgICAgcmV0dXJuICFydWxlLmZ1bmMgJiYgIXJ1bGUuYXN5bmNGdW5jO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0RGVwZW5kZW5jeVByb3BlcnRpZXNGcm9tVGVzdDxUPih0ZXN0OiBUZXN0PFQ+KTogc3RyaW5nW10ge1xyXG4gICAgICAgIGNvbnN0IGNoZWNrRGVwcyA9IHRoaXMuZ2V0RGVwZW5kZW5jeVByb3BlcnRpZXNGcm9tUnVsZVNldDxUPih0ZXN0LmNoZWNrKTtcclxuICAgICAgICBjb25zdCBjb25kaXRpb25EZXBzID0gdGhpcy5nZXREZXBlbmRlbmN5UHJvcGVydGllc0Zyb21SdWxlU2V0PFQ+KHRlc3QuY29uZGl0aW9uKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb21tb25TdmMudW5pcXVlKGNoZWNrRGVwcy5jb25jYXQoY29uZGl0aW9uRGVwcykpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0RGVwZW5kZW5jeVByb3BlcnRpZXNGcm9tUnVsZVNldDxUPihydWxlU2V0OiBSdWxlU2V0PFQ+KTogc3RyaW5nW10ge1xyXG4gICAgICAgIGlmICghcnVsZVNldCkgcmV0dXJuIFtdO1xyXG5cclxuICAgICAgICBjb25zdCByZXN1bHQ6IHN0cmluZ1tdID0gW107XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmlzUnVsZUdyb3VwKHJ1bGVTZXQpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJ1bGVHcm91cCA9IHJ1bGVTZXQgYXMgUnVsZUdyb3VwPFQ+O1xyXG4gICAgICAgICAgICBydWxlR3JvdXAucnVsZXMuZm9yRWFjaCh4ID0+IHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKC4uLnRoaXMuY29tbW9uU3ZjLnVuaXF1ZSh0aGlzLmdldERlcGVuZGVuY3lQcm9wZXJ0aWVzRnJvbVJ1bGVTZXQoeCkpKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBydWxlID0gcnVsZVNldCBhcyBSdWxlPFQ+O1xyXG4gICAgICAgIGlmIChydWxlLm9wdGlvbnMgJiYgQXJyYXkuaXNBcnJheShydWxlLm9wdGlvbnMuZGVwZW5kZW5jeVByb3BlcnRpZXMpKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKC4uLnRoaXMuY29tbW9uU3ZjLnVuaXF1ZShydWxlLm9wdGlvbnMuZGVwZW5kZW5jeVByb3BlcnRpZXMpKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLmNvbW1vblN2Yy51bmlxdWUocmVzdWx0KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHNldFByb3BlcnR5TWV0YWRhdGEocHJvcGVydGllczogUHJvcGVydHlCYXNlPGFueT5bXSwgbW9kZWxTZXR0aW5nc05hbWU6IHN0cmluZywgY3VycmVudEFic29sdXRlUGF0aDogc3RyaW5nID0gJycpOiB2b2lkIHtcclxuICAgICAgICBpZiAoIXByb3BlcnRpZXMpIHJldHVybjtcclxuXHJcbiAgICAgICAgcHJvcGVydGllcy5mb3JFYWNoKHByb3AgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBuZXdBYnNvbHV0ZVBhdGggPSB0aGlzLnNldFByb3BlcnR5QWJzb2x1dGVQYXRoKHByb3AsIGN1cnJlbnRBYnNvbHV0ZVBhdGgpO1xyXG4gICAgICAgICAgICB0aGlzLmZpbGxJbkVtcHR5VGVzdE5hbWVzKHByb3ApO1xyXG4gICAgICAgICAgICBwcm9wLnNldE93bmVyTW9kZWxTZXR0aW5nc05hbWUobW9kZWxTZXR0aW5nc05hbWUpO1xyXG5cclxuICAgICAgICAgICAgaWYgKHByb3AucHJvcGVydGllcykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRQcm9wZXJ0eU1ldGFkYXRhKHByb3AucHJvcGVydGllcywgbW9kZWxTZXR0aW5nc05hbWUsIG5ld0Fic29sdXRlUGF0aCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocHJvcC5hcnJheUl0ZW1Qcm9wZXJ0eSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRQcm9wZXJ0eU1ldGFkYXRhKFtwcm9wLmFycmF5SXRlbVByb3BlcnR5XSwgbW9kZWxTZXR0aW5nc05hbWUsIG5ld0Fic29sdXRlUGF0aCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHNldFByb3BlcnR5QWJzb2x1dGVQYXRoKHByb3BlcnR5OiBQcm9wZXJ0eUJhc2U8YW55PiwgY3VycmVudEFic29sdXRlUGF0aDogc3RyaW5nID0gJycpOiBzdHJpbmcge1xyXG4gICAgICAgIGNvbnN0IGlzQXJyYXlJdGVtUHJvcGVydHkgPSBQcm9wZXJ0eUJhc2UuaXNBcnJheUl0ZW1Qcm9wZXJ0eShwcm9wZXJ0eSk7XHJcbiAgICAgICAgY29uc3QgbmV3QWJzb2x1dGVQYXRoU2VnbWVudCA9IGlzQXJyYXlJdGVtUHJvcGVydHkgPyAnW10nIDogKHByb3BlcnR5IGFzIFByb3BlcnR5PGFueT4pLm5hbWU7XHJcbiAgICAgICAgY29uc3QgaXNBdFJvb3QgPSAhY3VycmVudEFic29sdXRlUGF0aDtcclxuICAgICAgICBjb25zdCBuZXdBYnNvbHV0ZVBhdGggPSBgJHtjdXJyZW50QWJzb2x1dGVQYXRofSR7aXNBdFJvb3QgPyAnJyA6ICcuJ30ke25ld0Fic29sdXRlUGF0aFNlZ21lbnR9YDtcclxuXHJcbiAgICAgICAgLy8gc2V0IGFic29sdXRlIHBhdGggZm9yIHByb3BlcnR5XHJcbiAgICAgICAgcHJvcGVydHkuc2V0QWJzb2x1dGVQYXRoKG5ld0Fic29sdXRlUGF0aCk7XHJcblxyXG4gICAgICAgIHJldHVybiBuZXdBYnNvbHV0ZVBhdGg7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBmaWxsSW5FbXB0eVRlc3ROYW1lcyhwcm9wZXJ0eTogUHJvcGVydHlCYXNlPGFueT4pIHtcclxuICAgICAgICBwcm9wZXJ0eS52YWxpZFxyXG4gICAgICAgICAgICAuZmlsdGVyKHRlc3QgPT4gIXRlc3QubmFtZSlcclxuICAgICAgICAgICAgLmZvckVhY2goKHRlc3QsIGkpID0+IHRlc3QubmFtZSA9IGB2YWxpZFRlc3Qke2l9YCk7XHJcblxyXG4gICAgICAgIHByb3BlcnR5LmVkaXRcclxuICAgICAgICAgICAgLmZpbHRlcih0ZXN0ID0+ICF0ZXN0Lm5hbWUpXHJcbiAgICAgICAgICAgIC5mb3JFYWNoKCh0ZXN0LCBpKSA9PiB0ZXN0Lm5hbWUgPSBgZWRpdFRlc3Qke2l9YCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXRDb25maWd1cmVkRnVuY1R5cGVzPFQ+KHJ1bGVTZXQ6IFJ1bGVTZXQ8VD4pOiBDb25maWd1cmVkRnVuY1R5cGVzIHtcclxuICAgICAgICBpZiAoIXJ1bGVTZXQpIHJldHVybiB7IHN5bmM6IGZhbHNlLCBhc3luYzogZmFsc2UgfTtcclxuXHJcbiAgICAgICAgY29uc3QgaXNSdWxlR3JvdXAgPSB0aGlzLmlzUnVsZUdyb3VwKHJ1bGVTZXQpO1xyXG5cclxuICAgICAgICBpZiAoaXNSdWxlR3JvdXApIHtcclxuICAgICAgICAgICAgY29uc3QgcnVsZUdyb3VwID0gcnVsZVNldCBhcyBSdWxlR3JvdXA8VD47XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdHMgPSBydWxlR3JvdXAucnVsZXNcclxuICAgICAgICAgICAgICAgIC5tYXAocnMgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldENvbmZpZ3VyZWRGdW5jVHlwZXMocnMpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgc3luYzogcmVzdWx0cy5maW5kSW5kZXgoeCA9PiAhIXguc3luYykgPj0gMCxcclxuICAgICAgICAgICAgICAgIGFzeW5jOiByZXN1bHRzLmZpbmRJbmRleCh4ID0+ICEheC5hc3luYykgPj0gMCxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCBydWxlID0gcnVsZVNldCBhcyBSdWxlPFQ+O1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgc3luYzogISFydWxlLmZ1bmMsXHJcbiAgICAgICAgICAgICAgICBhc3luYzogISFydWxlLmFzeW5jRnVuY1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuaW50ZXJmYWNlIENvbmZpZ3VyZWRGdW5jVHlwZXMge1xyXG4gICAgc3luYzogYm9vbGVhbjtcclxuICAgIGFzeW5jOiBib29sZWFuO1xyXG59XHJcbiIsImltcG9ydCB7IEFic3RyYWN0Q29udHJvbCB9IGZyb20gXCJAYW5ndWxhci9mb3Jtc1wiO1xyXG5cclxuLyoqXHJcbiAqIFN0YXRlIG9mIGFuIEFuZ3VsYXIgQWJzdHJhY3RDb250cm9sIGF0IHRoZSB0aW1lIG9mIHJ1bm5pbmcgYSB0ZXN0XHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgQ29udHJvbFN0YXRlIHtcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgX3ByaXN0aW5lOiBib29sZWFuO1xyXG4gICAgcHJpdmF0ZSByZWFkb25seSBfdW50b3VjaGVkOiBib29sZWFuO1xyXG5cclxuICAgIC8vIGdldCBwcmlzdGluZSgpOiBib29sZWFuIHsgcmV0dXJuIHRoaXMuX3ByaXN0aW5lOyB9XHJcbiAgICAvLyBnZXQgdW50b3VjaGVkKCk6IGJvb2xlYW4geyByZXR1cm4gdGhpcy5fdW50b3VjaGVkOyB9XHJcblxyXG4gICAgcHJpdmF0ZSBjb25zdHJ1Y3Rvcihjb250cm9sOiBBYnN0cmFjdENvbnRyb2wpIHtcclxuICAgICAgICB0aGlzLl9wcmlzdGluZSA9IGNvbnRyb2wucHJpc3RpbmU7XHJcbiAgICAgICAgdGhpcy5fdW50b3VjaGVkID0gY29udHJvbC51bnRvdWNoZWQ7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGEgQ29udHJvbFN0YXRlIG9iamVjdCBiYXNlZCBvbiBhbiBBbmd1bGFyIGNvbnRyb2xcclxuICAgICAqIEBwYXJhbSBjb250cm9sIEFuZ3VsYXIgY29udHJvbCB0byBnZW5lcmF0ZSBzdGF0ZSBmcm9tXHJcbiAgICAgKiBAcmV0dXJucyBDb250cm9sIHN0YXRlIGJhc2Ugb24gQW5ndWxhciBjb250cm9sXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBjcmVhdGUoY29udHJvbDogQWJzdHJhY3RDb250cm9sKTogQ29udHJvbFN0YXRlIHtcclxuICAgICAgICByZXR1cm4gbmV3IENvbnRyb2xTdGF0ZShjb250cm9sKTtcclxuICAgIH1cclxufSIsIi8vIHRzbGludDpkaXNhYmxlOm1heC1saW5lLWxlbmd0aFxyXG5pbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcclxuaW1wb3J0IHsgRm9ybUdyb3VwLCBBYnN0cmFjdENvbnRyb2wsIFZhbGlkYXRvckZuLCBGb3JtQnVpbGRlciwgRm9ybUNvbnRyb2wsIEZvcm1BcnJheSwgVmFsaWRhdGlvbkVycm9ycywgQXN5bmNWYWxpZGF0b3JGbiB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcclxuaW1wb3J0IHsgUnVsZXNFbmdpbmVTZXJ2aWNlIH0gZnJvbSBcIi4uL3J1bGVzLWVuZ2luZS9ydWxlcy1lbmdpbmUuc2VydmljZVwiO1xyXG5pbXBvcnQgeyBQcm9wZXJ0eSB9IGZyb20gXCIuLi8uLi8uLi9mb3JtLXJ1bGVzL21vZGVscy9wcm9wZXJ0eVwiO1xyXG5pbXBvcnQgeyBBcnJheUl0ZW1Qcm9wZXJ0eSB9IGZyb20gXCIuLi8uLi8uLi9mb3JtLXJ1bGVzL21vZGVscy9hcnJheS1pdGVtLXByb3BlcnR5XCI7XHJcbmltcG9ydCB7IFByb3BlcnR5QmFzZSB9IGZyb20gXCIuLi8uLi8uLi9mb3JtLXJ1bGVzL21vZGVscy9wcm9wZXJ0eS1iYXNlXCI7XHJcbmltcG9ydCB7IFRyYWNlU2VydmljZSB9IGZyb20gXCIuLi8uLi8uLi91dGlscy90cmFjZS90cmFjZS5zZXJ2aWNlXCI7XHJcbmltcG9ydCB7IE9ic2VydmFibGUsIEJlaGF2aW9yU3ViamVjdCwgb2YsIE9wZXJhdG9yRnVuY3Rpb24sIHRpbWVyLCBlbXB0eSwgRU1QVFkgfSBmcm9tIFwicnhqc1wiO1xyXG5pbXBvcnQgeyBtYXAsIHRhcCwgc3dpdGNoTWFwLCB0YWtlLCBkaXN0aW5jdFVudGlsQ2hhbmdlZCwgZGVib3VuY2UgfSBmcm9tIFwicnhqcy9vcGVyYXRvcnNcIjtcclxuaW1wb3J0IHsgVGVzdFJlc3VsdHNCYXNlIH0gZnJvbSBcIi4uLy4uLy4uL2Zvcm0tcnVsZXMvbW9kZWxzL3Rlc3QtcmVzdWx0cy1iYXNlXCI7XHJcbmltcG9ydCB7IFJlYWN0aXZlRm9ybXNWYWxpZGF0aW9uRXJyb3JzIH0gZnJvbSBcIi4uLy4uLy4uL2Zvcm0tcnVsZXMvbW9kZWxzL3JlYWN0aXZlLWZvcm1zLXZhbGlkYXRpb24tZXJyb3JzXCI7XHJcbmltcG9ydCB7IFJlYWN0aXZlRm9ybXNGYWlsZWRWYWxkYXRpb24gfSBmcm9tIFwiLi4vLi4vLi4vZm9ybS1ydWxlcy9tb2RlbHMvcmVhY3RpdmUtZm9ybXMtZmFpbGVkLXZhbGlkYXRpb25cIjtcclxuaW1wb3J0IHsgUmVhY3RpdmVGb3Jtc1ZhbGlkYXRpb25FcnJvcnNEYXRhIH0gZnJvbSBcIi4uLy4uLy4uL2Zvcm0tcnVsZXMvbW9kZWxzL3JlYWN0aXZlLWZvcm1zLXZhbGlkYXRpb24tZXJyb3JzLWRhdGFcIjtcclxuaW1wb3J0IHsgQ29udHJvbFN0YXRlIH0gZnJvbSBcIi4uLy4uLy4uL2Zvcm0tcnVsZXMvbW9kZWxzL2NvbnRyb2wtc3RhdGVcIjtcclxuaW1wb3J0IHsgQ29tbW9uU2VydmljZSB9IGZyb20gXCIuLi8uLi8uLi91dGlscy9jb21tb24vY29tbW9uLnNlcnZpY2VcIjtcclxuaW1wb3J0IHsgQWJzdHJhY3RNb2RlbFNldHRpbmdzIH0gZnJvbSBcIi4uLy4uLy4uL2Zvcm0tcnVsZXMvbW9kZWxzL2Fic3RyYWN0LW1vZGVsLXNldHRpbmdzXCI7XHJcbmltcG9ydCB7IFZhbHVlQ2hhbmdlT3B0aW9ucyB9IGZyb20gXCIuLi8uLi8uLi9mb3JtLXJ1bGVzL21vZGVscy92YWx1ZS1jaGFuZ2Utb3B0aW9uc1wiO1xyXG5pbXBvcnQgeyBBZGRBcnJheUl0ZW1Qcm9wZXJ0eU9wdGlvbnMgfSBmcm9tIFwiLi4vLi4vLi4vZm9ybS1ydWxlcy9tb2RlbHMvYWRkLWFycmF5LWl0ZW0tcHJvcGVydHktb3B0aW9uc1wiO1xyXG5pbXBvcnQgeyBVcGRhdGVPbiB9IGZyb20gXCIuLi8uLi8uLi9mb3JtLXJ1bGVzL21vZGVscy91cGRhdGUtb25cIjtcclxuLy8gdHNsaW50OmVuYWJsZTptYXgtbGluZS1sZW5ndGhcclxuXHJcbi8qKlxyXG4gKiBCdWlsZHMgcmVhY3RpdmUgZm9ybXMgdXNpbmcgY29uZmlndXJlZCBtb2RlbCBzZXR0aW5nc1xyXG4gKi9cclxuQEluamVjdGFibGUoKVxyXG5leHBvcnQgY2xhc3MgUmVhY3RpdmVGb3Jtc1J1bGVTZXJ2aWNlIHtcclxuICAgIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IEZPUk1fTU9ERUxfU0VUVElOR1NfUFJPUEVSVFlfTkFNRSA9ICduZ0Zvcm1SdWxlc01vZGVsU2V0dGluZyc7XHJcbiAgICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBGT1JDRV9BU1lOQ19WQUxJRF9URVNUX1JVTl9QUk9QRVJUWV9OQU1FID0gJ25nRm9ybVJ1bGVzRm9yY2VBc3luY1ZhbGlkVGVzdFJ1bic7XHJcbiAgICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBDT05UUk9MX0xBU1RfRVJST1IgPSAnbmdGb3JtUnVsZXNDb250cm9sTGFzdEVycm9yJztcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBwcml2YXRlIHJ1bGVzRW5naW5lU3ZjOiBSdWxlc0VuZ2luZVNlcnZpY2UsXHJcbiAgICAgICAgcHJpdmF0ZSBmb3JtQnVpbGRlcjogRm9ybUJ1aWxkZXIsXHJcbiAgICAgICAgcHJpdmF0ZSB0cmFjZVN2YzogVHJhY2VTZXJ2aWNlLFxyXG4gICAgICAgIHByaXZhdGUgY29tbW9uU3ZjOiBDb21tb25TZXJ2aWNlXHJcbiAgICApIHtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEdldHMgbW9kZWwgc2V0dGluZ3Mgd2l0aCB0aGUgcHJvdmlkZWQgbmFtZVxyXG4gICAgICogQHBhcmFtIG5hbWUgTmFtZSBvZiBtb2RlbCBzZXR0aW5nXHJcbiAgICAgKiBAcmV0dXJucyBNb2RlbCBzZXR0aW5ncyB3aXRoIHRoZSBwcm92aWRlZCBuYW1lXHJcbiAgICAgKi9cclxuICAgIGdldE1vZGVsU2V0dGluZ3M8VD4obmFtZTogc3RyaW5nKTogQWJzdHJhY3RNb2RlbFNldHRpbmdzPFQ+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5ydWxlc0VuZ2luZVN2Yy5nZXRNb2RlbFNldHRpbmdzKG5hbWUpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhIGZvcm0gZ3JvdXAgdXNpbmcgYW4gaW5zdGFuY2Ugb2YgbW9kZWwgc2V0dGluZ3NcclxuICAgICAqIEBwYXJhbSBtb2RlbFNldHRpbmdzIE5hbWUgb2YgdGhlIG1vZGVsIHNldHRpbmcgb3IgYW4gaW5zdGFuY2Ugb2YgbW9kZWwgc2V0dGluZ3MgdG8gdXNlXHJcbiAgICAgKiBAcGFyYW0gaW5pdGlhbFZhbHVlIEluaXRpYWwgZGF0YSB0byBzZXQgdGhlIGZvcm0gdmFsdWVzIHRvXHJcbiAgICAgKiBAcmV0dXJucyBGb3JtIGdyb3VwIGNyZWF0ZWQgYWNjb3JkaW5nIHRvIGRlZmluZWQgbW9kZWwgc2V0dGluZ3NcclxuICAgICAqL1xyXG4gICAgY3JlYXRlRm9ybUdyb3VwPFQ+KFxyXG4gICAgICAgIG1vZGVsU2V0dGluZ3M6IHN0cmluZyB8IEFic3RyYWN0TW9kZWxTZXR0aW5nczxUPixcclxuICAgICAgICBpbml0aWFsVmFsdWU/OiBhbnlcclxuICAgICk6IEZvcm1Hcm91cCB7XHJcbiAgICAgICAgbGV0IHNldHRpbmdzOiBBYnN0cmFjdE1vZGVsU2V0dGluZ3M8VD47XHJcblxyXG4gICAgICAgIGlmICh0eXBlb2YgbW9kZWxTZXR0aW5ncyA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICBzZXR0aW5ncyA9IHRoaXMucnVsZXNFbmdpbmVTdmMuZ2V0TW9kZWxTZXR0aW5ncyhtb2RlbFNldHRpbmdzIGFzIHN0cmluZyk7XHJcbiAgICAgICAgICAgIGlmICghc2V0dGluZ3MpIHRocm93IG5ldyBFcnJvcihgTm8gbW9kZWwgc2V0dGluZyBmb3VuZCB3aXRoIHRoZSBuYW1lIFwiJHttb2RlbFNldHRpbmdzfVwiYCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKCFtb2RlbFNldHRpbmdzKSB0aHJvdyBuZXcgRXJyb3IoYEFkaG9jIG1vZGVsIHNldHRpbmcgcHJvdmlkZWQgaXMgaW52YWxpZGApO1xyXG4gICAgICAgICAgICBzZXR0aW5ncyA9IG1vZGVsU2V0dGluZ3MgYXMgQWJzdHJhY3RNb2RlbFNldHRpbmdzPFQ+O1xyXG4gICAgICAgICAgICB0aGlzLnJ1bGVzRW5naW5lU3ZjLmluaXRpYWxpemVNb2RlbFNldHRpbmcoc2V0dGluZ3MpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy50cmFjZVN2Yy50cmFjZShgQ3JlYXRpbmcgZm9ybSBncm91cCB1c2luZyBtb2RlbCBzZXR0aW5ncyBcIiR7c2V0dGluZ3MubmFtZX1cImApO1xyXG4gICAgICAgIGNvbnN0IGZvcm1Hcm91cCA9IHRoaXMuYnVpbGRHcm91cChzZXR0aW5ncy5wcm9wZXJ0aWVzLCBpbml0aWFsVmFsdWUpO1xyXG5cclxuICAgICAgICB0aGlzLnRyYWNlU3ZjLnRyYWNlKGBTZXR0aW5nIHVwIGRlcGVuZGVuY3kgc3Vic2NyaXB0aW9uc2ApO1xyXG4gICAgICAgIHRoaXMucmVzZXREZXBlbmRlbmN5U3Vic2NyaXB0aW9ucyhmb3JtR3JvdXAsIHNldHRpbmdzLnByb3BlcnRpZXMpO1xyXG5cclxuICAgICAgICB0aGlzLnRyYWNlU3ZjLnRyYWNlKGBQYXRjaGluZyBmb3JtIGdyb3VwIHdpdGggaW5pdGlhbCB2YWx1ZWApO1xyXG4gICAgICAgIHRoaXMudHJpZ2dlclZhbHVlQ2hhbmdlKGZvcm1Hcm91cCk7XHJcblxyXG4gICAgICAgIHRoaXMudHJhY2VTdmMudHJhY2UoYEF0dGFjaGluZyBtb2RlbCBzZXR0aW5ncyB0byBmb3JtYCk7XHJcbiAgICAgICAgdGhpcy5hdHRhY2hNb2RlbFNldHRpbmdzVG9Gb3JtKGZvcm1Hcm91cCwgc2V0dGluZ3MpO1xyXG5cclxuICAgICAgICByZXR1cm4gZm9ybUdyb3VwO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQWRkcyBhbiBhcnJheSBpdGVtIHByb3BlcnR5IHRvIGFuIGV4aXN0aW5nIGZvcm0gYXJyYXlcclxuICAgICAqIEBwYXJhbSBwcm9wZXJ0eSBBcnJheUl0ZW1Qcm9wZXJ0eSB0byBmb3IgdGhlIGFycmF5IGl0ZW0gdG8gYmUgYWRkZWRcclxuICAgICAqIEBwYXJhbSBwYXJlbnRGb3JtQXJyYXkgVGhlIHBhcmVudCBGb3JtQXJyYXlcclxuICAgICAqIEBwYXJhbSBpbml0aWFsVmFsdWUgSW5pdGlhbCB2YWx1ZSBvZiB0aGUgZm9ybSBhcnJheSBpdGVtXHJcbiAgICAgKiBAcGFyYW0gb3B0aW9ucyBPcHRpb25zIGZvciBhZGRpbmcgbmV3IGFycmF5IGl0ZW0gcHJvcGVydHlcclxuICAgICAqL1xyXG4gICAgYWRkQXJyYXlJdGVtUHJvcGVydHlDb250cm9sPFQ+KFxyXG4gICAgICAgIHByb3BlcnR5OiBBcnJheUl0ZW1Qcm9wZXJ0eTxUPixcclxuICAgICAgICBwYXJlbnRGb3JtQXJyYXk6IEZvcm1BcnJheSxcclxuICAgICAgICBpbml0aWFsVmFsdWU/OiBhbnksXHJcbiAgICAgICAgb3B0aW9ucz86IEFkZEFycmF5SXRlbVByb3BlcnR5T3B0aW9uc1xyXG4gICAgKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgY29udHJvbCA9IHRoaXMuYnVpbGRBYnN0cmFjdENvbnRyb2wocHJvcGVydHksIGluaXRpYWxWYWx1ZSk7XHJcbiAgICAgICAgY29uc3Qgd2lsbEJlTGFzdEl0ZW0gPSAhb3B0aW9ucyB8fCAhdGhpcy5jb21tb25TdmMuaXNaZXJvT3JHcmVhdGVyKG9wdGlvbnMuaW5kZXgpIHx8IG9wdGlvbnMuaW5kZXggPj0gcGFyZW50Rm9ybUFycmF5Lmxlbmd0aDtcclxuXHJcbiAgICAgICAgaWYgKHdpbGxCZUxhc3RJdGVtKVxyXG4gICAgICAgICAgICBwYXJlbnRGb3JtQXJyYXkucHVzaChjb250cm9sKTtcclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHBhcmVudEZvcm1BcnJheS5pbnNlcnQob3B0aW9ucy5pbmRleCwgY29udHJvbCk7XHJcblxyXG4gICAgICAgIGNvbnN0IG1vZGVsU2V0dGluZ3MgPSB0aGlzLmdldE1vZGVsU2V0dGluZ3NGcm9tRm9ybShwYXJlbnRGb3JtQXJyYXkucm9vdCBhcyBGb3JtR3JvdXApO1xyXG4gICAgICAgIHRoaXMucmVzZXREZXBlbmRlbmN5U3Vic2NyaXB0aW9ucyhwYXJlbnRGb3JtQXJyYXkucm9vdCwgbW9kZWxTZXR0aW5ncy5wcm9wZXJ0aWVzKTtcclxuXHJcbiAgICAgICAgLy8gd2UgbmVlZCB0byBkbyB0aGlzIGJlY2F1c2UgdGhlIGl0ZW0gY291bGQgaGF2ZSBiZWVuIGFkZGVkIGF0IGFueSBpbmRleCBpbiB0aGUgYXJyYXksIGFuZCB3ZSBuZWVkXHJcbiAgICAgICAgLy8gdHJpZ2dlciBhIHZhbHVlIGNoYW5nZSB0byB0cmlnZ2VyIGFueSBkZXBlbmRlbmN5IHByb3BlcnRpeSB2YWxkaWRhdGlvbnNcclxuICAgICAgICB0aGlzLnRyaWdnZXJWYWx1ZUNoYW5nZShwYXJlbnRGb3JtQXJyYXkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRXh0ZW5kcyB2YWxpZGF0b3JzIGdlbmVyYXRlZCBieSBuZy1mb3JtLXJ1bGVzIHdpdGggeW91ciBvd24gdmFsaWRhdG9yc1xyXG4gICAgICogQHBhcmFtIGNvbnRyb2wgQ29udHJvbCB0byBleHRlbmRzIHRoZSB2YWxpZGF0b3JzIGZvclxyXG4gICAgICogQHBhcmFtIHZhbGlkYXRvciBWYWxpZGF0b3IgdG8gYWRkXHJcbiAgICAgKi9cclxuICAgIGV4dGVuZFZhbGlkYXRvcihjb250cm9sOiBBYnN0cmFjdENvbnRyb2wsIHZhbGlkYXRvcjogVmFsaWRhdG9yRm4gfCBWYWxpZGF0b3JGbltdKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKCF2YWxpZGF0b3IpIHJldHVybjtcclxuXHJcbiAgICAgICAgY29uc3QgdmFsaWRhdG9yQXJyYXkgPSBBcnJheS5pc0FycmF5KHZhbGlkYXRvcikgPyB2YWxpZGF0b3IgOiBbdmFsaWRhdG9yXTtcclxuICAgICAgICBjb250cm9sLnNldFZhbGlkYXRvcnMoW2NvbnRyb2wudmFsaWRhdG9yLCAuLi52YWxpZGF0b3JBcnJheV1cclxuICAgICAgICAgICAgLmZpbHRlcih2YWxpZGF0b3JGbiA9PiAhIXZhbGlkYXRvckZuKSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBFeHRlbmRzIGFzeW5jIHZhbGlkYXRvcnMgZ2VuZXJhdGVkIGJ5IG5nLWZvcm0tcnVsZXMgd2l0aCB5b3VyIG93biBhc3luYyB2YWxpZGF0b3JzXHJcbiAgICAgKiBAcGFyYW0gY29udHJvbCBDb250cm9sIHRvIGV4dGVuZHMgdGhlIGFzeW5jIHZhbGlkYXRvcnMgZm9yXHJcbiAgICAgKiBAcGFyYW0gYXN5bmNWYWxpZGF0b3IgQXN5bmMgdmFsaWRhdG9yIHRvIGFkZFxyXG4gICAgICovXHJcbiAgICBleHRlbmRBc3luY1ZhbGlkYXRvcihjb250cm9sOiBBYnN0cmFjdENvbnRyb2wsIGFzeW5jVmFsaWRhdG9yOiBBc3luY1ZhbGlkYXRvckZuIHwgQXN5bmNWYWxpZGF0b3JGbltdKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKCFhc3luY1ZhbGlkYXRvcikgcmV0dXJuO1xyXG5cclxuICAgICAgICBjb25zdCBhc3luY1ZhbGlkYXRvckFycmF5ID0gQXJyYXkuaXNBcnJheShhc3luY1ZhbGlkYXRvcikgPyBhc3luY1ZhbGlkYXRvciA6IFthc3luY1ZhbGlkYXRvcl07XHJcbiAgICAgICAgY29udHJvbC5zZXRBc3luY1ZhbGlkYXRvcnMoW2NvbnRyb2wuYXN5bmNWYWxpZGF0b3IsIC4uLmFzeW5jVmFsaWRhdG9yQXJyYXldXHJcbiAgICAgICAgICAgIC5maWx0ZXIoYXN5bmNWYWxpZGF0b3JGbiA9PiAhIWFzeW5jVmFsaWRhdG9yRm4pKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGJ1aWxkQWJzdHJhY3RDb250cm9sPFQ+KHByb3BlcnR5OiBQcm9wZXJ0eUJhc2U8VD4sIGluaXRpYWxWYWx1ZT86IGFueSk6IEFic3RyYWN0Q29udHJvbCB7XHJcbiAgICAgICAgbGV0IGNvbnRyb2w6IEFic3RyYWN0Q29udHJvbDtcclxuXHJcbiAgICAgICAgaWYgKHByb3BlcnR5LmFycmF5SXRlbVByb3BlcnR5KSBjb250cm9sID0gdGhpcy5idWlsZEFycmF5KHByb3BlcnR5LmFycmF5SXRlbVByb3BlcnR5LCBpbml0aWFsVmFsdWUsIHByb3BlcnR5LnVwZGF0ZU9uKTtcclxuICAgICAgICBlbHNlIGlmIChwcm9wZXJ0eS5wcm9wZXJ0aWVzKSBjb250cm9sID0gdGhpcy5idWlsZEdyb3VwKHByb3BlcnR5LnByb3BlcnRpZXMsIGluaXRpYWxWYWx1ZSwgcHJvcGVydHkudXBkYXRlT24pO1xyXG4gICAgICAgIGVsc2UgY29udHJvbCA9IHRoaXMuYnVpbGRDb250cm9sKGluaXRpYWxWYWx1ZSwgcHJvcGVydHkudXBkYXRlT24pO1xyXG5cclxuICAgICAgICAvLyBzZXR1cCB2YWxpZGF0aW9uIHRlc3RzIG9uIHZhbHVlIGNoYW5nZVxyXG4gICAgICAgIGNvbnRyb2wuc2V0VmFsaWRhdG9ycyh0aGlzLmJ1aWxkVmFsaWRhdG9yRnVuY3Rpb24ocHJvcGVydHkpKTtcclxuICAgICAgICBjb250cm9sLnNldEFzeW5jVmFsaWRhdG9ycyh0aGlzLmJ1aWxkQXN5bmNWYWxpZGF0b3JGdW5jdGlvbihwcm9wZXJ0eSkpO1xyXG5cclxuICAgICAgICAvLyBzZXR1cCBlZGl0IHRlc3RzIG9uIHZhbHVlIGNoYW5nZVxyXG4gICAgICAgIGNvbnRyb2wudmFsdWVDaGFuZ2VzXHJcbiAgICAgICAgICAgIC5waXBlKFxyXG4gICAgICAgICAgICAgICAgdGhpcy5hcHBseVZhbHVlQ2hhbmdlT3B0aW9ucyhwcm9wZXJ0eS52YWx1ZUNoYW5nZU9wdGlvbnMuc2VsZi5lZGl0KVxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgICAgIC5zdWJzY3JpYmUodmFsdWUgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wZXJzaXN0RWRpdFRlc3RzKGNvbnRyb2wsIHByb3BlcnR5KTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiBjb250cm9sO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgYnVpbGRDb250cm9sPFQ+KGluaXRpYWxWYWx1ZTogYW55LCB1cGRhdGVPbj86IFVwZGF0ZU9uKTogRm9ybUNvbnRyb2wge1xyXG4gICAgICAgIHJldHVybiBuZXcgRm9ybUNvbnRyb2woaW5pdGlhbFZhbHVlLCB7IHVwZGF0ZU9uOiB1cGRhdGVPbiB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGJ1aWxkR3JvdXA8VD4ocHJvcGVydGllczogUHJvcGVydHk8VD5bXSwgaW5pdGlhbFZhbHVlOiBhbnksIHVwZGF0ZU9uPzogVXBkYXRlT24pOiBGb3JtR3JvdXAge1xyXG4gICAgICAgIGNvbnN0IGZvcm1Hcm91cCA9IG5ldyBGb3JtR3JvdXAoe30sIHsgdXBkYXRlT246IHVwZGF0ZU9uIH0pO1xyXG5cclxuICAgICAgICAocHJvcGVydGllcyB8fCBbXSkuZm9yRWFjaChwID0+IHtcclxuICAgICAgICAgICAgY29uc3QgcHJvcGVydHlWYWx1ZSA9IGluaXRpYWxWYWx1ZSA/IGluaXRpYWxWYWx1ZVtwLm5hbWVdIDogbnVsbDtcclxuICAgICAgICAgICAgY29uc3QgY3RybCA9IHRoaXMuYnVpbGRBYnN0cmFjdENvbnRyb2wocCwgcHJvcGVydHlWYWx1ZSk7XHJcbiAgICAgICAgICAgIGZvcm1Hcm91cC5hZGRDb250cm9sKHAubmFtZSwgY3RybCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiBmb3JtR3JvdXA7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBidWlsZEFycmF5PFQ+KHByb3BlcnR5OiBBcnJheUl0ZW1Qcm9wZXJ0eTxUPiwgaW5pdGlhbFZhbHVlOiBhbnlbXSwgdXBkYXRlT24/OiBVcGRhdGVPbik6IEZvcm1BcnJheSB7XHJcbiAgICAgICAgaW5pdGlhbFZhbHVlID0gQXJyYXkuaXNBcnJheShpbml0aWFsVmFsdWUpID8gaW5pdGlhbFZhbHVlIDogW107XHJcblxyXG4gICAgICAgIHJldHVybiBuZXcgRm9ybUFycmF5KFxyXG4gICAgICAgICAgICBpbml0aWFsVmFsdWUubWFwKHYgPT4gdGhpcy5idWlsZEFic3RyYWN0Q29udHJvbChwcm9wZXJ0eSwgdikpLFxyXG4gICAgICAgICAgICB7IHVwZGF0ZU9uOiB1cGRhdGVPbiB9XHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGJ1aWxkVmFsaWRhdG9yRnVuY3Rpb248VD4ocHJvcGVydHk6IFByb3BlcnR5QmFzZTxUPik6IFZhbGlkYXRvckZuIHtcclxuICAgICAgICBjb25zdCBzeW5jR3JvdXBzID0gdGhpcy5ydWxlc0VuZ2luZVN2Yy5ncm91cFRlc3RzQnlTeW5jVHlwZShwcm9wZXJ0eS52YWxpZCk7XHJcbiAgICAgICAgaWYgKCFzeW5jR3JvdXBzLnN5bmMubGVuZ3RoKSByZXR1cm4gbnVsbDtcclxuXHJcbiAgICAgICAgcmV0dXJuIChjb250cm9sOiBBYnN0cmFjdENvbnRyb2wpOiBWYWxpZGF0aW9uRXJyb3JzID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY29udHJvbENvbnRleHRWYWx1ZXMgPSB0aGlzLmdldENvbnRyb2xDb250ZXh0VmFsdWVzKGNvbnRyb2wsIHByb3BlcnR5KTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHRlc3RSZXN1bHRzID0gdGhpcy5ydWxlc0VuZ2luZVN2Y1xyXG4gICAgICAgICAgICAgICAgLnJ1blRlc3RzKGNvbnRyb2xDb250ZXh0VmFsdWVzLnJlbGF0aXZlLCBzeW5jR3JvdXBzLnN5bmMsIHtcclxuICAgICAgICAgICAgICAgICAgICByb290RGF0YTogY29udHJvbENvbnRleHRWYWx1ZXMucm9vdCxcclxuICAgICAgICAgICAgICAgICAgICBjb250cm9sU3RhdGU6IENvbnRyb2xTdGF0ZS5jcmVhdGUoY29udHJvbClcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRlc3RSZXN1bHRzLnJlc3VsdHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRyYWNlU3ZjLnRyYWNlKGBWYWxpZGF0ZWQgcHJvcGVydHkgXCIke3Byb3BlcnR5LmFic29sdXRlUGF0aH1cIi4gYCArXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5idWlsZFRlc3RSZXN1bHRTdGF0c1N0cmluZyh0ZXN0UmVzdWx0cykpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tYXBUb1JlYWN0aXZlRm9ybXNWYWxpZGF0aW9uRXJyb3JzKHRlc3RSZXN1bHRzKTtcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgYnVpbGRBc3luY1ZhbGlkYXRvckZ1bmN0aW9uPFQ+KHByb3BlcnR5OiBQcm9wZXJ0eUJhc2U8VD4pOiBBc3luY1ZhbGlkYXRvckZuIHtcclxuICAgICAgICBjb25zdCByYXdBc3luY0Z1bmMgPSB0aGlzLmJ1aWxkQXN5bmNWYWxpZGF0b3JGdW5jdGlvblJhdyhwcm9wZXJ0eSk7XHJcblxyXG4gICAgICAgIGlmICghcmF3QXN5bmNGdW5jKSByZXR1cm4gbnVsbDtcclxuXHJcbiAgICAgICAgY29uc3QgdmFsdWVzID0gbmV3IEJlaGF2aW9yU3ViamVjdDxBYnN0cmFjdENvbnRyb2w+KG51bGwpO1xyXG4gICAgICAgIGNvbnN0IHZhbGlkJCA9IHZhbHVlcy5waXBlKFxyXG4gICAgICAgICAgICB0aGlzLmFwcGx5QXN5bmNWYWxpZFZhbHVlQ2hhbmdlT3B0aW9ucyhwcm9wZXJ0eS52YWx1ZUNoYW5nZU9wdGlvbnMuc2VsZi5hc3luY1ZhbGlkKSxcclxuICAgICAgICAgICAgc3dpdGNoTWFwKHggPT4ge1xyXG4gICAgICAgICAgICAgICAgLy8gcGFzcyB0aHJvdWdoIG1lYW5zIHdlIGRpZCBub3QgZXhlY3V0ZSB0aGUgbmctZm9ybS1ydWxlcyBhc3luYyB0ZXN0c1xyXG4gICAgICAgICAgICAgICAgaWYgKHgucGFzc3Rocm91Z2gpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50RXJyb3JzID0geC5jb250cm9sLmVycm9ycyB8fCB7fTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBsYXN0TmdGb3JtUnVsZXNFcnJvcnMgPSB0aGlzLmdldExhc3RFcnJvckZvckNvbnRyb2woeC5jb250cm9sKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gcmV0dXJuIHRoZSBsYXN0IG5nLWZvcm0tcnVsZXMgZXJyb3JzIChpZiBhbnkpIGFsb25nc2lkZSBub24gbmctZm9ybS1ydWxlcyBlcnJvcnMuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhpcyBoYW5kbGVzIHNjZW5hcmlvIHdoZXJlIGRlYm91bmNlIGFuZCBkaXN0aW5jdCBhcmUgdXNlZCBhbmQgc3RhdGUgZ29lcyBmcm9tOlxyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgIGludmFsaWQgLT4gbWFrZSBjaGFuZ2VzIGFuZCBiYWNrIHRoZW0gb3V0IC0+IHZhbGlkXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9mKE9iamVjdC5hc3NpZ24oY3VycmVudEVycm9ycywgeyBuZ0Zvcm1SdWxlczogbGFzdE5nRm9ybVJ1bGVzRXJyb3JzIH0gYXMgUmVhY3RpdmVGb3Jtc1ZhbGlkYXRpb25FcnJvcnMpKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJhd0FzeW5jRnVuYyh4LmNvbnRyb2wpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgdGFrZSgxKVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIHJldHVybiAoY29udHJvbDogQWJzdHJhY3RDb250cm9sKTogUHJvbWlzZTxWYWxpZGF0aW9uRXJyb3JzPiB8IE9ic2VydmFibGU8VmFsaWRhdGlvbkVycm9ycz4gPT4ge1xyXG4gICAgICAgICAgICB2YWx1ZXMubmV4dChjb250cm9sKTtcclxuICAgICAgICAgICAgcmV0dXJuIHZhbGlkJDtcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgYnVpbGRBc3luY1ZhbGlkYXRvckZ1bmN0aW9uUmF3PFQ+KHByb3BlcnR5OiBQcm9wZXJ0eUJhc2U8VD4pOiBBc3luY1ZhbGlkYXRvckZuIHtcclxuICAgICAgICBjb25zdCBzeW5jR3JvdXBzID0gdGhpcy5ydWxlc0VuZ2luZVN2Yy5ncm91cFRlc3RzQnlTeW5jVHlwZShwcm9wZXJ0eS52YWxpZCk7XHJcbiAgICAgICAgaWYgKCFzeW5jR3JvdXBzLmFzeW5jLmxlbmd0aCkgcmV0dXJuIG51bGw7XHJcblxyXG4gICAgICAgIHJldHVybiAoY29udHJvbDogQWJzdHJhY3RDb250cm9sKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRyb2xDb250ZXh0VmFsdWVzID0gdGhpcy5nZXRDb250cm9sQ29udGV4dFZhbHVlcyhjb250cm9sLCBwcm9wZXJ0eSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5ydWxlc0VuZ2luZVN2Yy5ydW5UZXN0c0FzeW5jKGNvbnRyb2xDb250ZXh0VmFsdWVzLnJlbGF0aXZlLCBzeW5jR3JvdXBzLmFzeW5jLCB7XHJcbiAgICAgICAgICAgICAgICByb290RGF0YTogY29udHJvbENvbnRleHRWYWx1ZXMucm9vdCxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xTdGF0ZTogQ29udHJvbFN0YXRlLmNyZWF0ZShjb250cm9sKVxyXG4gICAgICAgICAgICB9KS5waXBlKFxyXG4gICAgICAgICAgICAgICAgdGFwKHRlc3RSZXN1bHRzID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGVzdFJlc3VsdHMucmVzdWx0cy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50cmFjZVN2Yy50cmFjZShgVmFsaWRhdGVkIChhc3luYykgcHJvcGVydHkgXCIke3Byb3BlcnR5LmFic29sdXRlUGF0aH1cIi4gYCArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJ1aWxkVGVzdFJlc3VsdFN0YXRzU3RyaW5nKHRlc3RSZXN1bHRzKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgICAgICBtYXAodGhpcy5tYXBUb1JlYWN0aXZlRm9ybXNWYWxpZGF0aW9uRXJyb3JzKSxcclxuICAgICAgICAgICAgICAgIHRhcCh4ID0+IHRoaXMuc2V0TGFzdEVycm9yRm9yQ29udHJvbChjb250cm9sLCAoeCB8fCB7fSkubmdGb3JtUnVsZXMpKVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSByZXNldERlcGVuZGVuY3lTdWJzY3JpcHRpb25zPFQ+KFxyXG4gICAgICAgIHBhcmVudENvbnRyb2w6IEFic3RyYWN0Q29udHJvbCxcclxuICAgICAgICBwcm9wZXJ0aWVzOiBQcm9wZXJ0eUJhc2U8VD5bXSxcclxuICAgICk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMucmVtb3ZlRGVwZW5kZW5jeVN1YnNjcmlwdGlvbnMocHJvcGVydGllcyk7XHJcbiAgICAgICAgdGhpcy5hZGREZXBlbmRlbmN5U3Vic2NyaXB0aW9ucyhwYXJlbnRDb250cm9sLCBwcm9wZXJ0aWVzKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHJlbW92ZURlcGVuZGVuY3lTdWJzY3JpcHRpb25zPFQ+KFxyXG4gICAgICAgIHByb3BlcnRpZXM6IFByb3BlcnR5QmFzZTxUPltdXHJcbiAgICApOiB2b2lkIHtcclxuICAgICAgICAocHJvcGVydGllcyB8fCBbXSkuZm9yRWFjaChwcm9wZXJ0eSA9PiB7XHJcbiAgICAgICAgICAgIHByb3BlcnR5LmNsZWFyRGVwZW5kZW5jeVByb3BlcnR5U3Vic2NyaXB0aW9ucygpO1xyXG5cclxuICAgICAgICAgICAgaWYgKHByb3BlcnR5LnByb3BlcnRpZXMpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlRGVwZW5kZW5jeVN1YnNjcmlwdGlvbnMocHJvcGVydHkucHJvcGVydGllcyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChwcm9wZXJ0eS5hcnJheUl0ZW1Qcm9wZXJ0eSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVEZXBlbmRlbmN5U3Vic2NyaXB0aW9ucyhbcHJvcGVydHkuYXJyYXlJdGVtUHJvcGVydHldKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgYWRkRGVwZW5kZW5jeVN1YnNjcmlwdGlvbnM8VD4oXHJcbiAgICAgICAgcGFyZW50Q29udHJvbDogQWJzdHJhY3RDb250cm9sLFxyXG4gICAgICAgIHByb3BlcnRpZXM6IFByb3BlcnR5QmFzZTxUPltdLFxyXG4gICAgICAgIGFycmF5SW5kZXg/OiBudW1iZXJcclxuICAgICk6IHZvaWQge1xyXG4gICAgICAgIChwcm9wZXJ0aWVzIHx8IFtdKS5mb3JFYWNoKHByb3BlcnR5ID0+IHtcclxuICAgICAgICAgICAgY29uc3QgcHJvcGVydHlDb250cm9sID0gdGhpcy5nZXRQcm9wZXJ0eUZyb21QYXJlbnQocGFyZW50Q29udHJvbCwgcHJvcGVydHksIGFycmF5SW5kZXgpO1xyXG4gICAgICAgICAgICBpZiAoIXByb3BlcnR5Q29udHJvbCkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5zZXR1cEVkaXRhYmlsaXR5RGVwZW5kZW5jeVN1YnNjcmlwdGlvbnMocHJvcGVydHlDb250cm9sLCBwYXJlbnRDb250cm9sLCBwcm9wZXJ0eSk7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0dXBWYWxpZGF0aW9uRGVwZW5kZW5jeVN1YnNjcmlwdGlvbnMocHJvcGVydHlDb250cm9sLCBwYXJlbnRDb250cm9sLCBwcm9wZXJ0eSk7XHJcblxyXG4gICAgICAgICAgICBpZiAocHJvcGVydHkucHJvcGVydGllcykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZGREZXBlbmRlbmN5U3Vic2NyaXB0aW9ucyhwcm9wZXJ0eUNvbnRyb2wsIHByb3BlcnR5LnByb3BlcnRpZXMpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAocHJvcGVydHkuYXJyYXlJdGVtUHJvcGVydHkpIHtcclxuICAgICAgICAgICAgICAgIC8vIGlmIHRoZXJlIGlzIGFuIGFycmF5SXRlbVByb3BlcnR5IHdlIGtub3cgdGhhdCB3ZSBhcmUgd29ya2luZyB3aXRoIGEgRm9ybUFycmF5IGNvbnRyb2xcclxuICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1BcnJheUNvbnRyb2wgPSAocHJvcGVydHlDb250cm9sIGFzIEZvcm1BcnJheSk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGZvcm1BcnJheUNvbnRyb2wubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZERlcGVuZGVuY3lTdWJzY3JpcHRpb25zKGZvcm1BcnJheUNvbnRyb2wsIFtwcm9wZXJ0eS5hcnJheUl0ZW1Qcm9wZXJ0eV0sIGkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzZXR1cFZhbGlkYXRpb25EZXBlbmRlbmN5U3Vic2NyaXB0aW9uczxUPihcclxuICAgICAgICBwcm9wZXJ0eUNvbnRyb2w6IEFic3RyYWN0Q29udHJvbCwgcGFyZW50Q29udHJvbDogQWJzdHJhY3RDb250cm9sLCBwcm9wZXJ0eTogUHJvcGVydHlCYXNlPFQ+XHJcbiAgICApOiB2b2lkIHtcclxuICAgICAgICBjb25zdCBkZXBlbmRlbmN5UHJvcE5hbWVzID0gdGhpcy5ydWxlc0VuZ2luZVN2Yy5nZXREZXBlbmRlbmN5UHJvcGVydGllcyhwcm9wZXJ0eS52YWxpZCk7XHJcblxyXG4gICAgICAgIGRlcGVuZGVuY3lQcm9wTmFtZXMuZm9yRWFjaChkID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZGVwZW5kZW5jeUNvbnRyb2wgPSB0aGlzLmZpbmRDb250cm9sUmVsYXRpdmVseShwYXJlbnRDb250cm9sLCBkKTtcclxuXHJcbiAgICAgICAgICAgIGlmICghZGVwZW5kZW5jeUNvbnRyb2wpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHN1YiQgPSBkZXBlbmRlbmN5Q29udHJvbC52YWx1ZUNoYW5nZXNcclxuICAgICAgICAgICAgICAgIC5waXBlKFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwbHlWYWx1ZUNoYW5nZU9wdGlvbnMocHJvcGVydHkudmFsdWVDaGFuZ2VPcHRpb25zLmRlcGVuZGVuY3lQcm9wZXJ0aWVzLnZhbGlkKVxyXG4gICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgLnN1YnNjcmliZSh2YWx1ZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRGb3JjZUFzeW5jVmFsaWRhdGlvblRlc3RGb3JDb250cm9sKHByb3BlcnR5Q29udHJvbCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlDb250cm9sLnVwZGF0ZVZhbHVlQW5kVmFsaWRpdHkoeyBvbmx5U2VsZjogdHJ1ZSwgZW1pdEV2ZW50OiBmYWxzZSB9KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcHJvcGVydHkuYWRkRGVwZW5kZW5jeVByb3BlcnR5U3Vic2NyaXB0aW9uKHN1YiQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc2V0dXBFZGl0YWJpbGl0eURlcGVuZGVuY3lTdWJzY3JpcHRpb25zPFQ+KFxyXG4gICAgICAgIHByb3BlcnR5Q29udHJvbDogQWJzdHJhY3RDb250cm9sLFxyXG4gICAgICAgIHBhcmVudENvbnRyb2w6IEFic3RyYWN0Q29udHJvbCxcclxuICAgICAgICBwcm9wZXJ0eTogUHJvcGVydHlCYXNlPFQ+XHJcbiAgICApOiB2b2lkIHtcclxuICAgICAgICBjb25zdCBkZXBlbmRlbmN5UHJvcE5hbWVzID0gdGhpcy5ydWxlc0VuZ2luZVN2Yy5nZXREZXBlbmRlbmN5UHJvcGVydGllcyhwcm9wZXJ0eS5lZGl0KTtcclxuXHJcbiAgICAgICAgZGVwZW5kZW5jeVByb3BOYW1lcy5mb3JFYWNoKGRwbiA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRlcGVuZGVuY3lDb250cm9sID0gdGhpcy5maW5kQ29udHJvbFJlbGF0aXZlbHkocGFyZW50Q29udHJvbCwgZHBuKTtcclxuXHJcbiAgICAgICAgICAgIGlmICghZGVwZW5kZW5jeUNvbnRyb2wpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgIC8vIHNldHVwIGNvbnRyb2wgdG8gcGVyZm9ybSBlZGl0IHRlc3RzIHdoZW4gZGVwZW5kZW5jeSBwcm9wZXJ0eSBjaGFuZ2VzXHJcbiAgICAgICAgICAgIGNvbnN0IHN1YiQgPSBkZXBlbmRlbmN5Q29udHJvbC52YWx1ZUNoYW5nZXNcclxuICAgICAgICAgICAgICAgIC5waXBlKFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwbHlWYWx1ZUNoYW5nZU9wdGlvbnMocHJvcGVydHkudmFsdWVDaGFuZ2VPcHRpb25zLmRlcGVuZGVuY3lQcm9wZXJ0aWVzLmVkaXQpXHJcbiAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAuc3Vic2NyaWJlKHZhbHVlID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBlcnNpc3RFZGl0VGVzdHMocHJvcGVydHlDb250cm9sLCBwcm9wZXJ0eSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHByb3BlcnR5LmFkZERlcGVuZGVuY3lQcm9wZXJ0eVN1YnNjcmlwdGlvbihzdWIkKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHBlcnNpc3RFZGl0VGVzdHM8VD4ocHJvcGVydHlDb250cm9sOiBBYnN0cmFjdENvbnRyb2wsIHByb3BlcnR5OiBQcm9wZXJ0eUJhc2U8VD4pOiB2b2lkIHtcclxuICAgICAgICBjb25zdCBjb250cm9sQ29udGV4dFZhbHVlcyA9IHRoaXMuZ2V0Q29udHJvbENvbnRleHRWYWx1ZXMocHJvcGVydHlDb250cm9sLCBwcm9wZXJ0eSk7XHJcblxyXG4gICAgICAgIHRoaXMucnVsZXNFbmdpbmVTdmMuZWRpdGFibGUoY29udHJvbENvbnRleHRWYWx1ZXMucmVsYXRpdmUsIHByb3BlcnR5LCB7XHJcbiAgICAgICAgICAgIHJvb3REYXRhOiBjb250cm9sQ29udGV4dFZhbHVlcy5yb290LFxyXG4gICAgICAgICAgICBjb250cm9sU3RhdGU6IENvbnRyb2xTdGF0ZS5jcmVhdGUocHJvcGVydHlDb250cm9sKVxyXG4gICAgICAgIH0pLnN1YnNjcmliZSh0ZXN0UmVzdWx0cyA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0ZXN0UmVzdWx0cy5yZXN1bHRzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy50cmFjZVN2Yy50cmFjZShgRWRpdGFibGUgcHJvcGVydHkgXCIke3Byb3BlcnR5LmFic29sdXRlUGF0aH1cIi4gYCArXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5idWlsZFRlc3RSZXN1bHRTdGF0c1N0cmluZyh0ZXN0UmVzdWx0cykpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodGVzdFJlc3VsdHMucGFzc2VkICYmIHByb3BlcnR5Q29udHJvbC5kaXNhYmxlZClcclxuICAgICAgICAgICAgICAgIHByb3BlcnR5Q29udHJvbC5lbmFibGUoeyBlbWl0RXZlbnQ6IGZhbHNlIH0pO1xyXG4gICAgICAgICAgICBlbHNlIGlmICghdGVzdFJlc3VsdHMucGFzc2VkICYmIHByb3BlcnR5Q29udHJvbC5lbmFibGVkKVxyXG4gICAgICAgICAgICAgICAgcHJvcGVydHlDb250cm9sLmRpc2FibGUoeyBlbWl0RXZlbnQ6IGZhbHNlIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgYXBwbHlBc3luY1ZhbGlkVmFsdWVDaGFuZ2VPcHRpb25zKFxyXG4gICAgICAgIHZhbHVlQ2hhbmdlT3B0aW9uczogVmFsdWVDaGFuZ2VPcHRpb25zXHJcbiAgICApOiBPcGVyYXRvckZ1bmN0aW9uPEFic3RyYWN0Q29udHJvbCwgQXN5bmNWYWxpZGF0aW9uUGFzc3Rocm91Z2hhYmxlPiB7XHJcbiAgICAgICAgcmV0dXJuIChzb3VyY2UkOiBPYnNlcnZhYmxlPEFic3RyYWN0Q29udHJvbD4pOiBPYnNlcnZhYmxlPEFzeW5jVmFsaWRhdGlvblBhc3N0aHJvdWdoYWJsZT4gPT4ge1xyXG4gICAgICAgICAgICBsZXQgbGFzdFZhbHVlOiBhbnk7XHJcbiAgICAgICAgICAgIGxldCBpc0ZvcmNlOiBib29sZWFuO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHNvdXJjZSQucGlwZShcclxuICAgICAgICAgICAgICAgIHRhcChjb250cm9sID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpc0ZvcmNlID0gdGhpcy5kb2VzQ29udHJvbEhhdmVGb3JjZWRBc3luY1ZhbGlkYXRpb24oY29udHJvbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRGb3JjZUFzeW5jVmFsaWRhdGlvblRlc3RGb3JDb250cm9sKGNvbnRyb2wsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICAgICAgZGVib3VuY2UoeCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlzRm9yY2UgfHwgdmFsdWVDaGFuZ2VPcHRpb25zLmRlYm91bmNlTWlsbGlzZWNvbmRzID4gMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA/IHRpbWVyKHZhbHVlQ2hhbmdlT3B0aW9ucy5kZWJvdW5jZU1pbGxpc2Vjb25kcylcclxuICAgICAgICAgICAgICAgICAgICAgICAgOiBFTVBUWTtcclxuICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICAgICAgbWFwKGNvbnRyb2wgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2w6IGNvbnRyb2wsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3N0aHJvdWdoOiAhKGNvbnRyb2wudmFsdWUgIT09IGxhc3RWYWx1ZSB8fCAhdmFsdWVDaGFuZ2VPcHRpb25zLmRpc3RpbmN0VW50aWxDaGFuZ2VkIHx8IGlzRm9yY2UpXHJcbiAgICAgICAgICAgICAgICAgICAgfSBhcyBBc3luY1ZhbGlkYXRpb25QYXNzdGhyb3VnaGFibGU7XHJcbiAgICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgICAgIHRhcCh4ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXgucGFzc3Rocm91Z2gpIGxhc3RWYWx1ZSA9IHguY29udHJvbC52YWx1ZTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGFwcGx5VmFsdWVDaGFuZ2VPcHRpb25zKHZhbHVlQ2hhbmdlT3B0aW9uczogVmFsdWVDaGFuZ2VPcHRpb25zKTogT3BlcmF0b3JGdW5jdGlvbjxhbnksIGFueT4ge1xyXG4gICAgICAgIHJldHVybiAoc291cmNlJDogT2JzZXJ2YWJsZTxhbnk+KTogT2JzZXJ2YWJsZTxhbnk+ID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIHNvdXJjZSQucGlwZShcclxuICAgICAgICAgICAgICAgIGRlYm91bmNlKHggPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZUNoYW5nZU9wdGlvbnMuZGVib3VuY2VNaWxsaXNlY29uZHMgPiAwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gdGltZXIodmFsdWVDaGFuZ2VPcHRpb25zLmRlYm91bmNlTWlsbGlzZWNvbmRzKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA6IEVNUFRZO1xyXG4gICAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgICAgICB2YWx1ZUNoYW5nZU9wdGlvbnMuZGlzdGluY3RVbnRpbENoYW5nZWQgPyBkaXN0aW5jdFVudGlsQ2hhbmdlZCgpIDogdGFwKClcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0Q29udHJvbENvbnRleHRWYWx1ZXM8VD4oY29udHJvbDogQWJzdHJhY3RDb250cm9sLCBwcm9wZXJ0eTogUHJvcGVydHk8VD4gfCBBcnJheUl0ZW1Qcm9wZXJ0eTxUPik6IENvbnRyb2xDb250ZXh0VmFsdWVzIHtcclxuICAgICAgICBjb25zdCByb290VmFsdWUgPSAoY29udHJvbC5yb290IGFzIEZvcm1Hcm91cCkuZ2V0UmF3VmFsdWUoKTtcclxuXHJcbiAgICAgICAgLy8gdXNlIHRoZSBjb250cm9sIHZhbHVlIGlmIGFuIGFycmF5IGl0ZW0sIG90aGVyd2lzZSB1c2UgdGhlIHBhcmVudCBjb250cm9sXHJcbiAgICAgICAgY29uc3QgcmVsYXRpdmVWYWx1ZSA9IFByb3BlcnR5QmFzZS5pc0FycmF5SXRlbVByb3BlcnR5KHByb3BlcnR5KVxyXG4gICAgICAgICAgICA/IGNvbnRyb2wudmFsdWVcclxuICAgICAgICAgICAgOiBjb250cm9sLnBhcmVudC5nZXRSYXdWYWx1ZSgpO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICByb290OiByb290VmFsdWUsXHJcbiAgICAgICAgICAgIHJlbGF0aXZlOiByZWxhdGl2ZVZhbHVlXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldFByb3BlcnR5RnJvbVBhcmVudDxUPihcclxuICAgICAgICBwYXJlbnRDb250cm9sOiBBYnN0cmFjdENvbnRyb2wsXHJcbiAgICAgICAgcHJvcGVydHk6IFByb3BlcnR5QmFzZTxUPixcclxuICAgICAgICBhcnJheUluZGV4PzogbnVtYmVyXHJcbiAgICApIHtcclxuICAgICAgICByZXR1cm4gUHJvcGVydHlCYXNlLmlzQXJyYXlJdGVtUHJvcGVydHkocHJvcGVydHkpXHJcbiAgICAgICAgICAgID8gKHBhcmVudENvbnRyb2wgYXMgRm9ybUFycmF5KS5hdChhcnJheUluZGV4KVxyXG4gICAgICAgICAgICA6IHBhcmVudENvbnRyb2wuZ2V0KChwcm9wZXJ0eSBhcyBQcm9wZXJ0eTxUPikubmFtZSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBtYXBUb1JlYWN0aXZlRm9ybXNWYWxpZGF0aW9uRXJyb3JzPFQ+KHRlc3RSZXN1bHRzOiBUZXN0UmVzdWx0c0Jhc2U8VD4pOiBSZWFjdGl2ZUZvcm1zVmFsaWRhdGlvbkVycm9ycyB7XHJcbiAgICAgICAgLy8gaWYgcGFzc2VkLCBBbmd1bGFyIHJlYWN0aXZlIGZvcm1zIHdhbnRzIHVzIHRvIHJldHVybiBudWxsLCBvdGhlcndpc2UgcmV0dXJuIGFuIG9iamVjdCB3aXRoIHRoZSB2YWxpZGF0aW9uIGluZm9cclxuICAgICAgICBpZiAoIXRlc3RSZXN1bHRzIHx8IHRlc3RSZXN1bHRzLnBhc3NlZCkgcmV0dXJuIG51bGw7XHJcblxyXG4gICAgICAgIGNvbnN0IGZhaWxlZDogeyBba2V5OiBzdHJpbmddOiBSZWFjdGl2ZUZvcm1zRmFpbGVkVmFsZGF0aW9uIH0gPSB7fTtcclxuXHJcbiAgICAgICAgdGVzdFJlc3VsdHMuZmFpbGVkUmVzdWx0cy5mb3JFYWNoKHRlc3QgPT4ge1xyXG4gICAgICAgICAgICBmYWlsZWRbdGVzdC5uYW1lXSA9IHsgbWVzc2FnZTogdGVzdC5tZXNzYWdlIH07XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIG5nRm9ybVJ1bGVzOiB7XHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiB0ZXN0UmVzdWx0cy5tZXNzYWdlLFxyXG4gICAgICAgICAgICAgICAgZmFpbGVkOiBmYWlsZWRcclxuICAgICAgICAgICAgfSBhcyBSZWFjdGl2ZUZvcm1zVmFsaWRhdGlvbkVycm9yc0RhdGFcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZmluZENvbnRyb2xSZWxhdGl2ZWx5KGNvbnRyb2w6IEFic3RyYWN0Q29udHJvbCwgcGF0aDogc3RyaW5nKSB7XHJcbiAgICAgICAgY29uc3QgcmVsYXRpdmVQYXRocyA9IHRoaXMuYnVpbGRDb250cm9sUmVsYXRpdmVQYXRoQXJyYXkocGF0aCk7XHJcblxyXG4gICAgICAgIGlmICghcmVsYXRpdmVQYXRocy5sZW5ndGgpIHJldHVybiBudWxsO1xyXG5cclxuICAgICAgICBsZXQgcmVzdWx0OiBBYnN0cmFjdENvbnRyb2w7XHJcbiAgICAgICAgcmVsYXRpdmVQYXRocy5mb3JFYWNoKHBhdGhTZWdtZW50ID0+IHtcclxuICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5nZXRDb250cm9sQnlQYXRoU2VnbWVudChyZXN1bHQgfHwgY29udHJvbCwgcGF0aFNlZ21lbnQpO1xyXG4gICAgICAgICAgICBpZiAoIXJlc3VsdCkgcmV0dXJuO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgYnVpbGRDb250cm9sUmVsYXRpdmVQYXRoQXJyYXkocmVsYXRpdmVQYXRoOiBzdHJpbmcpOiBzdHJpbmdbXSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0OiBzdHJpbmdbXSA9IFtdO1xyXG5cclxuICAgICAgICBpZiAoIXJlbGF0aXZlUGF0aCB8fCB0eXBlb2YgcmVsYXRpdmVQYXRoICE9PSBcInN0cmluZ1wiKSByZXR1cm4gcmVzdWx0O1xyXG5cclxuICAgICAgICAvLyB0YWtlcyBjYXJlIG9mICcuLycsICcuLi8nLCBhbmQgJy8nXHJcbiAgICAgICAgY29uc3Qgc2xhc2hTZXBhcmF0ZWQgPSByZWxhdGl2ZVBhdGguc3BsaXQoXCIvXCIpO1xyXG5cclxuICAgICAgICBzbGFzaFNlcGFyYXRlZC5mb3JFYWNoKHNsYXNoSXRlbSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRvdFNlcGFyYXRlZCA9IHNsYXNoSXRlbS5zcGxpdChcIi5cIilcclxuICAgICAgICAgICAgICAgIC5maWx0ZXIoZG90SXRlbSA9PiAhIWRvdEl0ZW0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKGRvdFNlcGFyYXRlZC5sZW5ndGgpXHJcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaCguLi5kb3RTZXBhcmF0ZWQpO1xyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaChzbGFzaEl0ZW0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0Q29udHJvbEJ5UGF0aFNlZ21lbnQoY29udHJvbDogQWJzdHJhY3RDb250cm9sLCBwYXRoU2VnbWVudDogc3RyaW5nKTogQWJzdHJhY3RDb250cm9sIHtcclxuICAgICAgICBzd2l0Y2ggKHBhdGhTZWdtZW50KSB7XHJcbiAgICAgICAgICAgIGNhc2UgXCJcIjpcclxuICAgICAgICAgICAgICAgIHJldHVybiBjb250cm9sLnJvb3Q7XHJcbiAgICAgICAgICAgIGNhc2UgXCIuLlwiOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbnRyb2wucGFyZW50O1xyXG4gICAgICAgICAgICBjYXNlIFwiLlwiOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbnRyb2w7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY29udHJvbC5nZXQocGF0aFNlZ21lbnQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGJ1aWxkVGVzdFJlc3VsdFN0YXRzU3RyaW5nPFQ+KHRlc3RSZXN1bHRzOiBUZXN0UmVzdWx0c0Jhc2U8VD4pIHtcclxuICAgICAgICByZXR1cm4gYEV4ZWN1dGVkICR7dGVzdFJlc3VsdHMucmVzdWx0cy5sZW5ndGh9IHRlc3RzIGAgK1xyXG4gICAgICAgICAgICBgKCR7dGVzdFJlc3VsdHMucGFzc2VkUmVzdWx0cy5sZW5ndGh9IFBBU1MgfCBgICtcclxuICAgICAgICAgICAgYCR7dGVzdFJlc3VsdHMuZmFpbGVkUmVzdWx0cy5sZW5ndGh9IEZBSUwgfCBgXHJcbiAgICAgICAgICAgICsgYCR7dGVzdFJlc3VsdHMuc2tpcHBlZFJlc3VsdHMubGVuZ3RofSBTS0lQKWA7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBhdHRhY2hNb2RlbFNldHRpbmdzVG9Gb3JtPFQ+KGZvcm1Hcm91cDogRm9ybUdyb3VwLCBtb2RlbFNldHRpbmdzOiBBYnN0cmFjdE1vZGVsU2V0dGluZ3M8VD4pOiB2b2lkIHtcclxuICAgICAgICBmb3JtR3JvdXBbUmVhY3RpdmVGb3Jtc1J1bGVTZXJ2aWNlLkZPUk1fTU9ERUxfU0VUVElOR1NfUFJPUEVSVFlfTkFNRV0gPSBtb2RlbFNldHRpbmdzO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0TW9kZWxTZXR0aW5nc0Zyb21Gb3JtPFQ+KGZvcm1Hcm91cDogRm9ybUdyb3VwKTogQWJzdHJhY3RNb2RlbFNldHRpbmdzPFQ+IHtcclxuICAgICAgICByZXR1cm4gZm9ybUdyb3VwW1JlYWN0aXZlRm9ybXNSdWxlU2VydmljZS5GT1JNX01PREVMX1NFVFRJTkdTX1BST1BFUlRZX05BTUVdIGFzIEFic3RyYWN0TW9kZWxTZXR0aW5nczxUPjtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHNldEZvcmNlQXN5bmNWYWxpZGF0aW9uVGVzdEZvckNvbnRyb2woY29udHJvbDogQWJzdHJhY3RDb250cm9sLCBmb3JjZTogYm9vbGVhbik6IHZvaWQge1xyXG4gICAgICAgIGNvbnRyb2xbUmVhY3RpdmVGb3Jtc1J1bGVTZXJ2aWNlLkZPUkNFX0FTWU5DX1ZBTElEX1RFU1RfUlVOX1BST1BFUlRZX05BTUVdID0gZm9yY2U7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzZXRMYXN0RXJyb3JGb3JDb250cm9sKGNvbnRyb2w6IEFic3RyYWN0Q29udHJvbCwgZXJyb3JzOiBSZWFjdGl2ZUZvcm1zVmFsaWRhdGlvbkVycm9yc0RhdGEpOiB2b2lkIHtcclxuICAgICAgICBjb250cm9sW1JlYWN0aXZlRm9ybXNSdWxlU2VydmljZS5DT05UUk9MX0xBU1RfRVJST1JdID0gZXJyb3JzO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0TGFzdEVycm9yRm9yQ29udHJvbChjb250cm9sOiBBYnN0cmFjdENvbnRyb2wpOiBSZWFjdGl2ZUZvcm1zVmFsaWRhdGlvbkVycm9yc0RhdGEge1xyXG4gICAgICAgIHJldHVybiBjb250cm9sW1JlYWN0aXZlRm9ybXNSdWxlU2VydmljZS5DT05UUk9MX0xBU1RfRVJST1JdO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZG9lc0NvbnRyb2xIYXZlRm9yY2VkQXN5bmNWYWxpZGF0aW9uKGNvbnRyb2w6IEFic3RyYWN0Q29udHJvbCk6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiAhIShjb250cm9sW1JlYWN0aXZlRm9ybXNSdWxlU2VydmljZS5GT1JDRV9BU1lOQ19WQUxJRF9URVNUX1JVTl9QUk9QRVJUWV9OQU1FXSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSB0cmlnZ2VyVmFsdWVDaGFuZ2UoY29udHJvbDogQWJzdHJhY3RDb250cm9sKTogdm9pZCB7XHJcbiAgICAgICAgY29udHJvbC5wYXRjaFZhbHVlKGNvbnRyb2wudmFsdWUpO1xyXG4gICAgfVxyXG59XHJcblxyXG5pbnRlcmZhY2UgQ29udHJvbENvbnRleHRWYWx1ZXMge1xyXG4gICAgcm9vdDogYW55O1xyXG4gICAgcmVsYXRpdmU6IGFueTtcclxufVxyXG5cclxuaW50ZXJmYWNlIEFzeW5jVmFsaWRhdGlvblBhc3N0aHJvdWdoYWJsZSB7XHJcbiAgICBjb250cm9sOiBBYnN0cmFjdENvbnRyb2w7XHJcbiAgICBwYXNzdGhyb3VnaDogYm9vbGVhbjtcclxufVxyXG4iLCJpbXBvcnQgeyBOZ01vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBUcmFjZVNlcnZpY2UgfSBmcm9tICcuL3RyYWNlL3RyYWNlLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBDb21tb25TZXJ2aWNlIH0gZnJvbSAnLi9jb21tb24vY29tbW9uLnNlcnZpY2UnO1xyXG5cclxuQE5nTW9kdWxlKHtcclxuICBpbXBvcnRzOiBbXSxcclxuICBkZWNsYXJhdGlvbnM6IFtdLFxyXG4gIHByb3ZpZGVyczogW1xyXG4gICAgICBUcmFjZVNlcnZpY2UsXHJcbiAgICAgIENvbW1vblNlcnZpY2VcclxuICBdXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBVdGlsc01vZHVsZSB7IH1cclxuIiwiaW1wb3J0IHsgTmdNb2R1bGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgQ29tbW9uTW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcclxuaW1wb3J0IHsgUnVsZXNFbmdpbmVTZXJ2aWNlIH0gZnJvbSAnLi9zZXJ2aWNlcy9ydWxlcy1lbmdpbmUvcnVsZXMtZW5naW5lLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBSZWFjdGl2ZUZvcm1zUnVsZVNlcnZpY2UgfSBmcm9tICcuL3NlcnZpY2VzL3JlYWN0aXZlLWZvcm1zLXJ1bGUvcmVhY3RpdmUtZm9ybXMtcnVsZS5zZXJ2aWNlJztcclxuaW1wb3J0IHsgUmVhY3RpdmVGb3Jtc01vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcclxuaW1wb3J0IHsgVXRpbHNNb2R1bGUgfSBmcm9tICcuLi91dGlscy91dGlscy5tb2R1bGUnO1xyXG5cclxuQE5nTW9kdWxlKHtcclxuICAgIGltcG9ydHM6IFtcclxuICAgICAgICBDb21tb25Nb2R1bGUsXHJcbiAgICAgICAgVXRpbHNNb2R1bGVcclxuICAgIF0sXHJcbiAgICBwcm92aWRlcnM6IFtcclxuICAgICAgICBSdWxlc0VuZ2luZVNlcnZpY2UsXHJcbiAgICAgICAgUmVhY3RpdmVGb3Jtc1J1bGVTZXJ2aWNlXHJcbiAgICBdLFxyXG4gICAgZGVjbGFyYXRpb25zOiBbXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgUnVsZXNFbmdpbmVNb2R1bGUgeyB9XHJcbiIsImltcG9ydCB7IE5nTW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IENvbW1vbk1vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XHJcbmltcG9ydCB7IFJ1bGVzRW5naW5lTW9kdWxlIH0gZnJvbSAnLi4vcnVsZXMtZW5naW5lL3J1bGVzLWVuZ2luZS5tb2R1bGUnO1xyXG5cclxuLyoqXHJcbiAqIE1haW4gbW9kdWxlIGZvciBuZy1mb3JtLXJ1bGVzXHJcbiAqL1xyXG5ATmdNb2R1bGUoe1xyXG4gIGltcG9ydHM6IFtcclxuICAgIENvbW1vbk1vZHVsZSxcclxuICAgIFJ1bGVzRW5naW5lTW9kdWxlLFxyXG4gIF0sXHJcbiAgZGVjbGFyYXRpb25zOiBbXSxcclxuICBleHBvcnRzOiBbXHJcbiAgICAgIFJ1bGVzRW5naW5lTW9kdWxlLFxyXG4gIF1cclxufSlcclxuZXhwb3J0IGNsYXNzIEZvcm1SdWxlc01vZHVsZSB7IH1cclxuIiwiaW1wb3J0IHsgUHJvcGVydHlCYXNlIH0gZnJvbSBcIi4vcHJvcGVydHktYmFzZVwiO1xyXG5cclxuLyoqXHJcbiAqIE5vbi1hcnJheSBpdGVtIHByb3BlcnR5XHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUHJvcGVydHk8VD4gZXh0ZW5kcyBQcm9wZXJ0eUJhc2U8VD4ge1xyXG4gICAgcHJpdmF0ZSBfbmFtZTogc3RyaW5nO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogTmFtZSBvZiB0aGUgcHJvcGVydHlcclxuICAgICAqL1xyXG4gICAgZ2V0IG5hbWUoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fbmFtZTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdHJ1Y3RvcihuYW1lOiBzdHJpbmcpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIHRoaXMuX25hbWUgPSBuYW1lO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IHsgUHJvcGVydHlCYXNlIH0gZnJvbSBcIi4vcHJvcGVydHktYmFzZVwiO1xyXG5cclxuLyoqXHJcbiAqIEEgcHJvcGVydHkgcmVwcmVzZW50aW5nIGFuIGFycmF5IGl0ZW0gKGUuZy4gYW4gYXJyYXkgb2YgQWRkcmVzcyBvYmplY3RzKVxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIEFycmF5SXRlbVByb3BlcnR5PFQ+IGV4dGVuZHMgUHJvcGVydHlCYXNlPFQ+IHt9IiwiaW1wb3J0IHsgUHJvcGVydHkgfSBmcm9tICcuLi9tb2RlbHMvcHJvcGVydHknO1xyXG5pbXBvcnQgeyBSdWxlR3JvdXAgfSBmcm9tICcuLi9tb2RlbHMvcnVsZS1ncm91cCc7XHJcbmltcG9ydCB7IFJ1bGUgfSBmcm9tICcuLi9tb2RlbHMvcnVsZSc7XHJcbmltcG9ydCB7IFRlc3QgfSBmcm9tICcuLi9tb2RlbHMvdGVzdCc7XHJcbmltcG9ydCB7IEFycmF5SXRlbVByb3BlcnR5IH0gZnJvbSAnLi4vbW9kZWxzL2FycmF5LWl0ZW0tcHJvcGVydHknO1xyXG5pbXBvcnQgeyBSdWxlU2V0IH0gZnJvbSAnLi4vbW9kZWxzL3J1bGUtc2V0JztcclxuaW1wb3J0IHsgUnVsZUZ1bmMgfSBmcm9tICcuLi9tb2RlbHMvcnVsZS1mdW5jJztcclxuaW1wb3J0IHsgUnVsZU9wdGlvbnMgfSBmcm9tICcuLi9tb2RlbHMvcnVsZS1vcHRpb25zJztcclxuaW1wb3J0IHsgQXN5bmNSdWxlRnVuYyB9IGZyb20gJy4uL21vZGVscy9hc3luYy1ydWxlLWZ1bmMnO1xyXG5pbXBvcnQgeyBSdWxlR3JvdXBPcHRpb25zIH0gZnJvbSAnLi4vbW9kZWxzL3J1bGUtZ3JvdXAtb3B0aW9ucyc7XHJcbmltcG9ydCB7IFJlc3VsdHNQYXNzUmVxdWlyZW1lbnQgfSBmcm9tICcuLi9tb2RlbHMvcmVzdWx0cy1wYXNzLXJlcXVpcmVtZW50JztcclxuXHJcbi8qKlxyXG4gKiBVdGlsaXR5IGNsYXNzIGZvciBidWlsZGluZyBtb2RlbCBzZXR0aW5nc1xyXG4gKi9cclxuZXhwb3J0IGNsYXNzIE1vZGVsU2V0dGluZ3NCdWlsZGVyIHtcclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhIHByb3BlcnR5XHJcbiAgICAgKiBAcGFyYW0gcHJvcGVydHlOYW1lIFByb3BlcnR5IG5hbWVcclxuICAgICAqIEBwYXJhbSBleHRlbmQgRnVuY3Rpb24gdG8gZXh0ZW5kIHRoZSBwcm9wZXJ0eVxyXG4gICAgICogQHJldHVybnMgQ3JlYXRlZCBwcm9wZXJ0eVxyXG4gICAgICovXHJcbiAgICBwcm9wZXJ0eTxUPihwcm9wZXJ0eU5hbWU6IGtleW9mIFQsIGV4dGVuZD86IChwcm9wOiBQcm9wZXJ0eTxUPikgPT4gdm9pZCk6IFByb3BlcnR5PFQ+IHtcclxuICAgICAgICBpZiAoIXByb3BlcnR5TmFtZSB8fCB0eXBlb2YgcHJvcGVydHlOYW1lICE9PSAnc3RyaW5nJykgdGhyb3cgRXJyb3IoJ0ludmFsaWQgcHJvcGVydHkgbmFtZScpO1xyXG5cclxuICAgICAgICBjb25zdCBwcm9wZXJ0eSA9IG5ldyBQcm9wZXJ0eTxUPihwcm9wZXJ0eU5hbWUpO1xyXG5cclxuICAgICAgICBpZiAoZXh0ZW5kKSBleHRlbmQocHJvcGVydHkpO1xyXG5cclxuICAgICAgICByZXR1cm4gcHJvcGVydHk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGFuIGFycmF5IGl0ZW0gcHJvcGVydHlcclxuICAgICAqIEBwYXJhbSBleHRlbmQgRnVuY3Rpb24gdG8gZXh0ZW5kIHRoZSBhcnJheSBpdGVtIHByb3BlcnR5XHJcbiAgICAgKiBAcmV0dXJucyBDcmVhdGVkIGFycmF5IGl0ZW0gcHJvcGVydHlcclxuICAgICAqL1xyXG4gICAgYXJyYXlJdGVtUHJvcGVydHk8VD4oZXh0ZW5kPzogKHByb3A6IEFycmF5SXRlbVByb3BlcnR5PFQ+KSA9PiB2b2lkKTogQXJyYXlJdGVtUHJvcGVydHk8VD4ge1xyXG4gICAgICAgIGNvbnN0IHByb3BlcnR5ID0gbmV3IEFycmF5SXRlbVByb3BlcnR5PFQ+KCk7XHJcblxyXG4gICAgICAgIGlmIChleHRlbmQpIGV4dGVuZChwcm9wZXJ0eSk7XHJcblxyXG4gICAgICAgIHJldHVybiBwcm9wZXJ0eTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYSB2YWxpZGF0aW9uIHRlc3RcclxuICAgICAqIEBwYXJhbSBtZXNzYWdlIE1lc3NhZ2Ugd2hlbiB0aGUgdGVzdCBmYWlsc1xyXG4gICAgICogQHBhcmFtIGNoZWNrIENoZWNrIHJ1bGUgc2V0IGZvciB0aGUgdGVzdFxyXG4gICAgICogQHBhcmFtIGNvbmRpdGlvbiBDb25kaXRpb24gcnVsZSBzZXQgZm9yIHRoZSB0ZXN0XHJcbiAgICAgKiBAcmV0dXJucyBDcmVhdGVkIHZhbGlkYXRpb24gdGVzdFxyXG4gICAgICovXHJcbiAgICB2YWxpZFRlc3Q8VD4obWVzc2FnZTogc3RyaW5nLCBjaGVjazogUnVsZVNldDxUPiwgY29uZGl0aW9uPzogUnVsZVNldDxUPik6IFRlc3Q8VD4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnZhbGlkTmFtZWRUZXN0KG51bGwsIG1lc3NhZ2UsIGNoZWNrLCBjb25kaXRpb24pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhIG5hbWVkIHZhbGlkYXRpb24gdGVzdFxyXG4gICAgICogQHBhcmFtIG5hbWUgTmFtZSBvZiB0aGUgdGVzdFxyXG4gICAgICogQHBhcmFtIG1lc3NhZ2UgTWVzc2FnZSB3aGVuIHRoZSB0ZXN0IGZhaWxzXHJcbiAgICAgKiBAcGFyYW0gY2hlY2sgQ2hlY2sgcnVsZSBzZXQgZm9yIHRoZSB0ZXN0XHJcbiAgICAgKiBAcGFyYW0gY29uZGl0aW9uIENvbmRpdGlvbiBydWxlIHNldCBmb3IgdGhlIHRlc3RcclxuICAgICAqIEByZXR1cm5zIENyZWF0ZWQgbmFtZWQgdmFsaWRhdGlvbiB0ZXN0XHJcbiAgICAgKi9cclxuICAgIHZhbGlkTmFtZWRUZXN0PFQ+KG5hbWU6IHN0cmluZywgbWVzc2FnZTogc3RyaW5nLCBjaGVjazogUnVsZVNldDxUPiwgY29uZGl0aW9uPzogUnVsZVNldDxUPik6IFRlc3Q8VD4ge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIG5hbWU6IG5hbWUsXHJcbiAgICAgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXHJcbiAgICAgICAgICAgIGNoZWNrOiBjaGVjayxcclxuICAgICAgICAgICAgY29uZGl0aW9uOiBjb25kaXRpb25cclxuICAgICAgICB9IGFzIFRlc3Q8VD47XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGFuIGVkaXQgdGVzdFxyXG4gICAgICogQHBhcmFtIGNoZWNrIENoZWNrIHJ1bGUgc2V0IGZvciB0aGUgdGVzdFxyXG4gICAgICogQHBhcmFtIGNvbmRpdGlvbiBDb25kaXRpb24gcnVsZSBzZXQgZm9yIHRoZSB0ZXN0XHJcbiAgICAgKiBAcmV0dXJucyBDcmVhdGVkIGVkaXQgdGVzdFxyXG4gICAgICovXHJcbiAgICBlZGl0VGVzdDxUPihjaGVjazogUnVsZVNldDxUPiwgY29uZGl0aW9uPzogUnVsZVNldDxUPik6IFRlc3Q8VD4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmVkaXROYW1lZFRlc3QobnVsbCwgY2hlY2ssIGNvbmRpdGlvbik7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGEgbmFtZWQgZWRpdCB0ZXN0XHJcbiAgICAgKiBAcGFyYW0gbmFtZSBOYW1lIG9mIHRoZSB0ZXN0XHJcbiAgICAgKiBAcGFyYW0gY2hlY2sgQ2hlY2sgcnVsZSBzZXQgZm9yIHRoZSB0ZXN0XHJcbiAgICAgKiBAcGFyYW0gY29uZGl0aW9uIENvbmRpdGlvbiBydWxlIHNldCBmb3IgdGhlIHRlc3RcclxuICAgICAqIEByZXR1cm5zIENyZWF0ZWQgbmFtZWQgZWRpdCB0ZXN0XHJcbiAgICAgKi9cclxuICAgIGVkaXROYW1lZFRlc3Q8VD4obmFtZTogc3RyaW5nLCBjaGVjazogUnVsZVNldDxUPiwgY29uZGl0aW9uPzogUnVsZVNldDxUPik6IFRlc3Q8VD4ge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIG5hbWU6IG5hbWUsXHJcbiAgICAgICAgICAgIGNoZWNrOiBjaGVjayxcclxuICAgICAgICAgICAgY29uZGl0aW9uOiBjb25kaXRpb25cclxuICAgICAgICB9IGFzIFRlc3Q8VD47XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGEgcnVsZVxyXG4gICAgICogQHBhcmFtIGZ1bmMgRnVuY3Rpb24gZm9yIHRoZSBydWxlXHJcbiAgICAgKiBAcGFyYW0gb3B0aW9ucyBBZGRpdGlvbmFsIHJ1bGUgb3B0aW9uc1xyXG4gICAgICogQHJldHVybnMgQ3JlYXRlZCBydWxlXHJcbiAgICAgKi9cclxuICAgIHJ1bGU8VCwgUj4oZnVuYzogUnVsZUZ1bmM8VCwgUj4sIG9wdGlvbnM/OiBSdWxlT3B0aW9ucyk6IFJ1bGU8VD4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJ1bGVDb21ibyhmdW5jLCBudWxsLCBvcHRpb25zKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYW4gYXN5bmMgcnVsZVxyXG4gICAgICogQHBhcmFtIGFzeW5jRnVuYyBBc3luYyBmdW5jdGlvbiBmb3IgdGhlIHJ1bGVcclxuICAgICAqIEBwYXJhbSBvcHRpb25zIEFkZGl0aW9uYWwgcnVsZSBvcHRpb25zXHJcbiAgICAgKiBAcmV0dXJucyBDcmVhdGVkIHJ1bGVcclxuICAgICAqL1xyXG4gICAgcnVsZUFzeW5jPFQsIFI+KGFzeW5jRnVuYzogQXN5bmNSdWxlRnVuYzxULCBSPiwgb3B0aW9ucz86IFJ1bGVPcHRpb25zKTogUnVsZTxUPiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucnVsZUNvbWJvKG51bGwsIGFzeW5jRnVuYywgb3B0aW9ucyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGEgY29tYm8gcnVsZSB0aGF0IGhhcyBib3RoIHN5bmNyb25vdXMgYW5kIGFzeW5jIGZ1bmN0aW9uc1xyXG4gICAgICogQHBhcmFtIGZ1bmMgRnVuY3Rpb24gZm9yIHRoZSBydWxlXHJcbiAgICAgKiBAcGFyYW0gYXN5bmNGdW5jIEFzeW5jIGZ1bmN0aW9uIGZvciB0aGUgcnVsZVxyXG4gICAgICogQHBhcmFtIG9wdGlvbnMgQWRkaXRpb25hbCBydWxlIG9wdGlvbnNcclxuICAgICAqIEByZXR1cm5zIENyZWF0ZWQgcnVsZVxyXG4gICAgICovXHJcbiAgICBydWxlQ29tYm88VCwgUj4oZnVuYzogUnVsZUZ1bmM8VCwgUj4sIGFzeW5jRnVuYzogQXN5bmNSdWxlRnVuYzxULCBSPiwgb3B0aW9ucz86IFJ1bGVPcHRpb25zKTogUnVsZTxUPiB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgZnVuYzogZnVuYyxcclxuICAgICAgICAgICAgYXN5bmNGdW5jOiBhc3luY0Z1bmMsXHJcbiAgICAgICAgICAgIG9wdGlvbnM6IG9wdGlvbnNcclxuICAgICAgICB9IGFzIFJ1bGU8VD47XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGEgcnVsZSBncm91cFxyXG4gICAgICogQHBhcmFtIHJ1bGVTZXRzIFJ1bGUgc2V0cyBmb3IgdGhlIHJ1bGUgZ3JvdXBcclxuICAgICAqIEBwYXJhbSBvcHRpb25zIEFkZGl0aW9uYWwgcnVsZSBncm91cCBvcHRpb25zXHJcbiAgICAgKiBAcmV0dXJucyBDcmVhdGVkIHJ1bGUgZ3JvdXBcclxuICAgICAqL1xyXG4gICAgcnVsZUdyb3VwPFQ+KHJ1bGVTZXRzOiBSdWxlU2V0PFQ+W10sIG9wdGlvbnM/OiBSdWxlR3JvdXBPcHRpb25zKTogUnVsZUdyb3VwPFQ+IHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBydWxlczogcnVsZVNldHMsXHJcbiAgICAgICAgICAgIG9wdGlvbnM6IG9wdGlvbnMgfHwgeyByZXN1bHRSZXF1aXJlbWVudHM6IFJlc3VsdHNQYXNzUmVxdWlyZW1lbnQuQWxsUGFzcyB9XHJcbiAgICAgICAgfSBhcyBSdWxlR3JvdXA8VD47XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgeyBNb2RlbFNldHRpbmdzQnVpbGRlciB9IGZyb20gXCIuLi9oZWxwZXIvbW9kZWwtc2V0dGluZ3MtYnVpbGRlclwiO1xyXG5pbXBvcnQgeyBQcm9wZXJ0eSB9IGZyb20gXCIuL3Byb3BlcnR5XCI7XHJcblxyXG4vKipcclxuICogQmFzZSBjbGFzcyBmb3IgbW9kZWwgc2V0dGluZ3NcclxuICovXHJcbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBBYnN0cmFjdE1vZGVsU2V0dGluZ3M8VD4ge1xyXG4gICAgcHJpdmF0ZSBfbmFtZTogc3RyaW5nO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogTmFtZSBvZiB0aGUgbW9kZWwgc2V0dGluZ1xyXG4gICAgICovXHJcbiAgICBnZXQgbmFtZSgpOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9uYW1lO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogSGVscGVyIGZvciBidWlsZGluZyBwcm9wZXJ0aWVzLCB0ZXN0cywgYW5kIHJ1bGVzXHJcbiAgICAgKi9cclxuICAgIHByb3RlY3RlZCBidWlsZGVyOiBNb2RlbFNldHRpbmdzQnVpbGRlcjtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFByb3BlcnRpZXMgY29uZmlndXJlZCBmb3IgdGhlIG1vZGVsIHNldHRpbmdzXHJcbiAgICAgKi9cclxuICAgIHByb3BlcnRpZXM6IFByb3BlcnR5PFQ+W107XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIG1vZGVsIHNldHRpbmdzXHJcbiAgICAgKiBAcGFyYW0gbmFtZSBOYW1lIG9mIHRoZSBtb2RlbCBzZXR0aW5nc1xyXG4gICAgICovXHJcbiAgICBjb25zdHJ1Y3RvcihuYW1lOiBzdHJpbmcpIHtcclxuICAgICAgICB0aGlzLmJ1aWxkZXIgPSBuZXcgTW9kZWxTZXR0aW5nc0J1aWxkZXIoKTtcclxuICAgICAgICB0aGlzLl9uYW1lID0gbmFtZTtcclxuICAgICAgICB0aGlzLnByb3BlcnRpZXMgPSB0aGlzLmJ1aWxkUHJvcGVydGllcygpIHx8IFtdO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQWJzdHJhY3QgZnVuY3Rpb24gZm9yIGJ1aWxkaW5nIHRoZSBwcm9wZXJ0aWVzXHJcbiAgICAgKi9cclxuICAgIHByb3RlY3RlZCBhYnN0cmFjdCBidWlsZFByb3BlcnRpZXMoKTogUHJvcGVydHk8VD5bXTtcclxufSIsImltcG9ydCB7IFRlc3RSZXN1bHRzQmFzZSB9IGZyb20gXCIuL3Rlc3QtcmVzdWx0cy1iYXNlXCI7XHJcbmltcG9ydCB7IFRlc3RSZXN1bHQgfSBmcm9tIFwiLi90ZXN0LXJlc3VsdFwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFByb3BlcnR5VGVzdFJlc3VsdHM8VD4gZXh0ZW5kcyBUZXN0UmVzdWx0c0Jhc2U8VD4ge1xyXG4gICAgY29uc3RydWN0b3IocHVibGljIHByb3BlcnR5TmFtZTogc3RyaW5nLCByZXN1bHRzOiBUZXN0UmVzdWx0PFQ+W10pIHtcclxuICAgICAgICBzdXBlcihyZXN1bHRzKTtcclxuICAgIH1cclxufSIsImltcG9ydCB7IEFic3RyYWN0TW9kZWxTZXR0aW5ncyB9IGZyb20gXCIuL2Fic3RyYWN0LW1vZGVsLXNldHRpbmdzXCI7XHJcbmltcG9ydCB7IE1vZGVsU2V0dGluZ3NCdWlsZGVyIH0gZnJvbSBcIi4uL2hlbHBlci9tb2RlbC1zZXR0aW5ncy1idWlsZGVyXCI7XHJcbmltcG9ydCB7IFByb3BlcnR5IH0gZnJvbSBcIi4vcHJvcGVydHlcIjtcclxuXHJcbi8qKlxyXG4gKiBDbGFzcyBmb3IgY3JlYXRpbmcgYWRob2MgKG5vbi1yZWdpc3RlcmVkKSBtb2RlbCBzZXR0aW5nc1xyXG4gKi9cclxuZXhwb3J0IGNsYXNzIEFkaG9jTW9kZWxTZXR0aW5nczxUPiBleHRlbmRzIEFic3RyYWN0TW9kZWxTZXR0aW5nczxUPiB7XHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgbW9kZWwgc2V0dGluZ3NcclxuICAgICAqIEBwYXJhbSBwcm9wZXJ0eUJ1aWxkZXJGdW5jIEZ1bmN0aW9uIHRoYXQgdGFrZXMgYSBNb2RlbFNldHRpbmdzQnVpbGRlciBhbmQgdXNlcyBpdCB0byByZXR1cm4gYW4gYXJyYXkgb2YgcHJvcGVydGllc1xyXG4gICAgICogQHJldHVybnMgTW9kZWwgc2V0dGluZ3MgY29uZmlndXJlZCB3aXRoIHByb3BlcnRpZXMgcmV0dXJuZWQgZnJvbSB0aGUgJ3Byb3BlcnR5QnVpbGRlckZ1bmMnIGZ1bmN0aW9uIHBhcmFtZXRlclxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgY3JlYXRlPFQ+KHByb3BlcnR5QnVpbGRlckZ1bmM6IChidWlsZGVyOiBNb2RlbFNldHRpbmdzQnVpbGRlcikgPT4gUHJvcGVydHk8VD5bXSk6IEFic3RyYWN0TW9kZWxTZXR0aW5nczxUPiB7XHJcbiAgICAgICAgY29uc3QgaW5zdGFuY2UgPSBuZXcgQWRob2NNb2RlbFNldHRpbmdzKCk7XHJcbiAgICAgICAgaW5zdGFuY2UucHJvcGVydGllcyA9ICEhcHJvcGVydHlCdWlsZGVyRnVuYyA/IHByb3BlcnR5QnVpbGRlckZ1bmMoaW5zdGFuY2UuYnVpbGRlcikgfHwgW10gOiBbXTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGluc3RhbmNlO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgLy8gc2luY2UgdGhlc2Ugc2V0dGluZ3MgYXJlIG5vdCByZWdpc3RlcmVkLCBqdXN0IHVzZSBhIHN0YXRpYyBuYW1lXHJcbiAgICAgICAgc3VwZXIoJ2FkaG9jJyk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIGJ1aWxkUHJvcGVydGllcygpOiBQcm9wZXJ0eTxUPltdIHtcclxuICAgICAgICAvLyB0aGlzIGlzIGp1c3QgbmVlZGVkIHRvIHNhdGlzZnkgdGhlIEFic3RyYWN0TW9kZWxTZXR0aW5nczxUPiBjb250cmFjdFxyXG4gICAgICAgIHJldHVybiBbXTtcclxuICAgIH1cclxufSIsIi8qKlxyXG4gKiBPcHRpb25zIGZvciBob3cgYW5kIHdoZW4gdG8gcHJvY2VzcyB2YWx1ZSBjaGFuZ2VzIGluIGEgZm9ybSBjb250cm9sXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgVmFsdWVDaGFuZ2VPcHRpb25zIHtcclxuICAgIC8qKlxyXG4gICAgICogQ29uc2lkZXIgdmFsdWUgY2hhbmdlZCBvbmx5IGlmIGl0IGlzIGRpZmZlcmVudFxyXG4gICAgICovXHJcbiAgICBkaXN0aW5jdFVudGlsQ2hhbmdlZD86IGJvb2xlYW47XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBNaWxsaXNlY29uZHMgdG8gZGVib3VuY2UgdmFsdWUgY2hhbmdlc1xyXG4gICAgICovXHJcbiAgICBkZWJvdW5jZU1pbGxpc2Vjb25kcz86IG51bWJlcjtcclxufSJdLCJuYW1lcyI6WyJJbmplY3Rpb25Ub2tlbiIsIkluamVjdGFibGUiLCJPcHRpb25hbCIsIkluamVjdCIsIm1hcCIsIm9mIiwiZm9ya0pvaW4iLCJtZXJnZU1hcCIsInRha2UiLCJmbGF0TWFwIiwidHNsaWJfMS5fX3NwcmVhZCIsIkZvcm1Db250cm9sIiwiRm9ybUdyb3VwIiwiRm9ybUFycmF5IiwiQmVoYXZpb3JTdWJqZWN0Iiwic3dpdGNoTWFwIiwidGFwIiwiZGVib3VuY2UiLCJ0aW1lciIsIkVNUFRZIiwiZGlzdGluY3RVbnRpbENoYW5nZWQiLCJGb3JtQnVpbGRlciIsIk5nTW9kdWxlIiwiQ29tbW9uTW9kdWxlIiwidHNsaWJfMS5fX2V4dGVuZHMiXSwibWFwcGluZ3MiOiI7Ozs7OztJQUFBOzs7Ozs7Ozs7Ozs7OztJQWNBO0lBRUEsSUFBSSxhQUFhLEdBQUcsTUFBTSxDQUFDLGNBQWM7U0FDcEMsRUFBRSxTQUFTLEVBQUUsRUFBRSxFQUFFLFlBQVksS0FBSyxJQUFJLFVBQVUsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFD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