{"version":3,"file":"ng-form-rules.umd.js.map","sources":[null,"ng://ng-form-rules/lib/form-rules/injection-tokens/model-settings.token.ts","ng://ng-form-rules/lib/form-rules/injection-tokens/trace-settings.token.ts","ng://ng-form-rules/lib/utils/trace/trace.service.ts","ng://ng-form-rules/lib/utils/common/common.service.ts","ng://ng-form-rules/lib/form-rules/models/test-results-base.ts","ng://ng-form-rules/lib/form-rules/models/property-base.ts","ng://ng-form-rules/lib/rules-engine/services/rules-engine/rules-engine.service.ts","ng://ng-form-rules/lib/form-rules/models/control-state.ts","ng://ng-form-rules/lib/rules-engine/services/reactive-forms-rule/reactive-forms-rule.service.ts","ng://ng-form-rules/lib/utils/utils.module.ts","ng://ng-form-rules/lib/rules-engine/rules-engine.module.ts","ng://ng-form-rules/lib/form-rules/form-rules.module.ts","ng://ng-form-rules/lib/form-rules/models/property.ts","ng://ng-form-rules/lib/form-rules/models/array-item-property.ts","ng://ng-form-rules/lib/form-rules/helper/model-settings-builder.ts","ng://ng-form-rules/lib/form-rules/models/abstract-model-settings.ts","ng://ng-form-rules/lib/form-rules/models/property-test-result.ts","ng://ng-form-rules/lib/form-rules/models/adhoc-model-settings.ts","ng://ng-form-rules/lib/form-rules/models/value-change-options.ts"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = Object.setPrototypeOf ||\r\n    ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n    function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = Object.assign || function __assign(t) {\r\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n        s = arguments[i];\r\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n    }\r\n    return t;\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n            t[p[i]] = s[p[i]];\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [0, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r);  }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { if (o[n]) i[n] = function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; }; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator];\r\n    return m ? m.call(o) : typeof __values === \"function\" ? __values(o) : o[Symbol.iterator]();\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","import { InjectionToken } from \"@angular/core\";\r\n\r\n/**\r\n * Injection token for providing an array of model settings\r\n */\r\nexport let MODEL_SETTINGS_TOKEN = new InjectionToken<string>('ngfr.model-settings');","import { InjectionToken } from \"@angular/core\";\r\n\r\n/**\r\n * Injection token for enabling ng-form-rules tracing\r\n */\r\nexport let TRACE_SETTINGS_TOKEN = new InjectionToken<string>('ngfr.trace-settings');","import { Injectable, Inject, Optional } from '@angular/core';\r\nimport { TRACE_SETTINGS_TOKEN } from '../../form-rules/injection-tokens/trace-settings.token';\r\n\r\n@Injectable()\r\nexport class TraceService {\r\n    constructor(\r\n        @Optional() @Inject(TRACE_SETTINGS_TOKEN) private doTrace: boolean = false\r\n    ) {\r\n    }\r\n\r\n    trace(msg: string) {\r\n        if (!this.doTrace) return;\r\n\r\n        const fullMsg = `[NGFR - ${this.getTimeStamp()}] ${msg}`;\r\n        console.log(fullMsg);\r\n    }\r\n\r\n    private getTimeStamp(): string {\r\n        return (new Date).toLocaleTimeString();\r\n    }\r\n}\r\n","import { Injectable } from '@angular/core';\r\n\r\n@Injectable()\r\nexport class CommonService {\r\n    /**\r\n     * Gets unique values from an array\r\n     * @param values Values to get unique items from\r\n     * @returns Unique values array\r\n     */\r\n    unique(values: any[]): any[] {\r\n        if (!Array.isArray(values)) return [];\r\n\r\n        return Array.from(new Set(values));\r\n    }\r\n\r\n    /**\r\n     * Determines if number is zero or greater\r\n     * @param value If number is greater than or equal zero\r\n     */\r\n    isZeroOrGreater(value: number): boolean {\r\n        if (!value && value === 0) return true;\r\n\r\n        if (!value || typeof value !== \"number\") return false;\r\n\r\n        return value > 0;\r\n    }\r\n}\r\n","import { TestResult } from \"./test-result\";\r\n\r\n/**\r\n * Results of executing a collection of tests\r\n */\r\nexport class TestResultsBase<T> {\r\n    constructor(public results: TestResult<T>[]) {\r\n        this.results = this.results || [];\r\n    }\r\n\r\n    /**\r\n     * Whether the tests passed\r\n     */\r\n    get passed(): boolean {\r\n        return !this.failedResults.length;\r\n    }\r\n\r\n    /**\r\n     * Array of test results that passed\r\n     */\r\n    get passedResults(): TestResult<T>[] {\r\n        return this.results.filter(x => !!x.passed && !x.skipped);\r\n    }\r\n\r\n    /**\r\n     * Array of test results that failed\r\n     */\r\n    get failedResults(): TestResult<T>[] {\r\n        return this.results.filter(x => !x.passed);\r\n    }\r\n\r\n    /**\r\n     * Array of test results that were skipped\r\n     */\r\n    get skippedResults(): TestResult<T>[] {\r\n        return this.results.filter(x => !!x.skipped);\r\n    }\r\n\r\n    /**\r\n     * Message of the first test that failed\r\n     */\r\n    get message(): string {\r\n        return this.messages[0];\r\n    }\r\n\r\n    /**\r\n     * Messages of all failed tests\r\n     */\r\n    get messages(): string[] {\r\n        const messages = this.failedResults.map(x => x.message);\r\n        return Array.from(new Set(messages));\r\n    }\r\n}","import { Test } from \"./test\";\r\nimport { Property } from \"./property\";\r\nimport { ArrayItemProperty } from \"./array-item-property\";\r\nimport { Subscription } from \"rxjs\";\r\nimport { ValueChangeOptions } from \"./value-change-options\";\r\nimport { UpdateOn } from \"./update-on\";\r\n\r\n/**\r\n * Base class for a property\r\n */\r\nexport abstract class PropertyBase<T> {\r\n    private _absolutePath: string;\r\n    private _dependencyPropertySubscriptions: Subscription[] = [];\r\n    private _ownerModelSettingsName: string;\r\n\r\n    /**\r\n     * Validation tests\r\n     */\r\n    valid: Test<T>[] = [];\r\n\r\n    /**\r\n     * Editability tests\r\n     */\r\n    edit: Test<T>[] = [];\r\n\r\n    /**\r\n     * Viewability tests\r\n     */\r\n    // view: Test<T>[] = [];\r\n\r\n    /**\r\n     * Properties for a complex object\r\n     */\r\n    properties?: Property<any>[];\r\n\r\n    /**\r\n     * Property for an item of an array\r\n     */\r\n    arrayItemProperty?: ArrayItemProperty<any>;\r\n\r\n    /**\r\n     * The event name for control to update upon.\r\n     */\r\n    updateOn?: UpdateOn = 'change';\r\n\r\n    /**\r\n     * Absolute path to the property from root\r\n     */\r\n    get absolutePath(): string {\r\n        return this._absolutePath;\r\n    }\r\n\r\n    /**\r\n     * Absolute path to property from root\r\n     */\r\n    get dependencyPropertySubscriptions(): Subscription[] {\r\n        return this._dependencyPropertySubscriptions;\r\n    }\r\n\r\n    /**\r\n     * Absolute path to property from root\r\n     */\r\n    get ownerModelSettingsName(): string {\r\n        return this._ownerModelSettingsName;\r\n    }\r\n\r\n    /**\r\n     * Options for how to respond to value changes on property control and dependency controls\r\n     */\r\n    valueChangeOptions: {\r\n        dependencyProperties: {\r\n            valid: ValueChangeOptions,\r\n            edit: ValueChangeOptions\r\n        },\r\n        self: {\r\n            asyncValid: ValueChangeOptions,\r\n            edit: ValueChangeOptions\r\n        }\r\n    } = {\r\n        dependencyProperties: {\r\n            valid: { distinctUntilChanged: false, debounceMilliseconds: 0 },\r\n            edit: { distinctUntilChanged: false, debounceMilliseconds: 0 }\r\n        },\r\n        self: {\r\n            asyncValid: { distinctUntilChanged: false, debounceMilliseconds: 0 },\r\n            edit: { distinctUntilChanged: false, debounceMilliseconds: 0 }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Determines if the property is an ArrayItemProperty\r\n     * @param property Property to check\r\n     * @returns Whether or not the property is an ArrayItemProperty\r\n     */\r\n    static isArrayItemProperty<T>(property: PropertyBase<T>): boolean {\r\n        return !(property as Property<T>).name;\r\n    }\r\n\r\n    /**\r\n     * DO NOT CALL! Internal use only\r\n     * @param absolutePath Absolute path to the property from the root\r\n     */\r\n    setAbsolutePath(absolutePath: string): void {\r\n        this._absolutePath = absolutePath;\r\n    }\r\n\r\n    /**\r\n     * DO NOT CALL! Internal use only\r\n     * @param subscription Subscription for the dependency property\r\n     */\r\n    addDependencyPropertySubscription(subscription: Subscription): void {\r\n        this._dependencyPropertySubscriptions.push(subscription);\r\n    }\r\n\r\n    /**\r\n     * DO NOT CALL! Internal use only\r\n     */\r\n    clearDependencyPropertySubscriptions(): void {\r\n        this.dependencyPropertySubscriptions.forEach(sub$ => sub$.unsubscribe());\r\n        this._dependencyPropertySubscriptions = [];\r\n    }\r\n\r\n    /**\r\n     * DO NOT CALL! Internal use only\r\n     * @param name Name of the owner model settings\r\n     */\r\n    setOwnerModelSettingsName(name: string): void {\r\n        this._ownerModelSettingsName = name;\r\n    }\r\n}","import { Injectable, Inject, Optional } from '@angular/core';\r\nimport { MODEL_SETTINGS_TOKEN } from '../../../form-rules/injection-tokens/model-settings.token';\r\nimport { AbstractModelSettings } from '../../../form-rules/models/abstract-model-settings';\r\nimport { Property } from '../../../form-rules/models/property';\r\nimport { RuleGroup } from '../../../form-rules/models/rule-group';\r\nimport { Rule } from '../../../form-rules/models/rule';\r\nimport { Test } from '../../../form-rules/models/test';\r\nimport { TestResult } from '../../../form-rules/models/test-result';\r\nimport { RuleSet } from '../../../form-rules/models/rule-set';\r\nimport { TestRunState } from '../../../form-rules/models/test-run-state';\r\nimport { TraceService } from '../../../utils/trace/trace.service';\r\nimport { CommonService } from '../../../utils/common/common.service';\r\nimport { Observable, forkJoin, of } from 'rxjs';\r\nimport {  map, flatMap, mergeMap, take, tap } from 'rxjs/operators';\r\nimport { TestResultsBase } from '../../../form-rules/models/test-results-base';\r\nimport { PropertyTestResults } from '../../../form-rules/models/property-test-result';\r\nimport { PropertyBase } from '../../../form-rules/models/property-base';\r\nimport { ProcessResultType } from '../../../form-rules/models/proccess-result-type';\r\nimport { TestSyncGroups } from '../../../form-rules/models/test-sync-groups';\r\nimport { ResultsPassRequirement } from '../../../form-rules/models/results-pass-requirement';\r\n\r\n/**\r\n * Engine that digests model settings and applies their rules appropriately\r\n */\r\n@Injectable()\r\nexport class RulesEngineService {\r\n    private registeredSettings: { [key: string]: AbstractModelSettings<any>; };\r\n\r\n    constructor(\r\n        @Optional() @Inject(MODEL_SETTINGS_TOKEN) settings: AbstractModelSettings<any>[],\r\n        private traceSvc: TraceService,\r\n        private commonSvc: CommonService\r\n    ) {\r\n        this.registeredSettings = {};\r\n\r\n        if (!Array.isArray(settings)) return;\r\n\r\n        settings.forEach(setting => {\r\n            this.initializeModelSetting(setting);\r\n            this.registeredSettings[setting.name] = setting;\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Initializes model settings and prepares them to be used in a form group\r\n     * @param setting Model setting to initialize\r\n     */\r\n    initializeModelSetting(setting: AbstractModelSettings<any>): void {\r\n        this.traceSvc.trace(`Initializing model settings \"${setting.name}\"`);\r\n        this.setPropertyMetadata(setting.properties, setting.name);\r\n    }\r\n\r\n    /**\r\n     * Gets model settings with the provided name\r\n     * @param name Name of model setting\r\n     * @returns Model settings with the provided name\r\n     */\r\n    getModelSettings<T>(name: string): AbstractModelSettings<T> {\r\n        this.traceSvc.trace(`Retrieving model settings \"${name}\"`);\r\n\r\n        const settings = this.registeredSettings[name];\r\n\r\n        // create new object\r\n        return settings\r\n            ? Object.assign({}, this.registeredSettings[name])\r\n            : null;\r\n    }\r\n\r\n    /**\r\n     * Gets the dependency properties for an array of tests\r\n     * @param tests Tests to get the dependency properties for\r\n     * @returns Dependency properties\r\n     */\r\n    getDependencyProperties<T>(tests: Test<T>[]): string[] {\r\n        if (!tests) return [];\r\n\r\n        const deps = tests\r\n            .map(t => this.getDependencyPropertiesFromTest(t))\r\n            .reduce((prev, current) => prev.concat(current), []);\r\n\r\n        return this.commonSvc.unique(deps);\r\n    }\r\n\r\n    /**\r\n     * Gets tests grouped by their sync type (e.g. sync vs. async)\r\n     * @param tests Test to groups\r\n     * @returns Tests grouped by sync type\r\n     */\r\n    groupTestsBySyncType<T>(tests: Test<T>[]): TestSyncGroups<T> {\r\n        const testGroups = {\r\n            sync: [],\r\n            async: []\r\n        } as TestSyncGroups<T>;\r\n\r\n        if (!tests) return testGroups;\r\n\r\n        tests.forEach(test => {\r\n            const testFuncTypes = {\r\n                sync: false,\r\n                async: false\r\n            } as ConfiguredFuncTypes;\r\n\r\n            const conditionResults = this.getConfiguredFuncTypes(test.condition);\r\n            const checkResults = this.getConfiguredFuncTypes(test.check);\r\n\r\n            testFuncTypes.sync = conditionResults.sync || checkResults.sync;\r\n            testFuncTypes.async = conditionResults.async || checkResults.async;\r\n\r\n            // if there is an async func anywhere in the test's rule sets, then it is considered an async test\r\n            if (testFuncTypes.sync && !testFuncTypes.async) testGroups.sync.push(test);\r\n            if (testFuncTypes.async) testGroups.async.push(test);\r\n        });\r\n\r\n        return testGroups;\r\n    }\r\n\r\n    /**\r\n     * Runs validation tests\r\n     * @param data Data to run validation tests against\r\n     * @param property Property to run validation tests for\r\n     * @returns Results of validation tests\r\n     */\r\n    validate<T>(data: T, property: Property<T>, state?: TestRunState): Observable<PropertyTestResults<T>> {\r\n        return this.runAllTests(data, property.valid, state)\r\n            .pipe(\r\n                map((results: PropertyTestResults<T>) => {\r\n                    results.propertyName = property.absolutePath;\r\n                    return results as PropertyTestResults<T>;\r\n                })\r\n            );\r\n    }\r\n\r\n    /**\r\n     * Runs editability tests\r\n     * @param data Data to run editability tests against\r\n     * @param property Property to run editability tests for\r\n     * * @returns Results of editability tests\r\n     */\r\n    editable<T>(data: T, property: PropertyBase<T>, state?: TestRunState): Observable<PropertyTestResults<T>> {\r\n        return this.runAllTests(data, property.edit, state)\r\n            .pipe(\r\n                map((results: PropertyTestResults<T>) => {\r\n                    results.propertyName = property.absolutePath;\r\n                    return results as PropertyTestResults<T>;\r\n                })\r\n            );\r\n    }\r\n\r\n    /**\r\n     * Runs visibility tests\r\n     * @param data Data to run visibility tests against\r\n     * @param property Property to run visibility tests for\r\n     * * @returns Results of visibility tests\r\n     */\r\n    // visible<T>(data: T, property: Property<T>, state?: TestRunState): Observable<PropertyTestResults<T>> {\r\n    //     return this.runAllTests(data, property.view, state)\r\n    //         .pipe(\r\n    //             map((results: PropertyTestResults<T>) => {\r\n    //                 results.propertyName = property.absolutePath;\r\n    //                 return results as PropertyTestResults<T>;\r\n    //             })\r\n    //         );\r\n    // }\r\n\r\n    /**\r\n     * Runs an array of sync tests\r\n     * @param data Data to perform tests against\r\n     * @param tests Tests to run\r\n     * @returns Result of tests\r\n     */\r\n    runTests<T>(data: T, tests: Test<T>[], state?: TestRunState): TestResultsBase<T> {\r\n        if (!tests || !tests.length) return new TestResultsBase([]);\r\n\r\n        const testResults = tests\r\n            .map(t => this.runTest(data, t, state))\r\n            .filter(x => !!x);\r\n\r\n        return new TestResultsBase(testResults);\r\n    }\r\n\r\n    /**\r\n     * Runs an array of async tests\r\n     * @param data Data to perform tests against\r\n     * @param tests Tests to run\r\n     * @returns Result of tests\r\n     */\r\n    runTestsAsync<T>(data: T, tests: Test<T>[], state?: TestRunState): Observable<TestResultsBase<T>> {\r\n        if (!tests || !tests.length) return of(new TestResultsBase([]));\r\n\r\n        const runTest$ = tests\r\n            .map(test => this.runTestAsync(data, test, state));\r\n\r\n        return forkJoin(runTest$)\r\n            .pipe(\r\n                map(testResults => new TestResultsBase(testResults.filter(x => !!x)))\r\n            );\r\n    }\r\n\r\n    /**\r\n     * Runs an array of sync and async tests\r\n     * @param data Data to perform tests against\r\n     * @param tests Tests to run\r\n     * @returns Result of tests\r\n     */\r\n    runAllTests<T>(data: T, tests: Test<T>[], state?: TestRunState): Observable<TestResultsBase<T>> {\r\n        if (!tests || !tests.length) return of(new TestResultsBase([]));\r\n\r\n        const syncGroups = this.groupTestsBySyncType(tests);\r\n        const syncTestResults = of(this.runTests(data, syncGroups.sync, state));\r\n\r\n        return syncTestResults.pipe(\r\n            mergeMap(result => {\r\n                if (!result.passed) return of(result);\r\n\r\n                return this.runTestsAsync(data, syncGroups.async, state);\r\n            }),\r\n            take(1)\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Performs sync test on a set of data\r\n     * @param data Data to perform test against\r\n     * @param test Test to run\r\n     * @returns Result of test\r\n     */\r\n    runTest<T>(data: T, test: Test<T>, state?: TestRunState): TestResult<T> {\r\n        if (!test) return null;\r\n\r\n        const passedTestResult: TestResult<T> = { passed: true, name: test.name, message: null };\r\n        const failedTestResult: TestResult<T> = { passed: false, name: test.name, message: test.message };\r\n        const skippedTestResult: TestResult<T> = { passed: true, skipped: true, name: test.name, message: null };\r\n\r\n        const conditionsRuleSetResult = this.processRuleSet(data, test.condition, state);\r\n        if (conditionsRuleSetResult === ProcessResultType.Failed) return skippedTestResult;\r\n\r\n        const checkRuleSetResult = this.processRuleSet(data, test.check, state);\r\n        switch (checkRuleSetResult) {\r\n            case ProcessResultType.Passed:\r\n                return passedTestResult;\r\n            case ProcessResultType.Failed:\r\n                return failedTestResult;\r\n            case ProcessResultType.Skipped:\r\n            default:\r\n                return skippedTestResult;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Performs async test on a set of data\r\n     * @param data Data to perform test against\r\n     * @param test Test to run\r\n     * @returns Result of test\r\n     */\r\n    runTestAsync<T>(data: T, test: Test<T>, state?: TestRunState): Observable<TestResult<T>> {\r\n        if (!test) return of(null);\r\n\r\n        const passedTestResult: TestResult<T> = { passed: true, name: test.name, message: null };\r\n        const failedTestResult: TestResult<T> = { passed: false, name: test.name, message: test.message };\r\n        const skippedTestResult: TestResult<T> = { passed: true, skipped: true, name: test.name, message: null };\r\n\r\n        const conditionsRuleSetResult$ = this.processRuleSetAsync(data, test.condition, state);\r\n        const checkRuleSetResult$ = this.processRuleSetAsync(data, test.check, state);\r\n\r\n        return conditionsRuleSetResult$\r\n            .pipe(\r\n                flatMap(conditionsRuleSetResult => {\r\n                    if (conditionsRuleSetResult === ProcessResultType.Failed) return of(skippedTestResult);\r\n\r\n                    return checkRuleSetResult$\r\n                        .pipe(\r\n                            map(checkRuleSetResult => {\r\n                                switch (checkRuleSetResult) {\r\n                                    case ProcessResultType.Passed:\r\n                                        return passedTestResult;\r\n                                    case ProcessResultType.Failed:\r\n                                        return failedTestResult;\r\n                                    case ProcessResultType.Skipped:\r\n                                    default:\r\n                                        return skippedTestResult;\r\n                                }\r\n                            })\r\n                        );\r\n                })\r\n            );\r\n    }\r\n\r\n    /**\r\n     * Processes a sync rule set\r\n     * @param data Data to process rule set against\r\n     * @param ruleSet Rule set to process\r\n     * @returns Result of rule set processing\r\n     */\r\n    processRuleSet<T>(data: T, ruleSet: RuleSet<T>, state?: TestRunState): ProcessResultType {\r\n        if (!ruleSet) return ProcessResultType.Skipped;\r\n\r\n        const isRuleGroup = this.isRuleGroup(ruleSet);\r\n        return isRuleGroup\r\n            ? this.processRuleGroup(data, ruleSet as RuleGroup<T>, state)\r\n            : this.processRule(data, ruleSet as Rule<T>, state);\r\n    }\r\n\r\n    /**\r\n     * Processes an async rule set\r\n     * @param data Data to process rule set against\r\n     * @param ruleSet Rule set to process\r\n     * @returns Result of rule set processing\r\n     */\r\n    processRuleSetAsync<T>(data: T, ruleSet: RuleSet<T>, state?: TestRunState): Observable<ProcessResultType> {\r\n        if (!ruleSet) return of(ProcessResultType.Skipped);\r\n\r\n        const isRuleGroup = this.isRuleGroup(ruleSet);\r\n        return isRuleGroup\r\n            ? this.processRuleGroupAsync(data, ruleSet as RuleGroup<T>, state)\r\n            : this.processRuleAsync(data, ruleSet as Rule<T>, state);\r\n    }\r\n\r\n    private processRuleGroup<T>(data: T, ruleGroup: RuleGroup<T>, state?: TestRunState): ProcessResultType {\r\n        if (!ruleGroup.rules) return ProcessResultType.Skipped;\r\n\r\n        let passedCount = 0;\r\n        let skippedCount = 0;\r\n\r\n        for (let i = 0; i < ruleGroup.rules.length; i++) {\r\n            const rule = ruleGroup.rules[i];\r\n            const ruleSetResult = this.processRuleSet(data, rule, state);\r\n\r\n            if (this.canShortCircuitRuleGroup(ruleSetResult, ruleGroup)) return ruleSetResult;\r\n\r\n            if (ruleSetResult == ProcessResultType.Passed) passedCount++;\r\n            else if (ruleSetResult == ProcessResultType.Skipped) skippedCount++;\r\n        }\r\n\r\n        // if we skipped them all, then return skipped\r\n        if (skippedCount === ruleGroup.rules.length) return ProcessResultType.Skipped;\r\n\r\n        // if we got this far, make sure all tests were passed\r\n        return passedCount === ruleGroup.rules.length ? ProcessResultType.Passed : ProcessResultType.Failed;\r\n    }\r\n\r\n    private processRuleGroupAsync<T>(data: T, ruleGroup: RuleGroup<T>, state?: TestRunState): Observable<ProcessResultType> {\r\n        if (!ruleGroup.rules) return of(ProcessResultType.Skipped);\r\n        const asyncRuleSetResults$ = ruleGroup.rules.map(x => this.processRuleSetAsync(data, x, state));\r\n\r\n        return forkJoin(asyncRuleSetResults$).pipe(\r\n            map(ruleSetResults => {\r\n                const counts = {\r\n                    passed: ruleSetResults.filter(x => x === ProcessResultType.Passed).length,\r\n                    failed: ruleSetResults.filter(x => x === ProcessResultType.Failed).length,\r\n                    skipped: ruleSetResults.filter(x => x === ProcessResultType.Skipped).length,\r\n                };\r\n\r\n                const ruleGroupOptions = ruleGroup.options || { resultRequirements: ResultsPassRequirement.AllPass };\r\n\r\n                if (ruleGroupOptions.resultRequirements == ResultsPassRequirement.AnyPass && counts.passed > 0)\r\n                    return ProcessResultType.Passed;\r\n                if (ruleGroupOptions.resultRequirements == ResultsPassRequirement.AllPass && counts.passed === ruleSetResults.length)\r\n                    return ProcessResultType.Passed;\r\n                if (counts.skipped === ruleSetResults.length) return ProcessResultType.Skipped;\r\n\r\n                return ProcessResultType.Failed;\r\n            })\r\n        );\r\n    }\r\n\r\n    private processRule<T>(data: T, rule: Rule<T>, state?: TestRunState): ProcessResultType {\r\n        if (!rule.func) return ProcessResultType.Skipped;\r\n\r\n        const rootData = state ? state.rootData : null;\r\n        return rule.func(data, rootData) ? ProcessResultType.Passed : ProcessResultType.Failed;\r\n    }\r\n\r\n    private processRuleAsync<T>(data: T, rule: Rule<T>, state?: TestRunState): Observable<ProcessResultType> {\r\n        if (!rule.func && !rule.asyncFunc) return of(ProcessResultType.Skipped);\r\n\r\n        const rootData = state ? state.rootData : null;\r\n        const funcResult = rule.func\r\n            ? of(rule.func(data, rootData))\r\n            : rule.asyncFunc(data, rootData);\r\n\r\n        return funcResult\r\n            .pipe(\r\n                map(passed => passed ? ProcessResultType.Passed : ProcessResultType.Failed)\r\n            );\r\n    }\r\n\r\n    // private doProcessRule<T>(rule: Rule<T>, state: TestRunState, isAsync: boolean): boolean {\r\n    //     // make sure we have the appropriate func to call\r\n    //     if ((isAsync && !rule.asyncFunc) || (!isAsync && !rule.func)) return false;\r\n\r\n    //     // // if there is missing data, then assume we should process the rule\r\n    //     // if (!rule.options || !rule.options.controlStateOptions || !state || !state.controlState) return true;\r\n\r\n    //     // if (rule.options.controlStateOptions.skipPristine && state.controlState.pristine) return false;\r\n    //     // if (rule.options.controlStateOptions.skipUntouched && state.controlState.untouched) return false;\r\n\r\n    //     return true;\r\n    // }\r\n\r\n    private canShortCircuitRuleGroup<T>(ruleSetResult: ProcessResultType, ruleGroup: RuleGroup<T>): boolean {\r\n        const ruleGroupOptions = ruleGroup.options || { resultRequirements: ResultsPassRequirement.AllPass };\r\n\r\n        return (\r\n            // it passed, and we only need one to pass\r\n            (ruleSetResult == ProcessResultType.Passed && ruleGroupOptions.resultRequirements == ResultsPassRequirement.AnyPass)\r\n            ||\r\n            // if failed, and we need all to pass\r\n            (ruleSetResult == ProcessResultType.Failed && ruleGroupOptions.resultRequirements == ResultsPassRequirement.AllPass)\r\n        );\r\n    }\r\n\r\n    private isRuleGroup<T>(ruleSet: RuleSet<T>): boolean {\r\n        const rule = ruleSet as Rule<T>;\r\n        return !rule.func && !rule.asyncFunc;\r\n    }\r\n\r\n    private getDependencyPropertiesFromTest<T>(test: Test<T>): string[] {\r\n        const checkDeps = this.getDependencyPropertiesFromRuleSet<T>(test.check);\r\n        const conditionDeps = this.getDependencyPropertiesFromRuleSet<T>(test.condition);\r\n        return this.commonSvc.unique(checkDeps.concat(conditionDeps));\r\n    }\r\n\r\n    private getDependencyPropertiesFromRuleSet<T>(ruleSet: RuleSet<T>): string[] {\r\n        if (!ruleSet) return [];\r\n\r\n        const result: string[] = [];\r\n\r\n        if (this.isRuleGroup(ruleSet)) {\r\n            const ruleGroup = ruleSet as RuleGroup<T>;\r\n            ruleGroup.rules.forEach(x => {\r\n                result.push(...this.commonSvc.unique(this.getDependencyPropertiesFromRuleSet(x)));\r\n            });\r\n        }\r\n\r\n        const rule = ruleSet as Rule<T>;\r\n        if (rule.options && Array.isArray(rule.options.dependencyProperties)) {\r\n            result.push(...this.commonSvc.unique(rule.options.dependencyProperties));\r\n        }\r\n\r\n        return this.commonSvc.unique(result);\r\n    }\r\n\r\n    private setPropertyMetadata(properties: PropertyBase<any>[], modelSettingsName: string, currentAbsolutePath: string = ''): void {\r\n        if (!properties) return;\r\n\r\n        properties.forEach(prop => {\r\n            const newAbsolutePath = this.setPropertyAbsolutePath(prop, currentAbsolutePath);\r\n            this.fillInEmptyTestNames(prop);\r\n            prop.setOwnerModelSettingsName(modelSettingsName);\r\n\r\n            if (prop.properties) {\r\n                this.setPropertyMetadata(prop.properties, modelSettingsName, newAbsolutePath);\r\n            } else if (prop.arrayItemProperty) {\r\n                this.setPropertyMetadata([prop.arrayItemProperty], modelSettingsName, newAbsolutePath);\r\n            }\r\n        });\r\n    }\r\n\r\n    private setPropertyAbsolutePath(property: PropertyBase<any>, currentAbsolutePath: string = ''): string {\r\n        const isArrayItemProperty = PropertyBase.isArrayItemProperty(property);\r\n        const newAbsolutePathSegment = isArrayItemProperty ? '[]' : (property as Property<any>).name;\r\n        const isAtRoot = !currentAbsolutePath;\r\n        const newAbsolutePath = `${currentAbsolutePath}${isAtRoot ? '' : '.'}${newAbsolutePathSegment}`;\r\n\r\n        // set absolute path for property\r\n        property.setAbsolutePath(newAbsolutePath);\r\n\r\n        return newAbsolutePath;\r\n    }\r\n\r\n    private fillInEmptyTestNames(property: PropertyBase<any>) {\r\n        property.valid\r\n            .filter(test => !test.name)\r\n            .forEach((test, i) => test.name = `validTest${i}`);\r\n\r\n        property.edit\r\n            .filter(test => !test.name)\r\n            .forEach((test, i) => test.name = `editTest${i}`);\r\n    }\r\n\r\n    private getConfiguredFuncTypes<T>(ruleSet: RuleSet<T>): ConfiguredFuncTypes {\r\n        if (!ruleSet) return { sync: false, async: false };\r\n\r\n        const isRuleGroup = this.isRuleGroup(ruleSet);\r\n\r\n        if (isRuleGroup) {\r\n            const ruleGroup = ruleSet as RuleGroup<T>;\r\n            const results = ruleGroup.rules\r\n                .map(rs => {\r\n                    return this.getConfiguredFuncTypes(rs);\r\n                });\r\n\r\n            return {\r\n                sync: results.findIndex(x => !!x.sync) >= 0,\r\n                async: results.findIndex(x => !!x.async) >= 0,\r\n            };\r\n        } else {\r\n            const rule = ruleSet as Rule<T>;\r\n            return {\r\n                sync: !!rule.func,\r\n                async: !!rule.asyncFunc\r\n            };\r\n        }\r\n    }\r\n}\r\n\r\ninterface ConfiguredFuncTypes {\r\n    sync: boolean;\r\n    async: boolean;\r\n}\r\n","import { AbstractControl } from \"@angular/forms\";\r\n\r\n/**\r\n * State of an Angular AbstractControl at the time of running a test\r\n */\r\nexport class ControlState {\r\n    private readonly _pristine: boolean;\r\n    private readonly _untouched: boolean;\r\n\r\n    // get pristine(): boolean { return this._pristine; }\r\n    // get untouched(): boolean { return this._untouched; }\r\n\r\n    private constructor(control: AbstractControl) {\r\n        this._pristine = control.pristine;\r\n        this._untouched = control.untouched;\r\n    }\r\n\r\n    /**\r\n     * Creates a ControlState object based on an Angular control\r\n     * @param control Angular control to generate state from\r\n     * @returns Control state base on Angular control\r\n     */\r\n    static create(control: AbstractControl): ControlState {\r\n        return new ControlState(control);\r\n    }\r\n}","// tslint:disable:max-line-length\r\nimport { Injectable } from \"@angular/core\";\r\nimport { FormGroup, AbstractControl, ValidatorFn, FormBuilder, FormControl, FormArray, ValidationErrors, AsyncValidatorFn } from '@angular/forms';\r\nimport { RulesEngineService } from \"../rules-engine/rules-engine.service\";\r\nimport { Property } from \"../../../form-rules/models/property\";\r\nimport { ArrayItemProperty } from \"../../../form-rules/models/array-item-property\";\r\nimport { PropertyBase } from \"../../../form-rules/models/property-base\";\r\nimport { TraceService } from \"../../../utils/trace/trace.service\";\r\nimport { Observable, BehaviorSubject, of, OperatorFunction, timer, empty, EMPTY } from \"rxjs\";\r\nimport { map, tap, switchMap, take, distinctUntilChanged, debounce } from \"rxjs/operators\";\r\nimport { TestResultsBase } from \"../../../form-rules/models/test-results-base\";\r\nimport { ReactiveFormsValidationErrors } from \"../../../form-rules/models/reactive-forms-validation-errors\";\r\nimport { ReactiveFormsFailedValdation } from \"../../../form-rules/models/reactive-forms-failed-validation\";\r\nimport { ReactiveFormsValidationErrorsData } from \"../../../form-rules/models/reactive-forms-validation-errors-data\";\r\nimport { ControlState } from \"../../../form-rules/models/control-state\";\r\nimport { CommonService } from \"../../../utils/common/common.service\";\r\nimport { AbstractModelSettings } from \"../../../form-rules/models/abstract-model-settings\";\r\nimport { ValueChangeOptions } from \"../../../form-rules/models/value-change-options\";\r\nimport { AddArrayItemPropertyOptions } from \"../../../form-rules/models/add-array-item-property-options\";\r\nimport { UpdateOn } from \"../../../form-rules/models/update-on\";\r\n// tslint:enable:max-line-length\r\n\r\n/**\r\n * Builds reactive forms using configured model settings\r\n */\r\n@Injectable()\r\nexport class ReactiveFormsRuleService {\r\n    private static readonly FORM_MODEL_SETTINGS_PROPERTY_NAME = 'ngFormRulesModelSetting';\r\n    private static readonly FORCE_ASYNC_VALID_TEST_RUN_PROPERTY_NAME = 'ngFormRulesForceAsyncValidTestRun';\r\n    private static readonly CONTROL_LAST_ERROR = 'ngFormRulesControlLastError';\r\n\r\n    constructor(\r\n        private rulesEngineSvc: RulesEngineService,\r\n        private formBuilder: FormBuilder,\r\n        private traceSvc: TraceService,\r\n        private commonSvc: CommonService\r\n    ) {\r\n    }\r\n\r\n    /**\r\n     * Gets model settings with the provided name\r\n     * @param name Name of model setting\r\n     * @returns Model settings with the provided name\r\n     */\r\n    getModelSettings<T>(name: string): AbstractModelSettings<T> {\r\n        return this.rulesEngineSvc.getModelSettings(name);\r\n    }\r\n\r\n    /**\r\n     * Creates a form group using an instance of model settings\r\n     * @param modelSettings Name of the model setting or an instance of model settings to use\r\n     * @param initialValue Initial data to set the form values to\r\n     * @returns Form group created according to defined model settings\r\n     */\r\n    createFormGroup<T>(\r\n        modelSettings: string | AbstractModelSettings<T>,\r\n        initialValue?: any\r\n    ): FormGroup {\r\n        let settings: AbstractModelSettings<T>;\r\n\r\n        if (typeof modelSettings === \"string\") {\r\n            settings = this.rulesEngineSvc.getModelSettings(modelSettings as string);\r\n            if (!settings) throw new Error(`No model setting found with the name \"${modelSettings}\"`);\r\n        } else {\r\n            if (!modelSettings) throw new Error(`Adhoc model setting provided is invalid`);\r\n            settings = modelSettings as AbstractModelSettings<T>;\r\n            this.rulesEngineSvc.initializeModelSetting(settings);\r\n        }\r\n\r\n        this.traceSvc.trace(`Creating form group using model settings \"${settings.name}\"`);\r\n        const formGroup = this.buildGroup(settings.properties, initialValue);\r\n\r\n        this.traceSvc.trace(`Setting up dependency subscriptions`);\r\n        this.resetDependencySubscriptions(formGroup, settings.properties);\r\n\r\n        this.traceSvc.trace(`Patching form group with initial value`);\r\n        this.triggerValueChange(formGroup);\r\n\r\n        this.traceSvc.trace(`Attaching model settings to form`);\r\n        this.attachModelSettingsToForm(formGroup, settings);\r\n\r\n        return formGroup;\r\n    }\r\n\r\n    /**\r\n     * Adds an array item property to an existing form array\r\n     * @param property ArrayItemProperty to for the array item to be added\r\n     * @param parentFormArray The parent FormArray\r\n     * @param initialValue Initial value of the form array item\r\n     * @param options Options for adding new array item property\r\n     */\r\n    addArrayItemPropertyControl<T>(\r\n        property: ArrayItemProperty<T>,\r\n        parentFormArray: FormArray,\r\n        initialValue?: any,\r\n        options?: AddArrayItemPropertyOptions\r\n    ): void {\r\n        const control = this.buildAbstractControl(property, initialValue);\r\n        const willBeLastItem = !options || !this.commonSvc.isZeroOrGreater(options.index) || options.index >= parentFormArray.length;\r\n\r\n        if (willBeLastItem)\r\n            parentFormArray.push(control);\r\n        else\r\n            parentFormArray.insert(options.index, control);\r\n\r\n        const modelSettings = this.getModelSettingsFromForm(parentFormArray.root as FormGroup);\r\n        this.resetDependencySubscriptions(parentFormArray.root, modelSettings.properties);\r\n\r\n        // we need to do this because the item could have been added at any index in the array, and we need\r\n        // trigger a value change to trigger any dependency propertiy valdidations\r\n        this.triggerValueChange(parentFormArray);\r\n    }\r\n\r\n    /**\r\n     * Extends validators generated by ng-form-rules with your own validators\r\n     * @param control Control to extends the validators for\r\n     * @param validator Validator to add\r\n     */\r\n    extendValidator(control: AbstractControl, validator: ValidatorFn | ValidatorFn[]): void {\r\n        if (!validator) return;\r\n\r\n        const validatorArray = Array.isArray(validator) ? validator : [validator];\r\n        control.setValidators([control.validator, ...validatorArray]\r\n            .filter(validatorFn => !!validatorFn));\r\n    }\r\n\r\n    /**\r\n     * Extends async validators generated by ng-form-rules with your own async validators\r\n     * @param control Control to extends the async validators for\r\n     * @param asyncValidator Async validator to add\r\n     */\r\n    extendAsyncValidator(control: AbstractControl, asyncValidator: AsyncValidatorFn | AsyncValidatorFn[]): void {\r\n        if (!asyncValidator) return;\r\n\r\n        const asyncValidatorArray = Array.isArray(asyncValidator) ? asyncValidator : [asyncValidator];\r\n        control.setAsyncValidators([control.asyncValidator, ...asyncValidatorArray]\r\n            .filter(asyncValidatorFn => !!asyncValidatorFn));\r\n    }\r\n\r\n    private buildAbstractControl<T>(property: PropertyBase<T>, initialValue?: any): AbstractControl {\r\n        let control: AbstractControl;\r\n\r\n        if (property.arrayItemProperty) control = this.buildArray(property.arrayItemProperty, initialValue, property.updateOn);\r\n        else if (property.properties) control = this.buildGroup(property.properties, initialValue, property.updateOn);\r\n        else control = this.buildControl(initialValue, property.updateOn);\r\n\r\n        // setup validation tests on value change\r\n        control.setValidators(this.buildValidatorFunction(property));\r\n        control.setAsyncValidators(this.buildAsyncValidatorFunction(property));\r\n\r\n        // setup edit tests on value change\r\n        control.valueChanges\r\n            .pipe(\r\n                this.applyValueChangeOptions(property.valueChangeOptions.self.edit)\r\n            )\r\n            .subscribe(value => {\r\n                this.persistEditTests(control, property);\r\n            });\r\n\r\n        return control;\r\n    }\r\n\r\n    private buildControl<T>(initialValue: any, updateOn?: UpdateOn): FormControl {\r\n        return new FormControl(initialValue, { updateOn: updateOn });\r\n    }\r\n\r\n    private buildGroup<T>(properties: Property<T>[], initialValue: any, updateOn?: UpdateOn): FormGroup {\r\n        const formGroup = new FormGroup({}, { updateOn: updateOn });\r\n\r\n        (properties || []).forEach(p => {\r\n            const propertyValue = initialValue ? initialValue[p.name] : null;\r\n            const ctrl = this.buildAbstractControl(p, propertyValue);\r\n            formGroup.addControl(p.name, ctrl);\r\n        });\r\n\r\n        return formGroup;\r\n    }\r\n\r\n    private buildArray<T>(property: ArrayItemProperty<T>, initialValue: any[], updateOn?: UpdateOn): FormArray {\r\n        initialValue = Array.isArray(initialValue) ? initialValue : [];\r\n\r\n        return new FormArray(\r\n            initialValue.map(v => this.buildAbstractControl(property, v)),\r\n            { updateOn: updateOn }\r\n        );\r\n    }\r\n\r\n    private buildValidatorFunction<T>(property: PropertyBase<T>): ValidatorFn {\r\n        const syncGroups = this.rulesEngineSvc.groupTestsBySyncType(property.valid);\r\n        if (!syncGroups.sync.length) return null;\r\n\r\n        return (control: AbstractControl): ValidationErrors => {\r\n            const controlContextValues = this.getControlContextValues(control, property);\r\n\r\n            const testResults = this.rulesEngineSvc\r\n                .runTests(controlContextValues.relative, syncGroups.sync, {\r\n                    rootData: controlContextValues.root,\r\n                    controlState: ControlState.create(control)\r\n                });\r\n\r\n            if (testResults.results.length) {\r\n                this.traceSvc.trace(`Validated property \"${property.absolutePath}\". ` +\r\n                    this.buildTestResultStatsString(testResults));\r\n            }\r\n\r\n            return this.mapToReactiveFormsValidationErrors(testResults);\r\n        };\r\n    }\r\n\r\n    private buildAsyncValidatorFunction<T>(property: PropertyBase<T>): AsyncValidatorFn {\r\n        const rawAsyncFunc = this.buildAsyncValidatorFunctionRaw(property);\r\n\r\n        if (!rawAsyncFunc) return null;\r\n\r\n        const values = new BehaviorSubject<AbstractControl>(null);\r\n        const valid$ = values.pipe(\r\n            this.applyAsyncValidValueChangeOptions(property.valueChangeOptions.self.asyncValid),\r\n            switchMap(x => {\r\n                // pass through means we did not execute the ng-form-rules async tests\r\n                if (x.passthrough) {\r\n                    const currentErrors = x.control.errors || {};\r\n                    const lastNgFormRulesErrors = this.getLastErrorForControl(x.control);\r\n\r\n                    // return the last ng-form-rules errors (if any) alongside non ng-form-rules errors.\r\n                    // this handles scenario where debounce and distinct are used and state goes from:\r\n                    //    invalid -> make changes and back them out -> valid\r\n                    return of(Object.assign(currentErrors, { ngFormRules: lastNgFormRulesErrors } as ReactiveFormsValidationErrors));\r\n                } else {\r\n                    return rawAsyncFunc(x.control);\r\n                }\r\n            }),\r\n            take(1)\r\n        );\r\n\r\n        return (control: AbstractControl): Promise<ValidationErrors> | Observable<ValidationErrors> => {\r\n            values.next(control);\r\n            return valid$;\r\n        };\r\n    }\r\n\r\n    private buildAsyncValidatorFunctionRaw<T>(property: PropertyBase<T>): AsyncValidatorFn {\r\n        const syncGroups = this.rulesEngineSvc.groupTestsBySyncType(property.valid);\r\n        if (!syncGroups.async.length) return null;\r\n\r\n        return (control: AbstractControl) => {\r\n            const controlContextValues = this.getControlContextValues(control, property);\r\n\r\n            return this.rulesEngineSvc.runTestsAsync(controlContextValues.relative, syncGroups.async, {\r\n                rootData: controlContextValues.root,\r\n                controlState: ControlState.create(control)\r\n            }).pipe(\r\n                tap(testResults => {\r\n                    if (testResults.results.length) {\r\n                        this.traceSvc.trace(`Validated (async) property \"${property.absolutePath}\". ` +\r\n                            this.buildTestResultStatsString(testResults));\r\n                    }\r\n                }),\r\n                map(this.mapToReactiveFormsValidationErrors),\r\n                tap(x => this.setLastErrorForControl(control, (x || {}).ngFormRules))\r\n            );\r\n        };\r\n    }\r\n\r\n    private resetDependencySubscriptions<T>(\r\n        parentControl: AbstractControl,\r\n        properties: PropertyBase<T>[],\r\n    ): void {\r\n        this.removeDependencySubscriptions(properties);\r\n        this.addDependencySubscriptions(parentControl, properties);\r\n    }\r\n\r\n    private removeDependencySubscriptions<T>(\r\n        properties: PropertyBase<T>[]\r\n    ): void {\r\n        (properties || []).forEach(property => {\r\n            property.clearDependencyPropertySubscriptions();\r\n\r\n            if (property.properties) {\r\n                this.removeDependencySubscriptions(property.properties);\r\n            }\r\n\r\n            if (property.arrayItemProperty) {\r\n                this.removeDependencySubscriptions([property.arrayItemProperty]);\r\n            }\r\n        });\r\n    }\r\n\r\n    private addDependencySubscriptions<T>(\r\n        parentControl: AbstractControl,\r\n        properties: PropertyBase<T>[],\r\n        arrayIndex?: number\r\n    ): void {\r\n        (properties || []).forEach(property => {\r\n            const propertyControl = this.getPropertyFromParent(parentControl, property, arrayIndex);\r\n            if (!propertyControl) return;\r\n\r\n            this.setupEditabilityDependencySubscriptions(propertyControl, parentControl, property);\r\n            this.setupValidationDependencySubscriptions(propertyControl, parentControl, property);\r\n\r\n            if (property.properties) {\r\n                this.addDependencySubscriptions(propertyControl, property.properties);\r\n            }\r\n\r\n            if (property.arrayItemProperty) {\r\n                // if there is an arrayItemProperty we know that we are working with a FormArray control\r\n                const formArrayControl = (propertyControl as FormArray);\r\n                for (let i = 0; i < formArrayControl.length; i++) {\r\n                    this.addDependencySubscriptions(formArrayControl, [property.arrayItemProperty], i);\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    private setupValidationDependencySubscriptions<T>(\r\n        propertyControl: AbstractControl, parentControl: AbstractControl, property: PropertyBase<T>\r\n    ): void {\r\n        const dependencyPropNames = this.rulesEngineSvc.getDependencyProperties(property.valid);\r\n\r\n        dependencyPropNames.forEach(d => {\r\n            const dependencyControl = this.findControlRelatively(parentControl, d);\r\n\r\n            if (!dependencyControl) return;\r\n\r\n            const sub$ = dependencyControl.valueChanges\r\n                .pipe(\r\n                    this.applyValueChangeOptions(property.valueChangeOptions.dependencyProperties.valid)\r\n                )\r\n                .subscribe(value => {\r\n                    this.setForceAsyncValidationTestForControl(propertyControl, true);\r\n                    propertyControl.updateValueAndValidity({ onlySelf: true, emitEvent: false });\r\n                });\r\n\r\n            property.addDependencyPropertySubscription(sub$);\r\n        });\r\n    }\r\n\r\n    private setupEditabilityDependencySubscriptions<T>(\r\n        propertyControl: AbstractControl,\r\n        parentControl: AbstractControl,\r\n        property: PropertyBase<T>\r\n    ): void {\r\n        const dependencyPropNames = this.rulesEngineSvc.getDependencyProperties(property.edit);\r\n\r\n        dependencyPropNames.forEach(dpn => {\r\n            const dependencyControl = this.findControlRelatively(parentControl, dpn);\r\n\r\n            if (!dependencyControl) return;\r\n\r\n            // setup control to perform edit tests when dependency property changes\r\n            const sub$ = dependencyControl.valueChanges\r\n                .pipe(\r\n                    this.applyValueChangeOptions(property.valueChangeOptions.dependencyProperties.edit)\r\n                )\r\n                .subscribe(value => {\r\n                    this.persistEditTests(propertyControl, property);\r\n                });\r\n\r\n            property.addDependencyPropertySubscription(sub$);\r\n        });\r\n    }\r\n\r\n    private persistEditTests<T>(propertyControl: AbstractControl, property: PropertyBase<T>): void {\r\n        const controlContextValues = this.getControlContextValues(propertyControl, property);\r\n\r\n        this.rulesEngineSvc.editable(controlContextValues.relative, property, {\r\n            rootData: controlContextValues.root,\r\n            controlState: ControlState.create(propertyControl)\r\n        }).subscribe(testResults => {\r\n            if (testResults.results.length) {\r\n                this.traceSvc.trace(`Editable property \"${property.absolutePath}\". ` +\r\n                    this.buildTestResultStatsString(testResults));\r\n            }\r\n\r\n            if (testResults.passed && propertyControl.disabled)\r\n                propertyControl.enable({ emitEvent: false });\r\n            else if (!testResults.passed && propertyControl.enabled)\r\n                propertyControl.disable({ emitEvent: false });\r\n        });\r\n    }\r\n\r\n    private applyAsyncValidValueChangeOptions(\r\n        valueChangeOptions: ValueChangeOptions\r\n    ): OperatorFunction<AbstractControl, AsyncValidationPassthroughable> {\r\n        return (source$: Observable<AbstractControl>): Observable<AsyncValidationPassthroughable> => {\r\n            let lastValue: any;\r\n            let isForce: boolean;\r\n\r\n            return source$.pipe(\r\n                tap(control => {\r\n                    isForce = this.doesControlHaveForcedAsyncValidation(control);\r\n                    this.setForceAsyncValidationTestForControl(control, false);\r\n                }),\r\n                debounce(x => {\r\n                    return isForce || valueChangeOptions.debounceMilliseconds > 0\r\n                        ? timer(valueChangeOptions.debounceMilliseconds)\r\n                        : EMPTY;\r\n                }),\r\n                map(control => {\r\n                    return {\r\n                        control: control,\r\n                        passthrough: !(control.value !== lastValue || !valueChangeOptions.distinctUntilChanged || isForce)\r\n                    } as AsyncValidationPassthroughable;\r\n                }),\r\n                tap(x => {\r\n                    if (!x.passthrough) lastValue = x.control.value;\r\n                })\r\n            );\r\n        };\r\n    }\r\n\r\n    private applyValueChangeOptions(valueChangeOptions: ValueChangeOptions): OperatorFunction<any, any> {\r\n        return (source$: Observable<any>): Observable<any> => {\r\n            return source$.pipe(\r\n                debounce(x => {\r\n                    return valueChangeOptions.debounceMilliseconds > 0\r\n                        ? timer(valueChangeOptions.debounceMilliseconds)\r\n                        : EMPTY;\r\n                }),\r\n                valueChangeOptions.distinctUntilChanged ? distinctUntilChanged() : tap()\r\n            );\r\n        };\r\n    }\r\n\r\n    private getControlContextValues<T>(control: AbstractControl, property: Property<T> | ArrayItemProperty<T>): ControlContextValues {\r\n        const rootValue = (control.root as FormGroup).getRawValue();\r\n\r\n        // use the control value if an array item, otherwise use the parent control\r\n        const relativeValue = PropertyBase.isArrayItemProperty(property)\r\n            ? control.value\r\n            : control.parent.getRawValue();\r\n\r\n        return {\r\n            root: rootValue,\r\n            relative: relativeValue\r\n        };\r\n    }\r\n\r\n    private getPropertyFromParent<T>(\r\n        parentControl: AbstractControl,\r\n        property: PropertyBase<T>,\r\n        arrayIndex?: number\r\n    ) {\r\n        return PropertyBase.isArrayItemProperty(property)\r\n            ? (parentControl as FormArray).at(arrayIndex)\r\n            : parentControl.get((property as Property<T>).name);\r\n    }\r\n\r\n    private mapToReactiveFormsValidationErrors<T>(testResults: TestResultsBase<T>): ReactiveFormsValidationErrors {\r\n        // if passed, Angular reactive forms wants us to return null, otherwise return an object with the validation info\r\n        if (!testResults || testResults.passed) return null;\r\n\r\n        const failed: { [key: string]: ReactiveFormsFailedValdation } = {};\r\n\r\n        testResults.failedResults.forEach(test => {\r\n            failed[test.name] = { message: test.message };\r\n        });\r\n\r\n        return {\r\n            ngFormRules: {\r\n                message: testResults.message,\r\n                failed: failed\r\n            } as ReactiveFormsValidationErrorsData\r\n        };\r\n    }\r\n\r\n    private findControlRelatively(control: AbstractControl, path: string) {\r\n        const relativePaths = this.buildControlRelativePathArray(path);\r\n\r\n        if (!relativePaths.length) return null;\r\n\r\n        let result: AbstractControl;\r\n        relativePaths.forEach(pathSegment => {\r\n            result = this.getControlByPathSegment(result || control, pathSegment);\r\n            if (!result) return;\r\n        });\r\n\r\n        return result;\r\n    }\r\n\r\n    private buildControlRelativePathArray(relativePath: string): string[] {\r\n        const result: string[] = [];\r\n\r\n        if (!relativePath || typeof relativePath !== \"string\") return result;\r\n\r\n        // takes care of './', '../', and '/'\r\n        const slashSeparated = relativePath.split(\"/\");\r\n\r\n        slashSeparated.forEach(slashItem => {\r\n            const dotSeparated = slashItem.split(\".\")\r\n                .filter(dotItem => !!dotItem);\r\n\r\n            if (dotSeparated.length)\r\n                result.push(...dotSeparated);\r\n            else\r\n                result.push(slashItem);\r\n        });\r\n\r\n        return result;\r\n    }\r\n\r\n    private getControlByPathSegment(control: AbstractControl, pathSegment: string): AbstractControl {\r\n        switch (pathSegment) {\r\n            case \"\":\r\n                return control.root;\r\n            case \"..\":\r\n                return control.parent;\r\n            case \".\":\r\n                return control;\r\n            default:\r\n                return control.get(pathSegment);\r\n        }\r\n    }\r\n\r\n    private buildTestResultStatsString<T>(testResults: TestResultsBase<T>) {\r\n        return `Executed ${testResults.results.length} tests ` +\r\n            `(${testResults.passedResults.length} PASS | ` +\r\n            `${testResults.failedResults.length} FAIL | `\r\n            + `${testResults.skippedResults.length} SKIP)`;\r\n    }\r\n\r\n    private attachModelSettingsToForm<T>(formGroup: FormGroup, modelSettings: AbstractModelSettings<T>): void {\r\n        formGroup[ReactiveFormsRuleService.FORM_MODEL_SETTINGS_PROPERTY_NAME] = modelSettings;\r\n    }\r\n\r\n    private getModelSettingsFromForm<T>(formGroup: FormGroup): AbstractModelSettings<T> {\r\n        return formGroup[ReactiveFormsRuleService.FORM_MODEL_SETTINGS_PROPERTY_NAME] as AbstractModelSettings<T>;\r\n    }\r\n\r\n    private setForceAsyncValidationTestForControl(control: AbstractControl, force: boolean): void {\r\n        control[ReactiveFormsRuleService.FORCE_ASYNC_VALID_TEST_RUN_PROPERTY_NAME] = force;\r\n    }\r\n\r\n    private setLastErrorForControl(control: AbstractControl, errors: ReactiveFormsValidationErrorsData): void {\r\n        control[ReactiveFormsRuleService.CONTROL_LAST_ERROR] = errors;\r\n    }\r\n\r\n    private getLastErrorForControl(control: AbstractControl): ReactiveFormsValidationErrorsData {\r\n        return control[ReactiveFormsRuleService.CONTROL_LAST_ERROR];\r\n    }\r\n\r\n    private doesControlHaveForcedAsyncValidation(control: AbstractControl): boolean {\r\n        return !!(control[ReactiveFormsRuleService.FORCE_ASYNC_VALID_TEST_RUN_PROPERTY_NAME]);\r\n    }\r\n\r\n    private triggerValueChange(control: AbstractControl): void {\r\n        control.patchValue(control.value);\r\n    }\r\n}\r\n\r\ninterface ControlContextValues {\r\n    root: any;\r\n    relative: any;\r\n}\r\n\r\ninterface AsyncValidationPassthroughable {\r\n    control: AbstractControl;\r\n    passthrough: boolean;\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { TraceService } from './trace/trace.service';\r\nimport { CommonService } from './common/common.service';\r\n\r\n@NgModule({\r\n  imports: [],\r\n  declarations: [],\r\n  providers: [\r\n      TraceService,\r\n      CommonService\r\n  ]\r\n})\r\nexport class UtilsModule { }\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { RulesEngineService } from './services/rules-engine/rules-engine.service';\r\nimport { ReactiveFormsRuleService } from './services/reactive-forms-rule/reactive-forms-rule.service';\r\nimport { ReactiveFormsModule } from '@angular/forms';\r\nimport { UtilsModule } from '../utils/utils.module';\r\n\r\n@NgModule({\r\n    imports: [\r\n        CommonModule,\r\n        UtilsModule\r\n    ],\r\n    providers: [\r\n        RulesEngineService,\r\n        ReactiveFormsRuleService\r\n    ],\r\n    declarations: []\r\n})\r\nexport class RulesEngineModule { }\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { RulesEngineModule } from '../rules-engine/rules-engine.module';\r\n\r\n/**\r\n * Main module for ng-form-rules\r\n */\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    RulesEngineModule,\r\n  ],\r\n  declarations: [],\r\n  exports: [\r\n      RulesEngineModule,\r\n  ]\r\n})\r\nexport class FormRulesModule { }\r\n","import { PropertyBase } from \"./property-base\";\r\n\r\n/**\r\n * Non-array item property\r\n */\r\nexport class Property<T> extends PropertyBase<T> {\r\n    private _name: string;\r\n\r\n    /**\r\n     * Name of the property\r\n     */\r\n    get name(): string {\r\n        return this._name;\r\n    }\r\n\r\n    constructor(name: string) {\r\n        super();\r\n        this._name = name;\r\n    }\r\n}","import { PropertyBase } from \"./property-base\";\r\n\r\n/**\r\n * A property representing an array item (e.g. an array of Address objects)\r\n */\r\nexport class ArrayItemProperty<T> extends PropertyBase<T> {}","import { Property } from '../models/property';\r\nimport { RuleGroup } from '../models/rule-group';\r\nimport { Rule } from '../models/rule';\r\nimport { Test } from '../models/test';\r\nimport { ArrayItemProperty } from '../models/array-item-property';\r\nimport { RuleSet } from '../models/rule-set';\r\nimport { RuleFunc } from '../models/rule-func';\r\nimport { RuleOptions } from '../models/rule-options';\r\nimport { AsyncRuleFunc } from '../models/async-rule-func';\r\nimport { RuleGroupOptions } from '../models/rule-group-options';\r\nimport { ResultsPassRequirement } from '../models/results-pass-requirement';\r\n\r\n/**\r\n * Utility class for building model settings\r\n */\r\nexport class ModelSettingsBuilder {\r\n    /**\r\n     * Creates a property\r\n     * @param propertyName Property name\r\n     * @param extend Function to extend the property\r\n     * @returns Created property\r\n     */\r\n    property<T>(propertyName: keyof T, extend?: (prop: Property<T>) => void): Property<T> {\r\n        if (!propertyName || typeof propertyName !== 'string') throw Error('Invalid property name');\r\n\r\n        const property = new Property<T>(propertyName);\r\n\r\n        if (extend) extend(property);\r\n\r\n        return property;\r\n    }\r\n\r\n    /**\r\n     * Creates an array item property\r\n     * @param extend Function to extend the array item property\r\n     * @returns Created array item property\r\n     */\r\n    arrayItemProperty<T>(extend?: (prop: ArrayItemProperty<T>) => void): ArrayItemProperty<T> {\r\n        const property = new ArrayItemProperty<T>();\r\n\r\n        if (extend) extend(property);\r\n\r\n        return property;\r\n    }\r\n\r\n    /**\r\n     * Creates a validation test\r\n     * @param message Message when the test fails\r\n     * @param check Check rule set for the test\r\n     * @param condition Condition rule set for the test\r\n     * @returns Created validation test\r\n     */\r\n    validTest<T>(message: string, check: RuleSet<T>, condition?: RuleSet<T>): Test<T> {\r\n        return this.validNamedTest(null, message, check, condition);\r\n    }\r\n\r\n    /**\r\n     * Creates a named validation test\r\n     * @param name Name of the test\r\n     * @param message Message when the test fails\r\n     * @param check Check rule set for the test\r\n     * @param condition Condition rule set for the test\r\n     * @returns Created named validation test\r\n     */\r\n    validNamedTest<T>(name: string, message: string, check: RuleSet<T>, condition?: RuleSet<T>): Test<T> {\r\n        return {\r\n            name: name,\r\n            message: message,\r\n            check: check,\r\n            condition: condition\r\n        } as Test<T>;\r\n    }\r\n\r\n    /**\r\n     * Creates an edit test\r\n     * @param check Check rule set for the test\r\n     * @param condition Condition rule set for the test\r\n     * @returns Created edit test\r\n     */\r\n    editTest<T>(check: RuleSet<T>, condition?: RuleSet<T>): Test<T> {\r\n        return this.editNamedTest(null, check, condition);\r\n    }\r\n\r\n    /**\r\n     * Creates a named edit test\r\n     * @param name Name of the test\r\n     * @param check Check rule set for the test\r\n     * @param condition Condition rule set for the test\r\n     * @returns Created named edit test\r\n     */\r\n    editNamedTest<T>(name: string, check: RuleSet<T>, condition?: RuleSet<T>): Test<T> {\r\n        return {\r\n            name: name,\r\n            check: check,\r\n            condition: condition\r\n        } as Test<T>;\r\n    }\r\n\r\n    /**\r\n     * Creates a rule\r\n     * @param func Function for the rule\r\n     * @param options Additional rule options\r\n     * @returns Created rule\r\n     */\r\n    rule<T, R>(func: RuleFunc<T, R>, options?: RuleOptions): Rule<T> {\r\n        return this.ruleCombo(func, null, options);\r\n    }\r\n\r\n    /**\r\n     * Creates an async rule\r\n     * @param asyncFunc Async function for the rule\r\n     * @param options Additional rule options\r\n     * @returns Created rule\r\n     */\r\n    ruleAsync<T, R>(asyncFunc: AsyncRuleFunc<T, R>, options?: RuleOptions): Rule<T> {\r\n        return this.ruleCombo(null, asyncFunc, options);\r\n    }\r\n\r\n    /**\r\n     * Creates a combo rule that has both syncronous and async functions\r\n     * @param func Function for the rule\r\n     * @param asyncFunc Async function for the rule\r\n     * @param options Additional rule options\r\n     * @returns Created rule\r\n     */\r\n    ruleCombo<T, R>(func: RuleFunc<T, R>, asyncFunc: AsyncRuleFunc<T, R>, options?: RuleOptions): Rule<T> {\r\n        return {\r\n            func: func,\r\n            asyncFunc: asyncFunc,\r\n            options: options\r\n        } as Rule<T>;\r\n    }\r\n\r\n    /**\r\n     * Creates a rule group\r\n     * @param ruleSets Rule sets for the rule group\r\n     * @param options Additional rule group options\r\n     * @returns Created rule group\r\n     */\r\n    ruleGroup<T>(ruleSets: RuleSet<T>[], options?: RuleGroupOptions): RuleGroup<T> {\r\n        return {\r\n            rules: ruleSets,\r\n            options: options || { resultRequirements: ResultsPassRequirement.AllPass }\r\n        } as RuleGroup<T>;\r\n    }\r\n}","import { ModelSettingsBuilder } from \"../helper/model-settings-builder\";\r\nimport { Property } from \"./property\";\r\n\r\n/**\r\n * Base class for model settings\r\n */\r\nexport abstract class AbstractModelSettings<T> {\r\n    private _name: string;\r\n\r\n    /**\r\n     * Name of the model setting\r\n     */\r\n    get name(): string {\r\n        return this._name;\r\n    }\r\n\r\n    /**\r\n     * Helper for building properties, tests, and rules\r\n     */\r\n    protected builder: ModelSettingsBuilder;\r\n\r\n    /**\r\n     * Properties configured for the model settings\r\n     */\r\n    properties: Property<T>[];\r\n\r\n    /**\r\n     * Creates model settings\r\n     * @param name Name of the model settings\r\n     */\r\n    constructor(name: string) {\r\n        this.builder = new ModelSettingsBuilder();\r\n        this._name = name;\r\n        this.properties = this.buildProperties() || [];\r\n    }\r\n\r\n    /**\r\n     * Abstract function for building the properties\r\n     */\r\n    protected abstract buildProperties(): Property<T>[];\r\n}","import { TestResultsBase } from \"./test-results-base\";\r\nimport { TestResult } from \"./test-result\";\r\n\r\nexport class PropertyTestResults<T> extends TestResultsBase<T> {\r\n    constructor(public propertyName: string, results: TestResult<T>[]) {\r\n        super(results);\r\n    }\r\n}","import { AbstractModelSettings } from \"./abstract-model-settings\";\r\nimport { ModelSettingsBuilder } from \"../helper/model-settings-builder\";\r\nimport { Property } from \"./property\";\r\n\r\n/**\r\n * Class for creating adhoc (non-registered) model settings\r\n */\r\nexport class AdhocModelSettings<T> extends AbstractModelSettings<T> {\r\n    /**\r\n     * Creates model settings\r\n     * @param propertyBuilderFunc Function that takes a ModelSettingsBuilder and uses it to return an array of properties\r\n     * @returns Model settings configured with properties returned from the 'propertyBuilderFunc' function parameter\r\n     */\r\n    static create<T>(propertyBuilderFunc: (builder: ModelSettingsBuilder) => Property<T>[]): AbstractModelSettings<T> {\r\n        const instance = new AdhocModelSettings();\r\n        instance.properties = !!propertyBuilderFunc ? propertyBuilderFunc(instance.builder) || [] : [];\r\n\r\n        return instance;\r\n    }\r\n\r\n    private constructor() {\r\n        // since these settings are not registered, just use a static name\r\n        super('adhoc');\r\n    }\r\n\r\n    protected buildProperties(): Property<T>[] {\r\n        // this is just needed to satisfy the AbstractModelSettings<T> contract\r\n        return [];\r\n    }\r\n}","/**\r\n * Options for how and when to process value changes in a form control\r\n */\r\nexport class ValueChangeOptions {\r\n    /**\r\n     * Consider value changed only if it is different\r\n     */\r\n    distinctUntilChanged?: boolean;\r\n\r\n    /**\r\n     * Milliseconds to debounce value changes\r\n     */\r\n    debounceMilliseconds?: number;\r\n}"],"names":["InjectionToken","Injectable","Optional","Inject","map","of","forkJoin","mergeMap","take","flatMap","tslib_1.__spread","FormControl","FormGroup","FormArray","BehaviorSubject","switchMap","tap","debounce","timer","EMPTY","distinctUntilChanged","FormBuilder","NgModule","CommonModule","tslib_1.__extends"],"mappings":"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"}
